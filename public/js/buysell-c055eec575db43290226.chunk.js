(("undefined"!==typeof self?self:this).webpackJsonp=("undefined"!==typeof self?self:this).webpackJsonp||[]).push([[5],{"+xbH":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("hWgQ");const l=Object(n.c)({commitError:{id:"SimpleTrade.commitError",defaultMessage:"Something went wrong. Please check your email to see if your trade was successful."}})},"/If1":function(e,t,a){"use strict";a.r(t);const n={kind:"InlineDataFragment",name:"createSellFragment",hash:"269a66f149b0569660f55a8315628fff"};t.default=n},"0bS+":function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],l={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:n,storageKey:null},r={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"subtotal",plural:!1,selections:n,storageKey:null},o={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"total",plural:!1,selections:n,storageKey:null},i=[{alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],s={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"error",plural:!1,selections:[a,{kind:"InlineFragment",selections:i,type:"GenericError",abstractKey:null},{kind:"InlineFragment",selections:i,type:"CreateSellBadRequestError",abstractKey:null}],storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useSellQuoterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[l,r,o],storageKey:null}],type:"CreateSellSuccess",abstractKey:null},{kind:"InlineFragment",selections:[s,{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[l,r],storageKey:null}],type:"CreateSellPartialError",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useSellQuoterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[l,r,o,c],storageKey:null}],type:"CreateSellSuccess",abstractKey:null},{kind:"InlineFragment",selections:[s,{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[l,r,c],storageKey:null}],type:"CreateSellPartialError",abstractKey:null}],storageKey:null}]},params:{id:"1a32949c6a28ddcc3a7c58a5ebef485be5e3d72b463495448933b8f29acd7538",metadata:{},name:"useSellQuoterMutation",operationKind:"mutation",text:null}}}();n.hash="71661b58090202ada98bdd85400ec312",t.default=n},"0mhu":function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},l],o={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:r,storageKey:null},i={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"subtotal",plural:!1,selections:r,storageKey:null},s={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"total",plural:!1,selections:r,storageKey:null},c={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"fee",plural:!1,selections:r,storageKey:null},u={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"defaultFee",plural:!1,selections:r,storageKey:null},d={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"feeWithoutSubscriptionBenefit",plural:!1,selections:r,storageKey:null},b={alias:null,args:null,concreteType:"UnitPrice",kind:"LinkedField",name:"unitPrice",plural:!1,selections:[o],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"holdDays",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"recurringPayment",storageKey:null},y={alias:null,args:null,concreteType:"InstantAchData",kind:"LinkedField",name:"instantAch",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isTotalInstant",storageKey:null},{alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"instantAchAmount",plural:!1,selections:r,storageKey:null}],storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"resource",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"rejected",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},O={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},S={alias:null,args:null,concreteType:"Link",kind:"LinkedField",name:"link",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},h={alias:null,args:null,concreteType:"TransferUserWarningContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"details",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"linkText",storageKey:null}],storageKey:null},k={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"GenericError",kind:"LinkedField",name:"error",plural:!1,selections:[O],storageKey:null}],type:"CreateBuyPartialError",abstractKey:null},C={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useRefreshBuyQuoteMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{kind:"InlineDataFragmentSpread",name:"createBuyFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[n,o,i,s,c,u,d,b,p,m,y,g,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[f,l,v],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[j,O,S,h],storageKey:null}]}],type:"CreateBuySuccess",abstractKey:null},k],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useRefreshBuyQuoteMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[n,o,i,s,c,u,d,b,p,m,y,g,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[f,l,v,C],storageKey:null},C],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[j,O,S,h,C],storageKey:null}],type:"CreateBuySuccess",abstractKey:null},k],storageKey:null}]},params:{id:"309efba67458e1908d4a3e20cfb3b2d3381a9474d6685c7e265f5a6edc4fd1c9",metadata:{},name:"useRefreshBuyQuoteMutation",operationKind:"mutation",text:null}}}();n.hash="faa6976d150e68e2db2e2d7b1974cbba",t.default=n},"1Ddr":function(e,t,a){"use strict";var n=a("5n0U"),l=(a("mXGw"),a("Bb2r")),r=a.n(l),o=a("UutA"),i=a("SIGa"),s=a("DRDe"),c=a("p8ry");a("AYb+");t.a=c.default;const u=o.e.div.withConfig({displayName:"BuySell__BuySellFallback",componentId:"sc-15nowsm-0"})(["display:flex;align-items:center;justify-content:center;height:","px;width:100%;padding:","px;margin-bottom:24px;border:",";border-radius:",";box-shadow:",";"],s.c,s.d,e=>e.theme.border.border,e=>e.theme.border.radius,e=>e.theme.boxShadow.default);r()({loader:()=>Promise.resolve().then(a.bind(null,"p8ry")),loading:()=>Object(n.a)(u,{},void 0,Object(n.a)(i.a,{size:"large"}))})},"24oI":function(e,t,a){"use strict";a.r(t);const n=function(){var e={defaultValue:null,kind:"LocalArgument",name:"accountId"},t={defaultValue:null,kind:"LocalArgument",name:"transferId"},a=[{kind:"Variable",name:"uuid",variableName:"accountId"}],n=[{kind:"Variable",name:"uuid",variableName:"transferId"}],l={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"useBuyStatusQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"Account",kind:"LinkedField",name:"accountByUuid",plural:!1,selections:[{alias:null,args:n,concreteType:"TransferBuy",kind:"LinkedField",name:"buyByUuid",plural:!1,selections:[{alias:null,args:null,concreteType:"AccountHistoryEntry",kind:"LinkedField",name:"accountHistory",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"useBuyStatusQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"Account",kind:"LinkedField",name:"accountByUuid",plural:!1,selections:[{alias:null,args:n,concreteType:"TransferBuy",kind:"LinkedField",name:"buyByUuid",plural:!1,selections:[{alias:null,args:null,concreteType:"AccountHistoryEntry",kind:"LinkedField",name:"accountHistory",plural:!1,selections:[l,r],storageKey:null},r],storageKey:null},r],storageKey:null},r],storageKey:null}]},params:{id:"fdb41c097c1cd8f61845d12f99707f618227aee61436e5bbd01660314a15810b",metadata:{},name:"useBuyStatusQuery",operationKind:"query",text:null}}}();n.hash="32f0894491e7bbcf67292eb5a7cd9bf6",t.default=n},"376Q":function(e,t,a){"use strict";a.r(t);const n={kind:"InlineDataFragment",name:"commitBuyFragment",hash:"1c09f86143e88325931e8a6cd0e2743d"};t.default=n},"3qCY":function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"resource",storageKey:null},r={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null}],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"recurringPayment",storageKey:null},i=[{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],s={alias:null,args:null,concreteType:"CommitNoticeData",kind:"LinkedField",name:"commitNotice",plural:!1,selections:i,storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"cardStatus",storageKey:null},u={alias:null,args:null,concreteType:"TransferWblUxData",kind:"LinkedField",name:"wblUxData",plural:!1,selections:i,storageKey:null},d={alias:null,args:null,concreteType:"TransferNextStep",kind:"LinkedField",name:"nextStep",plural:!1,selections:[{alias:"action",args:null,kind:"ScalarField",name:"Action",storageKey:null},{alias:"maxPollAttempts",args:null,kind:"ScalarField",name:"MaxPollAttempts",storageKey:null},{alias:"pollIntervalMs",args:null,kind:"ScalarField",name:"PollIntervalInMs",storageKey:null}],storageKey:null},b={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"GenericError",abstractKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useBuyCommitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"commitBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"commitBuyFragment",selections:[n,l,r,o,s,c,u,d]}],storageKey:null}],type:"CommitBuySuccess",abstractKey:null},b],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useBuyCommitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"commitBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[n,l,r,o,s,c,u,d,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"CommitBuySuccess",abstractKey:null},b],storageKey:null}]},params:{id:"e3e439b83f3b72c58708bbf14ef152035e0c6f7a44e7ae6a9c22c1f1b280edcf",metadata:{},name:"useBuyCommitterMutation",operationKind:"mutation",text:null}}}();n.hash="9ea85de93892c9dbfcd33ba8a0e67a3c",t.default=n},"4i+S":function(e,t,a){"use strict";a.r(t);const n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useBuyStatusUpsellFragment",selections:[{alias:null,args:null,concreteType:"UserProperties",kind:"LinkedField",name:"userProperties",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasSsn",storageKey:null},{alias:null,args:null,concreteType:"RegionFeatures",kind:"LinkedField",name:"regionFeatures",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isInUs",storageKey:null}],storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null,hash:"a9dd7a4715b29e166e3b523375929cd4"};t.default=n},"8/nl":function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"skip"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"buySellStepperQueryQuery",selections:[{condition:"skip",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useBuyStatusUpsellFragment"}],storageKey:null}]}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"buySellStepperQueryQuery",selections:[{condition:"skip",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"UserProperties",kind:"LinkedField",name:"userProperties",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasSsn",storageKey:null},{alias:null,args:null,concreteType:"RegionFeatures",kind:"LinkedField",name:"regionFeatures",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isInUs",storageKey:null}],storageKey:null},t],storageKey:null},t],storageKey:null}]}]},params:{id:"e076c69001033d6114218c274be38d3f2ac880f83137ab9e48fe25b121d2c95e",metadata:{},name:"buySellStepperQueryQuery",operationKind:"query",text:null}}}();n.hash="bd630896affb310c46366b2f1120374b",t.default=n},"AYb+":function(e,t,a){"use strict";var n=a("+I+c"),l=a("5n0U"),r=a("7IP4"),o=a.n(r),i=a("mXGw"),s=a.n(i),c=a("hWgQ"),u=a("gN02"),d=a("UutA"),b=a("O0l7"),p=a("h0AC"),m=a("5vQi"),y=a("TqGZ"),g=a("MH3X"),f=a("FyJg"),v=a("vIZW"),j=a("O8JI"),O=a("xLjK"),S=a("f8+8"),h=a("djRk"),k=a("nU37"),C=a("hPOx"),T=a("LWNj"),w=a("zjQG"),B=a("sMDT"),P=a("KqNE"),M=a("Mxns"),F=a("ckIB"),A=a("8nDi"),I=a("fqMU"),_=a("p/Ll"),x=a("hOK7"),E=a("w48d"),R=a("1L0a");const L=Object(i.createContext)({accounts:[],allowedPaymentMethods:[],formattedPaymentMethods:[],tradableAssets:[],experimentalAssets:new Set([])});function D({children:e,accounts:t,allowedPaymentMethods:a,formattedPaymentMethods:n,tradableAssets:r,experimentalAssets:o}){const s=Object(i.useMemo)(()=>({accounts:t,allowedPaymentMethods:a,formattedPaymentMethods:n,tradableAssets:r,experimentalAssets:o}),[t,a,n,r,o]);return Object(l.a)(L.Provider,{value:s},void 0,e)}function K(){return Object(i.useContext)(L)}var N=Object(i.memo)(D),U=a("xdc6"),V=a("bdjm"),H=a("QLaP"),q=a.n(H),z=a("vq5h");function W(){const{assetSymbol:e}=Object(b.a)(U.a),t=Object(z.a)(e.value);return q()(t,"There should always be a selected asset"),t}function Q(){const e=function(){const{accounts:e,tradableAssets:t}=K(),{transferType:a}=Object(b.a)(U.a),n=W().symbol,l=Object(i.useCallback)(e=>Object(V.a)({tradableAssets:t,assetSymbol:e}),[t]);return Object(i.useMemo)(()=>"buy"===a.value?e.filter(e=>l(e.currency.code)&&!["multisig_vault","multisig"].includes(e.type)&&n===e.currency.code):e.filter(e=>l(e.currency.code)&&"wallet"===e.type),[e,n,a,l])}(),t=W().symbol;return Object(i.useMemo)(()=>e.find(e=>e.currency.code===t&&("BTC"===t&&e.primary||"BTC"!==t&&"wallet"===e.type))||e[0],[t,e])}function G(){const{activePaymentMethodId:e}=Object(b.a)(U.a),{allowedPaymentMethods:t}=K();return Object(i.useMemo)(()=>{const a=t.find(t=>e.value===t.id);return q()(a,"there should always be an active payment method"),a},[t,e])}var Y=a("zYYD"),J=a.n(Y),$=a("N8wZ");function Z(){const e=Object($.a)(),t=Q(),a=W(),n=G().currency,l=Object(i.useMemo)(()=>(null===t||void 0===t?void 0:t.balance)||{amount:"0",currency:a.symbol},[a.symbol,null===t||void 0===t?void 0:t.balance]),r=e({currency:a.symbol,amount:l.amount},n);return{assetBalance:l,assetBalanceInFiat:Object(i.useMemo)(()=>({amount:J()(r),currency:n}),[n,r])}}var X=a("K/G0");function ee(){const{isFiatInput:e,eventContext:t,transferType:a,recurringPeriod:n}=Object(b.a)(U.a),l=W(),r=G().type,o=Object(i.useMemo)(()=>({currencyType:e.value?"fiat":"crypto",currency:l.symbol,repeat:"first_and_fifteenth"===n.value?"every_two_weeks":n.value,context:t.value,payment_method:r}),[e.value,l.symbol,n,r,t.value]);return Object(i.useCallback)((e,t={})=>{X.a.track(`${a.value}_${e}`,Object.assign({},o,t))},[o,a.value])}var te=a("+fIm");function ae(){const e=G(),t=Object(i.useMemo)(()=>e.recurringOptions?e.recurringOptions.map(e=>({key:e.period,label:e.label,value:e.period})):[],[e.recurringOptions]);return Object(i.useMemo)(()=>t.length>0,[t])}var ne=a("U0rQ"),le=a("B6gP");var re=a("GcVA"),oe=a("kSTq"),ie=a("iiUS"),se=a("AaJB");const ce=Object(c.c)({backToOrderPreview:{id:"BuySellStepper.DisclosuresStep.backToOrderPreview",defaultMessage:"Back to order preview"}});var ue=Object(re.b)((function({store:e}){const{formatMessage:t}=Object(u.a)(),{goBack:a}=Object(P.j)(U.c),n=e.tradeStore.userWarnings.find(e=>"buy_trade_disclosure"===e.id);return Object(i.useEffect)(()=>{(null===n||void 0===n?void 0:n.context)||a()},[n]),(null===n||void 0===n?void 0:n.context)?s.a.createElement(s.a.Fragment,null,Object(l.a)(j.h,{goBack:a,title:n.context.title}),Object(l.a)(j.s,{paddingBottom:24,align:"flex-start"},void 0,Object(l.a)(ie.VStack,{flexGrow:1,flexShrink:1,flexBasis:"auto"},void 0,n.context.details.map(e=>Object(l.a)(oe.a,{color:"light",paddingBottom:"md"},void 0,e))),Object(l.a)(se.a,{fullWidth:!0,size:"xlarge",type:"light",onClick:a},void 0,t(ce.backToOrderPreview)))):null})),de=a("TDwA"),be=a("eEWS"),pe=a("d9pb"),me=a("/4QY"),ye=a("Fc7c"),ge=a("6pIo"),fe=a("NTCc");function ve(){const{activePaymentMethodId:e}=Object(b.a)(U.a),{formattedPaymentMethods:t}=K();return Object(i.useMemo)(()=>{const a=t.find(t=>t.id===e.value);return q()(a,"there should always be a formatted payment method"),a},[e.value,t])}var je=a("8KiG"),Oe=a("yn0T"),Se=a("Ptqz");const he=Object(c.c)({neverTitle:{id:"BuySell.RecurrenceSelect.neverTitle",defaultMessage:"One time purchase"},dailyTitle:{id:"BuySell.RecurrenceSelect.dailyTitle",defaultMessage:"Daily"},dailyText:{id:"BuySell.RecurrenceSelect.dailyText",defaultMessage:"Every day starting today"},weeklyTitle:{id:"BuySell.RecurrenceSelect.weeklyTitle",defaultMessage:"Weekly"},weeklyText:{id:"BuySell.RecurrenceSelect.weeklyText",defaultMessage:"Every {weekday} starting today"},firstAndFifteenthTitle:{id:"BuySell.RecurrenceSelect.firstAndFifteenthTitle",defaultMessage:"1st and 15th of the month"},firstAndFifteenthText:{id:"BuySell.RecurrenceSelect.firstAndFifteenthText",defaultMessage:"Twice a month, including today"},monthlyTitle:{id:"BuySell.RecurrenceSelect.monthlyTitle",defaultMessage:"Monthly"},monthlyText:{id:"BuySell.RecurrenceSelect.monthlyText",defaultMessage:"Every month on the {dayOfMonth}"}}),ke={never:he.neverTitle,daily:he.dailyTitle,weekly:he.weeklyTitle,first_and_fifteenth:he.firstAndFifteenthTitle,monthly:he.monthlyTitle},Ce={daily:he.dailyText,weekly:he.weeklyText,first_and_fifteenth:he.firstAndFifteenthText,monthly:he.monthlyText};var Te=()=>{const{formatMessage:e}=Object(u.a)(),t=Object(i.useMemo)(()=>{const t=new Date;return{weekday:Object(Se.a)(t.getDay(),e),dayOfMonth:Object(Oe.a)(t.getDate(),e)}},[e]);return Object(i.useCallback)(a=>({title:e(ke[a]),text:Ce[a]?e(Ce[a],t):void 0}),[t,e])};const we=Object(c.c)({buyAssetHeader:{id:"BuySellStepper.EntryStep.buyAssetHeader",defaultMessage:"Buy {assetName}"},buyDefaultButton:{id:"BuySellStepper.EntryStep.buyDefaultButton",defaultMessage:"Buy {assetName}"},sellDefaultButton:{id:"BuySellStepper.EntryStep.sellDefaultButton",defaultMessage:"Sell {assetName}"},buyPreviewButton:{id:"BuySellStepper.EntryStep.buyPreviewButton",defaultMessage:"Preview Buy"},sellPreviewButton:{id:"BuySellStepper.EntryStep.sellPreviewButton",defaultMessage:"Preview Sell"},buySelectAssetLabel:{id:"BuySellStepper.EntryStep.buySelectAssetLabel",defaultMessage:"Buy"},sellSelectAssetLabel:{id:"BuySellStepper.EntryStep.sellSelectAssetLabel",defaultMessage:"Sell"},buySelectPaymentLabel:{id:"BuySellStepper.EntryStep.buySelectPaymentLabel",defaultMessage:"Pay with"},sellSelectPaymentLabel:{id:"BuySellStepper.EntryStep.sellSelectPaymentLabel",defaultMessage:"Add to"},sellEmptyError:{id:"BuySellStepper.EntryStep.sellEmptyError",defaultMessage:"You don\u2019t have any {assetName} to sell. Try buying some to get started."},sellAll:{id:"BuySellStepper.EntryStep.sellAll",defaultMessage:"Sell all"},achBuyDisabled:{id:"BuySellStepper.EntryStep.achBuyDisabled",defaultMessage:"Buying crypto with a bank account is temporarily unavailable. Please use a different payment method."}}),Be=(e,t,a)=>{const{assetName:n}=e,{formatMessage:l}=t,r=l(we.buyAssetHeader,{assetName:n}),o=we[a+"DefaultButton"],i=we[a+"PreviewButton"],s=we[a+"SelectAssetLabel"],c=we[a+"SelectPaymentLabel"],u=l(we.sellAll),d=l(we.achBuyDisabled),b=l(we.sellEmptyError,{assetName:n});return{buyAssetHeader:r,defaultButton:l(o,{assetName:n}),previewButton:l(i),selectAssetLabel:l(s),selectPaymentLabel:l(c),sellAll:u,sellEmptyError:b,achBuyDisabled:d}};function Pe({store:e,onPressSell:t=o.a,disabled:a}){const{recurringPeriod:n,transferType:r}=Object(b.a)(U.a),i=Object(u.a)(),{goToStep:s}=Object(P.j)(U.c),c=ae(),d=Te(),p=Be(e,i,r.value);return"sell"===r.value?Object(l.a)(je.a,{disabled:a,onPress:t,testID:"sell-all"},void 0,p.sellAll):c?Object(l.a)(je.a,{disabled:a,onPress:()=>s("recurringSelect"),endIcon:"caretDown",testID:"recurring-period"},void 0,d(n.value).title):null}var Me=a("eSKr"),Fe=a("FQEq"),Ae=a("i7H4"),Ie=a("7rk+");const _e=Object(c.c)({customAmountButtonTitle:{id:"BuySellStepper.EntryStep.PresetAmountsPanel.customAmountButtonTitle",defaultMessage:"Custom"}}),xe=({amounts:e,onPressAmount:t,store:a})=>{const[n,r]=Object(i.useState)(),{showPresetAmountsIfAvailable:o}=Object(b.a)(U.a),c=Object(u.a)(),d=Object(m.a)(),p=Object(Ie.a)(),y=Be(a,c,"buy"),g=Object(i.useCallback)(e=>{r(e),t(e)},[t]),f=Object(i.useMemo)(()=>Object(l.a)(be.Button,{variant:"secondary",onPress:()=>o.onChange(!1),disabled:a.tradeStore.isFetching},void 0,c.formatMessage(_e.customAmountButtonTitle)),[c,o,a.tradeStore.isFetching]),v=Object(i.useMemo)(()=>{const t=e.map(e=>Object(l.a)(be.Button,{variant:"secondary",disabled:a.tradeStore.isFetching,loading:n===e,onPress:()=>g(e),testID:null!=e?e:"buy-preset-custom-amount-button"},e,d({amount:{amount:e,currency:p},isFiat:!0,exponent:0})));return 3===t.length?Object(l.a)(Fe.VStack,{},void 0,Object(l.a)(Ee,{},void 0,t),Object(l.a)(Fe.Spacer,{vertical:2}),f):Object(l.a)(Ee,{},void 0,[...t,f])},[e,f,d,g,p,n,a.tradeStore.isFetching]);return s.a.createElement(s.a.Fragment,null,Object(l.a)(Fe.VStack,{},void 0,Object(l.a)(Ae.TextHeadline,{as:"label",align:"center"},void 0,y.buyAssetHeader),Object(l.a)(Fe.Spacer,{vertical:1}),Object(l.a)(Fe.VStack,{alignItems:"center"},void 0,Object(l.a)(Pe,{store:a,disabled:a.tradeStore.isFetching}),Object(l.a)(Fe.Spacer,{vertical:2})),v),Object(l.a)(Fe.Spacer,{vertical:2}))},Ee=d.e.div.withConfig({displayName:"PresetAmountsPanel__ButtonGrid",componentId:"sc-1nqk8mx-0"})(["display:grid;grid-gap:",";grid-template-columns:repeat(3,1fr);grid-auto-rows:auto;"],()=>Me.a.size.large);var Re=Object(i.memo)(xe);var Le=Object(c.c)({invalidInputWarning:{id:"BuySell.invalidInputWarning",defaultMessage:"Please enter a valid input amount."}}),De=a("tU0a"),Ke=a("avPW"),Ne=a("dkP0"),Ue=a("08rN");function Ve({tradeStore:e}){const{goToStep:t}=Object(P.j)(U.c),a=ee(),{activePaymentMethodId:n}=Object(b.a)(U.a);return Object(i.useCallback)(l=>{n.value!==l&&(e.clearErrors(),n.onChange(l),a("tapped_select_payment_method"),t("entry"))},[e,a,n,t])}function He({store:e}){const{formatMessage:t}=Object(u.a)(),{goToStep:a}=Object(P.j)(U.c),{transferType:n}=Object(b.a)(U.a),l=Object(i.useRef)(""),{experimentalAssets:r}=K(),o=G(),s=o.type,{getCorrelationId:c}=Object(Ne.a)(Object(Ue.d)(s)),d="buy"===n.value,p=Ve(e),m=ee(),y=Object(Ke.a)(),g=W(),f=Object(k.c)({assetId:null===g||void 0===g?void 0:g.id,isExperimental:r.has(null===g||void 0===g?void 0:g.id)})&&d?"experimentalAssetConfirmation":"preview",v=Object(i.useCallback)(async t=>{m("tapped_preview"),e.updateTradeStoreInputs(t),e.tradeStore.clearErrors();const n=await e.tradeStore.createTransfer({amount:t,inputType:e.inputType,submit:!1});(null===n||void 0===n?void 0:n.id)&&a(f)},[e,m,a,f]),j=Object(i.useCallback)(async t=>{e.tradeStore.setBraintreeCorrelationId(t),await v(l.current)},[v,e.tradeStore]),O=Object(i.useCallback)(t=>{t.response?e.tradeStore.addError(t):e.tradeStore.setServerValidationError(t.message)},[e]),S=Object(i.useCallback)(async t=>{const{tradeStore:a}=e;try{a.setIsFetching(!0);const e=await y(t);e&&p(e.id)}catch(n){throw a.addError(n),n}finally{a.setIsFetching(!1)}},[e,y,p]),h=Object(De.a)({payPalPaymentMethod:o,onSubmit:j,onSignInComplete:S,onError:O}),C=Object(i.useCallback)(async e=>{l.current=e,await h()},[h]),T=Object(i.useCallback)(async t=>{try{const a=await c();e.tradeStore.setBraintreeCorrelationId(a),await v(t)}catch(a){O(a)}},[e.tradeStore,c,v,O]);return Object(i.useCallback)(async({amount:a,onFailure:n})=>{if(!parseFloat(a))return e.tradeStore.setServerValidationError(t(Le.invalidInputWarning)),void(null===n||void 0===n||n());if(d&&"paypal_account"===s)await C(a);else if(d&&Object(Ue.f)(s))await T(a);else try{await v(a)}catch(l){null===n||void 0===n||n()}},[t,v,T,C,d,s,e.tradeStore])}var qe=a("hqqT");const ze=Object(c.c)({buyPowerText:{id:"BuySellStepper.EntryStep.buyPowerText",defaultMessage:"You can buy up to {limit}"}}),We=Object(c.c)({previewButtonLabel:{id:"BuySellStepper.EntryStep.previewButtonLabel",defaultMessage:"Preview {type}"}}),Qe=({children:e})=>(Object(de.useLogEventOnMount)("trading_ex_buy_power_viewed",{componentType:de.ComponentType.page,loggingId:"6f24c5b3-575a-4172-b72b-336a9c66d05b"}),s.a.createElement(s.a.Fragment,null,e)),Ge=d.e.div.withConfig({displayName:"EntryStep__ButtonWrapper",componentId:"sc-168c6fk-0"})(["opacity:",";"],e=>e.faded?.5:1);var Ye=Object(re.b)(({footer:e,closeModal:t,entryButton:a,store:n})=>{const r=He({store:n}),{showModal:o}=Object(x.a)(),{renderTabs:c}=Object(i.useContext)(C.b),d=Object(fe.a)(),p=Object(ne.a)(),m=Object(u.a)(),{goToStep:y}=Object(P.j)(U.c),{isFiatInput:g,isSellingAll:O,showPresetAmountsIfAvailable:S,transferType:h}=Object(b.a)(U.a),k=Be(n,m,h.value),T=function(e){const{isFiatInput:t}=Object(b.a)(U.a),a=ee();return Object(i.useCallback)(async()=>{a("tapped_switch");const{tradeStore:n,inputValue:l,inputType:r}=e;if(n.clearErrors(),""!==l)try{await n.createTransfer({amount:l,inputType:r,submit:!1})}catch(o){e.tradeStore.addError(o)}t.onChange(!t.value)},[a,e,t])}(n),w=W(),{assetBalance:M}=Z(),F=function(e){const t=Object(u.a)(),{goToStep:a}=Object(P.j)(U.c),{transferType:n}=Object(b.a)(U.a),{name:l,imageUrl:r}=W(),o=Be(e,t,n.value);return Object(i.useMemo)(()=>({primaryLabel:o.selectAssetLabel,image:r,secondaryLabel:l,onPress:()=>a("selectAsset"),testID:n.value+"-asset-selector"}),[o.selectAssetLabel,r,l,n.value,a])}(n),A=function(e){const t=Object(u.a)(),{goToStep:a}=Object(P.j)(U.c),{transferType:n}=Object(b.a)(U.a),r=ee(),{rejected:o,isRevoked:s,disableBuyReason:c}=G(),{label:d,icon:p}=ve(),m=Be(e,t,n.value),y=Object(i.useCallback)(()=>{r("tapped_select_payment_method"),a("selectPayment")},[r,a]),g=Object(i.useMemo)(()=>s||o?Object(l.a)(qe.Icon,{name:"error",color:o?"negative":"foreground",size:"s"}):null,[s,o]);return Object(i.useMemo)(()=>({icon:p,hasError:o,primaryLabel:m.selectPaymentLabel,secondaryLabel:d,pmDisabled:"wbl"===c,rightIcon:g,onPress:y,testID:n.value+"-payment-method-selector"}),[c,y,p,d,m.selectPaymentLabel,o,g,n.value])}(n),{accounts:I,totalHoldBalance:R,rewards:L}=Object(f.a)(),D=Object(B.a)({rewards:L,assetUuid:w.id}),K=Object(E.a)({accounts:I}),N=Object(_.a)({accounts:I,totalHoldBalance:R,totalNativeBalance:K}),{tradeStore:V,setInputAmount:H,inputValue:q,fiatCode:z}=n,Q=G(),Y=ve(),{showError:J,isFetching:$}=V,X=N({paymentMethod:Q,transferType:h.value}),te=Object(v.a)(null!=X?X:0),ae=S.value&&!!te,le=p&&!!t,re=le,oe=Object(i.useMemo)(()=>le&&t?t:void 0,[le,t]),se=""===n.inputValue?k.defaultButton:k.previewButton,ce=Boolean("sell"===h.value&&0===parseFloat(M.amount)),ue=Object(i.useCallback)((e=q)=>{if(D)return y("principalInsolvency");d&&Y.paypalReauthRequired?o(Object(l.a)(me.a,{})):Q.rejected?y("paymentError"):ce||(O.onChange(!1),r({amount:e}))},[q,D,d,Y.paypalReauthRequired,Q.rejected,ce,o,y,O,r]),de=g.value?z:w.symbol,je=g.value?w.symbol:z,Oe=!!Q.rejected||"wbl"===Q.disableBuyReason,{formatMessage:Se,formatNumber:he}=Object(u.a)(),ke="buy"===h.value&&!q&&X,Ce="buy"===h.value?"BUY":"SELL";return s.a.createElement(s.a.Fragment,null,Object(l.a)(ge.a,{view:Ce,currencies:[w.symbol]}),Object(l.a)(ye.a,{view:Ce,currencies:[w.symbol]}),c&&c(),re&&Object(l.a)(j.h,{goBack:oe}),Object(l.a)(j.s,{paddingTopDesktop:j.q,paddingTopMobile:j.q},void 0,ae&&te?Object(l.a)(Re,{store:n,amounts:te,onPressAmount:ue}):Object(l.a)(j.d,{autoFocus:!0,error:(()=>{const{serverValidationErrorId:e,serverValidationError:t}=n.tradeStore;return ce?k.sellEmptyError:"limit_error_increase_eligible"===e?Object(l.a)(pe.b,{errorText:t,eventNameOnView:pe.d.viewBuyEntry,eventNameOnClick:pe.d.clickBuyEntry}):"ach_buy_unavailable"===e?k.achBuyDisabled:t})(),input:{symbol:de,value:q,onChange:H,onEnter:()=>ue(),readOnly:ce},additionalInfo:n.tradeStore.additionalErrorInfo,onAdditionalInfoClick:()=>y("additionalInfo"),helperText:ke?Object(l.a)(Qe,{},void 0,Se(ze.buyPowerText,{limit:he(X||0,{style:"currency",currency:z})})):null,switchActiveInput:{onPress:T,inactiveSymbol:je},secondaryButton:Object(l.a)(Pe,{store:n,onPressSell:n.sellAll})}),Object(l.a)(ie.VStack,{},void 0,Object(l.a)(j.f,{noBottomPadding:ae,row1:F,row2:A}),!ae&&Object(l.a)(Ge,{faded:Oe},void 0,Object(l.a)(be.Button,{block:!0,disabled:J||$,loading:$,onPress:()=>ue(),testID:h.value+"-preview-button","data-testid":h.value+"-preview-button","aria-label":Se(We.previewButtonLabel,{type:h.value})},void 0,se)),a)),e)}),Je=a("iKd7"),$e=a("4roM");const Ze=Object(c.c)({titleBuy:{id:"BuySellFeesInfo.titleBuy",defaultMessage:"Fees on Cryptocurrency Purchases"},titleSell:{id:"BuySellFeesInfo.titleSell",defaultMessage:"Fees on Cryptocurrency Sales"},content:{id:"BuySellFeesInfo.content",defaultMessage:"In addition to the displayed Coinbase fee, we include a spread in the price. Cryptocurrency markets are volatile, and this allows us to temporarily lock in a price for trade execution."},contentUSDC:{id:"BuySellFeesInfo.contentUSDC",defaultMessage:"Purchases and sales of USDC do not include an additional spread in the price."},learnMore:{id:"BuySellFeesInfo.learnMore",defaultMessage:"Learn more"},titleRecurring:{id:"BuySellFeesInfo.titleRecurring",defaultMessage:"Fees on Recurring Purchases"},contentRecurring:{id:"BuySellFeesInfo.contentRecurring",defaultMessage:"For recurring purchases, we calculate the Coinbase Fee at the time of each trade. In addition to the Coinbase fee, we include a spread in the exchange rate."},contentRecurringUSDC:{id:"BuySellFeesInfo.contentRecurringUSDC",defaultMessage:"For recurring purchases, we calculate the Coinbase Fee at the time of each trade."},contentAdvancedTrade:{id:"BuySellFeesInfo.contentAdvancedTrade",defaultMessage:"In addition to the displayed Coinbase fee, we include a spread in the price. When using Advanced Trade, no spread is included because you are interacting directly with the order book. Cryptocurrency markets are volatile, and this allows us to temporarily lock in a price for trade execution."},contentRecurringAdvancedTrade:{id:"BuySellFeesInfo.contentRecurringAdvancedTrade",defaultMessage:"For recurring purchases, we calculate the Coinbase Fee at the time of each trade. In addition to the Coinbase fee, we include a spread in the exchange rate. When using Advanced Trade, no spread is included because you are interacting directly with the order book."}}),Xe=({recurringPeriod:e,tradeType:t})=>{const{goBack:a}=Object(P.j)(U.c),{formatMessage:n}=Object(u.a)(),{symbol:r}=W(),o=Boolean(e&&"never"!==e),s="USDC"===r,c=Object($e.a)(),d=Object(i.useMemo)(()=>{let e;return e=n(o?Ze.titleRecurring:"buy"===t?Ze.titleBuy:Ze.titleSell),e},[n,o,t]),b=Object(i.useMemo)(()=>{let e;return e=n(o?s?Ze.contentRecurringUSDC:c?Ze.contentRecurringAdvancedTrade:Ze.contentRecurring:s?Ze.contentUSDC:c?Ze.contentAdvancedTrade:Ze.content),e},[n,c,o,s]),p=Object(i.useMemo)(()=>({title:d,message:b,cta:{url:"https://help.coinbase.com/en/coinbase/trading-and-funding/pricing-and-fees/fees",text:n(Ze.learnMore)}}),[n,b,d]);return Object(l.a)(Je.a,{goBackHandler:a,content:p})};var et=Object(i.memo)(Xe),tt=a("/nOA"),at=a("OKDF");var nt=Object(re.b)(({tradeData:e})=>{const{goToStep:t,goBack:a}=Object(P.j)(U.c),{transferType:n}=Object(b.a)(U.a),{formattedPaymentMethods:r}=K(),o=ve(),s=ee(),c=Object(at.a)(),u=Object(i.useMemo)(()=>e.cardStatus?e.cardStatus:o.rejected?"rejected":"declined",[e.cardStatus,o]),d=Object(i.useCallback)(()=>{c(),t("entry")},[t,c]),p=Object(i.useCallback)(()=>{s("tapped_select_payment_method"),t("selectPayment")},[t,s]),m=!e.cardStatus;return Object(l.a)(tt.b,{cardStatus:u,onAddAccountsSuccess:d,onAddAgainSuccess:m?d:void 0,onChangePaymentMethod:r.length>1?p:void 0,onGoBack:a,paymentMethod:o,transferType:n.value})}),lt=a("QFYQ"),rt=a.n(lt),ot=a("WI56"),it=a("IPNR"),st=a("/bOI"),ct=a("dgBL"),ut=a("V21s"),dt=a("wiuo"),bt=a("qMrP"),pt=a("DDg1"),mt=a("mxbj"),yt=a("4gc5"),gt=a("UP4x"),ft=a("hGpA"),vt=a.n(ft),jt=a("hIT1"),Ot=a("nuP0");const St=Object(c.c)({genericError:{id:"UseApplePayBuySubmitter.genericError",defaultMessage:"Something went wrong. Please try again later"}}),ht="Coinbase",kt=({transfer:e,paymentMethod:t})=>{const[{paymentRequest:a,applePayClient:n},l]=Object(i.useState)({}),{getBraintreeClient:r}=Object(Ne.a)("apple_pay"),{formatMessage:o}=Object(u.a)(),{showErrorToast:s}=Object(mt.a)(),c=Object(i.useCallback)((e,t)=>{Bugsnag.notify(e,{metaData:{context:"useApplePayBuySubmitter."+t}}),s(o(St.genericError))},[s,o]);Object(i.useEffect)(()=>{let a,n;if("apple_pay"===(null===t||void 0===t?void 0:t.type)){const{promise:o,cancel:i}=Object(jt.a)((async()=>{try{a=await r(),n=await vt.a.applePay.create({client:a})}catch(e){c(e,"createApplePayClient")}})());return o.then(()=>{if(n){var a;const r=n.createPaymentRequest(Object.assign({total:{label:ht,amount:null===e||void 0===e||null===(a=e.total)||void 0===a?void 0:a.amount}},Object(Ot.b)(null===t||void 0===t?void 0:t.pickerData)));l({applePayClient:n,paymentRequest:r})}}).catch(e=>{c(e,"createPaymentRequest")}),()=>{var e,t;i(),null===(e=a)||void 0===e||e.teardown(),null===(t=n)||void 0===t||t.teardown()}}},[]);return{isApplePayReady:Object(i.useMemo)(()=>!(!n||!a),[n,a]),submitApplePayBuy:Object(i.useCallback)(e=>{if(n)try{const t=new ApplePaySession(3,a);t.onvalidatemerchant=e=>{n.performValidation({validationURL:e.validationURL,displayName:ht},(e,a)=>{e?c(e,"submitApplePayBuy.onvalidatemerchant"):t.completeMerchantValidation(a)})},t.onpaymentauthorized=a=>{n.tokenize({token:a.payment.token},(a,n)=>{if(a)return c(a,"submitApplePayBuy.onpaymentauthorized"),void t.completePayment(ApplePaySession.STATUS_FAILURE);t.completePayment(ApplePaySession.STATUS_SUCCESS),e(n.nonce)})},t.begin()}catch(t){c(t,"submitApplePayBuy"),console.error(t)}},[a,n,c])}};var Ct=a("bNYv");var Tt=a("F1kk");const wt=Object(c.c)({genericError:{id:"TradeState.genericError",defaultMessage:"Something went wrong. Please try again later"}});var Bt=function({tradeState:e}){const{formatMessage:t}=Object(u.a)(),{showErrorToast:a}=Object(mt.a)(),{goToStep:n}=Object(P.j)(U.c),l=G(),r=Q(),o=function(){const e=Object(Tt.a)();return Object(i.useCallback)((t,a,n)=>{e({maxPollAttempts:a,resource:async()=>R.b.get(t),onResponse:e=>{return"completed"===e.data.status||"canceled"===e.data.status?{type:"Result",result:{type:e.data.status}}:"created"!==e.data.status&&"started"!==e.data.status||!e.data.requiresCompletionStep?{type:"ContinuePolling"}:{type:"Result",result:{type:e.data.status,options:{url:null===(t=e.data.secure3DVerification)||void 0===t?void 0:t.url,payload:null===(a=e.data.secure3DVerification)||void 0===a?void 0:a.payload}}};var t,a},onComplete:e=>{switch(e.type){case"Success":return n(e.result);case"MaxRetries":case"Error":return n({type:"canceled"})}}})},[e])}();return Object(i.useCallback)(async i=>{const{transferData:s,params:c,inputValue:u,inputType:d,addError:b,clearErrors:p,setIsCommitting:m,setTransferData:y}=e;m(!0);try{q()(s&&s.id,"transferData must be defined in commitTransfer");const e=c(!0,u,d),g=`/v2/accounts/${r.id}/${"buy"===i?"buys":"sells"}/${s.id}/commit`,f=await R.b.post(g,e);if(f){q()(f.data,"we expect res to still be defined when Commit transfer runs in commitTransfer"),p();const e=f.data.nextStep;if("poll_and_secure3d_redirect"===(null===e||void 0===e?void 0:e.action)&&"worldpay_card"===l.type)return o(e.pollPath,e.maxPollAttempts,e=>{switch(e.type){case"canceled":return a("Could not complete purchase"),y(f.data),m(!1),n("status");case"completed":return y(f.data),m(!1),n("status");case"started":case"created":return function({verify3dsOptions:e,transferData:t,onError:a,activeAccount:n,activePaymentMethodId:l,activePaymentMethodName:r}){const{url:o,payload:i}=e,s=()=>{X.a.track("three_ds_load_failed",{action:de.ActionType.render,componentType:de.ComponentType.page,loggingId:"8cc8c6b3-6f99-4b09-aa1e-ed8424541a94"}),a()};try{const e={id:n.id,name:n.name},a={id:l,name:r};localStorage.setItem("SECURE3D_TRANSFER_DATA",JSON.stringify(t)),localStorage.setItem("SECURE3D_ACCOUNT",JSON.stringify(e)),localStorage.setItem("SECURE3D_PAYMENT_METHOD",JSON.stringify(a)),localStorage.setItem("SECURE3D_ORIGIN_ROUTE",location.pathname),localStorage.getItem("SECURE3D_TRANSFER_DATA")&&localStorage.getItem("SECURE3D_ACCOUNT")&&localStorage.getItem("SECURE3D_PAYMENT_METHOD")?(X.a.track("three_ds_load_completed",{action:de.ActionType.render,componentType:de.ComponentType.page,loggingId:"5b6fc053-5d7f-499f-8b1e-566368082491"}),Object(Ct.a)(o,"POST",i)):s()}catch(c){Bugsnag.notify(c),s()}}({verify3dsOptions:e.options,transferData:s,onError:()=>b({message:t(wt.genericError)}),activeAccount:r,activePaymentMethodId:l.id,activePaymentMethodName:l.name})}});y(f.data),m(!1),n("status")}}catch(g){b(g),Bugsnag.notify("TradeStore failed commit transfer",{metaData:{apiError:g}})}},[e,r,l,o,a,n,t])},Pt=a("sjxy");const Mt=Object(c.c)({genericError:{id:"UseGooglePayBuySubmitter.genericError",defaultMessage:"Something went wrong. Please try again later"}});function Ft(){return(Ft=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var At=i.createElement("circle",{cx:12,cy:12,r:12,fill:"#1652F0"}),It=i.createElement("path",{d:"M9.78 18.21l-5.33-5.33 1.77-1.76 3.56 3.56 8-8.01 1.77 1.77-9.77 9.77z",fill:"#fff"});a.p;var _t=a("B05N"),xt=a("5pfX"),Et=a("47un");function Rt({store:e,messages:t,setHighlightRecurringBuy:a}){const{tradeStore:n,inputValue:r,inputType:o}=e,{goToStep:c}=Object(P.j)(U.c),{recurringPeriod:u}=Object(b.a)(U.a),d=ee(),p=Object(i.useCallback)(async()=>{d("tapped_recurring_trade_upsell_banner",{recurringPeriod:"weekly"});try{await n.createTransfer({amount:r,submit:!1,inputType:o,paramsOverride:{quote:!1,commit:!1,recurring_period:"weekly"}}),u.onChange("weekly")}catch(e){Bugsnag.notify(e,{metaData:{context:"Preview transfer with recurring period failed",recurringPeriod:"weekly"}}),c("entry")}a(!0)},[d,a,n,r,o,u,c]);return Object(l.a)(Et.c,{icon:Object(l.a)(qe.Icon,{name:"recurring",size:"m"}),text:s.a.createElement(s.a.Fragment,null,Object(l.a)(Lt,{},void 0,t.upsellRecurringBuyTitle),Object(l.a)(Dt,{},void 0,t.upsellRecurringBuyDescription)),rightContent:Object(l.a)(xt.a,{type:"light",size:"normal",onClick:p},void 0,t.upsellRecurringBuyButton)})}const Lt=Object(d.e)(_t.a).attrs(()=>({color:"accent"})).withConfig({displayName:"ConvertTradeToRecurringBanner__PreviewHeader",componentId:"sc-1f1lkz0-0"})(["font-size:",";"],e=>e.theme.fontSize.small),Dt=Object(d.e)(oe.a).attrs(()=>({color:"light"})).withConfig({displayName:"ConvertTradeToRecurringBanner__PreviewText",componentId:"sc-1f1lkz0-1"})(["font-size:",";"],e=>e.theme.fontSize.tiny);var Kt=Object(i.memo)(Rt);var Nt=function(e,t){var a;const{isInUS:n}=Object(yt.a)(),{recurringPeriod:l}=Object(b.a)(U.a),{transferData:r}=e.tradeStore,o=ae()&&!t,i=Number(null===r||void 0===r||null===(a=r.total)||void 0===a?void 0:a.amount)<=25e3,s="never"!==l.value,c="buy"===(null===r||void 0===r?void 0:r.resource);return n&&(i&&c&&!s)&&o},Ut=a("DRDe");function Vt(){return(Vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Ht=i.createElement("path",{d:"M49.638 0C22.254 0 0 22.254 0 49.638 0 77.02 22.254 99.275 49.638 99.275c27.383 0 49.637-22.254 49.637-49.637C99.275 22.254 77.021 0 49.638 0zm0 95.139c-25.109 0-45.502-20.393-45.502-45.501 0-25.109 20.393-45.502 45.502-45.502 25.108 0 45.501 20.393 45.501 45.502 0 25.108-20.393 45.501-45.501 45.501z",fill:"#1652F0"}),qt=i.createElement("path",{d:"M57.29 35.78l-2.936 2.937 8.893 8.894H28.956v4.136h34.291l-8.893 8.894 2.937 2.937L69.7 51.168a2.048 2.048 0 000-2.937l-12.41-12.45z",fill:"#1652F0"});a.p;var zt=a("r4+4");const Wt=Object(c.c)({previewHeader:{id:"BuySellStepper.PreviewStep.previewHeader",defaultMessage:"Order preview"},buyButton:{id:"BuySellStepper.PreviewStep.buyButton",defaultMessage:"Buy now"},sellButton:{id:"BuySellStepper.PreviewStep.sellButton",defaultMessage:"Sell now"},recurringLabel:{id:"BuySellStepper.PreviewStep.recurringLabel",defaultMessage:"Recurring"},buyActionLabel:{id:"BuySellStepper.PreviewStep.buyActionLabel",defaultMessage:"Purchase"},sellActionLabel:{id:"BuySellStepper.PreviewStep.sellActionLabel",defaultMessage:"Sale"},buyTotalLabel:{id:"BuySellStepper.PreviewStep.buyTotalLabel",defaultMessage:"Total"},sellTotalLabel:{id:"BuySellStepper.PreviewStep.sellTotalLabel",defaultMessage:"Total payout"},priceLabel:{id:"BuySellStepper.PreviewStep.priceLabel",defaultMessage:"Price"},wblNoticeText:{id:"BuySellStepper.PreviewStep.wblNoticeText",defaultMessage:"Trade instantly on Coinbase, available to send in {holdDays} days."},wblNoticeLink:{id:"BuySellStepper.PreviewStep.wblNoticeLink",defaultMessage:"Need to send instantly?"},wblNoticeTextNew:{id:"BuySellStepper.PreviewStep.wblNoticeTextNew",defaultMessage:"Trade your {assetCode} {instantly} while we wait for your funds. You can send your {assetCode} in up to {holdDays}."},wblNoticeTextNewInstantly:{id:"BuySellStepper.PreviewStep.wblNoticeTextNewInstantly",defaultMessage:"instantly"},wblNoticeTextNewHoldDays:{id:"BuySellStepper.PreviewStep.wblNoticeTextNewHoldDays",defaultMessage:"{holdDays} days"},instantAchEntireText:{id:"BuySellStepper.PreviewStep.instantAchEntireText",defaultMessage:"Want to send your {assetCode}? You can send the full amount <b>instantly</b>."},instantAchPartialText:{id:"BuySellStepper.PreviewStep.instantAchPartialText",defaultMessage:"Want to send your {assetCode}? You can send {amount} in {assetCode} <b>instantly</b>. The rest of your purchase will be available to send in <b>{x} days</b>, after your funds arrive."},sellsUnsupportedText:{id:"BuySellStepper.PreviewStep.sellsUnsupportedText",defaultMessage:"Selling is not yet supported in your country. You will have to hold or send."},sellsUnsupportedLink:{id:"BuySellStepper.PreviewStep.sellsUnsupportedLink",defaultMessage:"Learn more."},processedByText:{id:"BuySellStepper.PreviewStep.processedByText",defaultMessage:"Processed by"},processedByLink:{id:"BuySellStepper.PreviewStep.processedByLink",defaultMessage:"Coinbase UK, Ltd."},promoDescription:{id:"BuySellStepper.PreviewStep.promoDescription",defaultMessage:"Until June 30th, enjoy flat 1.49% fees on all recurring buys.  After that, fees return to normal."},promoLink:{id:"BuySellStepper.PreviewStep.promoLink",defaultMessage:"Learn more about our fees."},recurringReward:{id:"BuySellStepper.PreviewStep.recurringReward",defaultMessage:"You'll earn {reward} {assetSymbol} after your {nth} buy"},recurringRewardMultiplePayouts:{id:"BuySellStepper.PreviewStep.recurringRewardMultiplePayouts",defaultMessage:"You'll earn {reward} {assetSymbol} after both your {nth} buys"},recurringRewardNudge:{id:"BuySellStepper.PreviewStep.recurringRewardNudge",defaultMessage:"Add {amount} and get {reward} {assetSymbol} after your {nth} recurring buy"},recurringRewardNudgeMultiplePayouts:{id:"BuySellStepper.PreviewStep.recurringRewardNudgeMultiplePayouts",defaultMessage:"Add {amount} and get {reward} {assetSymbol} after both your {nth} buys"},recurringRewardAdd:{id:"BuySellStepper.PreviewStep.recurringRewardAdd",defaultMessage:"Add {amount}"},recurringTransactionRewardTerms:{id:"BuySellStepper.PreviewStep.recurringTransactionRewardTerms",defaultMessage:"See terms for this recurring buy offer."},feeWaived:{id:"BuySellStepper.PreviewStep.feeWaived",defaultMessage:"We've waived the fee on your first Coinbase purchase. <b>Enjoy your crypto!</b>"},free:{id:"BuySellStepper.PreviewStep.free",defaultMessage:"Free"},seeMore:{id:"BuySellStepper.PreviewStep.seeMore",defaultMessage:"See more"},upsellRecurringBuyTitle:{id:"BuySellStepper.PreviewStep.upsellRecurringBuyTitle",defaultMessage:"Make this a weekly buy?"},upsellRecurringBuyDescription:{id:"BuySellStepper.PreviewStep.upsellRecurringBuyDescription",defaultMessage:"You can cancel any time"},upsellRecurringBuyButton:{id:"BuySellStepper.PreviewStep.upsellRecurringBuyButton",defaultMessage:"Yes"},genericError:{id:"BuySellStepper.PreviewStep.genericError",defaultMessage:"Something went wrong. Please try again later"}}),Qt=e=>{const t=Object(u.a)(),{formatMessage:a}=t,n=Object(m.a)(),r=W(),{isFiatInput:o,transferType:{value:i}}=Object(b.a)(U.a),{tradeStore:s}=e,c=ve(),{subtotal:d,amount:p,total:y,unitPrice:g,holdDays:f=0,recurringPayment:v,instantAch:j}=s.transferData||{},O=n({amount:p,isFiat:!1}),S=n({amount:y,isFiat:!0}),h=n({amount:g,isFiat:!0}),k=v&&v.period||"never",C="never"!==k?Object(zt.b)({formatMessage:a,period:k,amount:o.value?S:O}):void 0,T="never"!==k?Object(zt.a)({formatMessage:a,period:k}):void 0,w=a(Wt.feeWaived,{b:e=>[Object(l.a)("b",{},"feeWaived",e)]}),B=0===f?void 0:a(Wt.wblNoticeText,{holdDays:f}),P=0===f||j?void 0:a(Wt.wblNoticeTextNew,{holdDays:Object(l.a)("b",{},void 0,a(Wt.wblNoticeTextNewHoldDays,{holdDays:f})),assetCode:r.symbol,instantly:Object(l.a)("b",{},void 0,a(Wt.wblNoticeTextNewInstantly))}),M=j?j.isTotalInstant||0===f?a(Wt.instantAchEntireText,{assetCode:r.symbol,b:e=>[Object(l.a)("b",{},"limitPeriod",e)]}):a(Wt.instantAchPartialText,{assetCode:r.symbol,b:e=>[Object(l.a)("b",{},"limitPeriod",e)],x:f,amount:n({amount:j.instantAchAmount,isFiat:!0,exponent:0})}):void 0;return{header:a(Wt.previewHeader),cryptoAmount:O,paymentLabel:Be(e,t,i).selectPaymentLabel,paymentValue:c.label,recurringLabel:a(Wt.recurringLabel),recurringValue:C,recurringValueDetails:T,priceLabel:a(Wt.priceLabel),priceValue:`${h} / ${r.symbol}`,priceValueShort:""+h,actionLabel:a(Wt[i+"ActionLabel"]),actionValue:n({amount:d,isFiat:!0}),totalLabel:a(Wt[i+"TotalLabel"]),totalValue:S,button:a(Wt[i+"Button"]),wblNoticeText:B,wblNoticeTextNew:P,instantAchText:M,wblNoticeLink:a(Wt.wblNoticeLink),sellsUnsupportedText:a(Wt.sellsUnsupportedText),sellsUnsupportedLink:a(Wt.sellsUnsupportedLink),processedByText:a(Wt.processedByText),processedByLink:a(Wt.processedByLink),promoDescription:a(Wt.promoDescription),promoLink:a(Wt.promoLink),recurringReward:(e,t)=>a(1===t.length?Wt.recurringReward:Wt.recurringRewardMultiplePayouts,{reward:n({amount:{amount:e.value,currency:e.currency},isFiat:!0,exponent:0}),assetSymbol:"BTC",nth:Object(Oe.b)(t,a)}),recurringRewardNudge:(e,t,l)=>a(1===l.length?Wt.recurringRewardNudge:Wt.recurringRewardNudgeMultiplePayouts,{amount:n({amount:{value:e,currency:s.activeFiatCurrency||"USD"},isFiat:!0}),reward:n({amount:t,isFiat:!0,exponent:0}),assetSymbol:"BTC",nth:Object(Oe.b)(l,a)}),recurringRewardAdd:e=>a(Wt.recurringRewardAdd,{amount:n({amount:{amount:e,currency:s.activeFiatCurrency||"USD"},isFiat:!0})}),recurringTransactionRewardTerms:a(Wt.recurringTransactionRewardTerms),feeWaived:w,free:a(Wt.free),seeMore:a(Wt.seeMore),upsellRecurringBuyTitle:a(Wt.upsellRecurringBuyTitle),upsellRecurringBuyDescription:a(Wt.upsellRecurringBuyDescription),upsellRecurringBuyButton:a(Wt.upsellRecurringBuyButton),genericError:a(Wt.genericError)}};var Gt=a("bH2g"),Yt=a("dUm2"),Jt=a("iNnr"),$t=a("abUL"),Zt=a("JY1H"),Xt=a("HSok"),ea=a("qHf1");const ta=({store:e,messages:t})=>Object(l.a)(Jt.a,{},void 0,Object(l.a)($t.b,{boundaryName:"RecurringTradeRewardsPreviewBanners"},void 0,Object(l.a)(Gt.a,{fallback:null},void 0,Object(l.a)(aa,{store:e,messages:t})))),aa=({store:e,messages:t})=>{const a=W(),{recurringPeriod:n}=Object(b.a)(U.a),r=Object(ea.a)(a.symbol,"never"===n.value||!a.symbol),{userEligibleForNewBonus:o,recurringTransactionBonus:i}=r;return o&&(null===i||void 0===i?void 0:i.assetEligible)?Object(l.a)(na,{bonusDetails:r,store:e,messages:t}):null},na=({store:e,messages:t,bonusDetails:a})=>{const{goToStep:n}=Object(P.j)(U.c),{splitTestName:r,recurringTransactionBonus:o,hasRewardData:c}=a,{amountThreshold:u,payout:d,nthPaymentTriggers:b}=o,{banner:p,difference:m}=Object(Zt.a)(null===u||void 0===u?void 0:u.value,e.tradeStore.fiatTotalValue||""),y=Object(Xt.c)({bonus:o}),g=Object(Xt.d)({bonus:o}),f=Object(i.useCallback)(()=>{y(),u&&e.tradeStore.changeFiatTotalValue(u.value),n("entry")},[y,u,e.tradeStore,n]),v=Object(st.useVariant)(bt.a[r]),O=v&&"control"!==v&&c;if(Object(i.useEffect)(()=>{O&&g({reachedThreshold:"reward"===p})},[]),!O)return null;const S="reward"===p?Object(l.a)(j.u,{icon:Object(l.a)(Yt.default,{symbol:"BTC",size:30}),text:t.recurringReward(d,b)}):null,h="upsell"===p?Object(l.a)(la,{body:t.recurringRewardNudge(m,d,b),upsellText:t.recurringRewardAdd(m),onUpsellClick:f}):null,k=p?Object(l.a)(j.x,{text:t.recurringTransactionRewardTerms,onClick:()=>n("recurringRewardTerms")}):null;return s.a.createElement(s.a.Fragment,null,S,h,k)},la=({body:e,upsellText:t,onUpsellClick:a})=>Object(l.a)(j.u,{icon:Object(l.a)(Yt.default,{symbol:"BTC",size:30}),text:e,rightContent:Object(l.a)(ra,{onClick:a},void 0,Object(l.a)(oa,{},void 0,t))}),ra=Object(d.e)(ot.a).withConfig({displayName:"RecurringTradeRewardPreviewBanners__PreviewButton",componentId:"sc-1pmreoq-0"})(["margin-left:",";min-width:60px;"],({theme:e})=>e.size.large),oa=Object(d.e)(oe.a).attrs({color:"accent"}).withConfig({displayName:"RecurringTradeRewardPreviewBanners__PreviewButtonText",componentId:"sc-1pmreoq-1"})(["font-weight:",";font-size:",";text-align:center;"],e=>e.theme.fontWeight.demiBold,e=>e.theme.fontSize.tiny);var ia=Object(i.memo)(ta);function sa(){return(sa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ca=i.createElement("path",{d:"M28 64c15.464 0 28-12.536 28-28S43.464 8 28 8 0 20.536 0 36s12.536 28 28 28z",fill:"#1652f0"}),ua=i.createElement("path",{d:"M28 59.5c12.979 0 23.5-10.521 23.5-23.5S40.979 12.5 28 12.5 4.5 23.021 4.5 36 15.021 59.5 28 59.5z",fill:"#1652f0"}),da=i.createElement("path",{d:"M23.01 35.71l-1.06-1.06-4.91 4.91c-.29.29-.29.77 0 1.06l4.91 4.91 1.06-1.06-3.63-3.63h12.1v-1.5h-12.1zM38.96 31.38l-4.91-4.91-1.06 1.06 3.63 3.63h-12.1v1.5h12.1l-3.63 3.63 1.06 1.06 4.91-4.91c.29-.29.29-.77 0-1.06z",fill:"#fff"}),ba=i.createElement("path",{d:"M63 18a1 1 0 100-2 1 1 0 000 2z",fill:"#bfe9ff"}),pa=i.createElement("path",{d:"M54 0l-1.77 8.23L44 10l8.23 1.77L54 20l1.77-8.23L64 10l-8.23-1.77z",fill:"#ffd066"}),ma=i.createElement("path",{d:"M47 2a1 1 0 100-2 1 1 0 000 2zM63 2a1 1 0 100-2 1 1 0 000 2z",fill:"#bfe9ff"}),ya=i.createElement("path",{d:"M28 60C14.77 60 4 49.23 4 36s10.77-24 24-24 24 10.77 24 24-10.77 24-24 24zm0-47C15.32 13 5 23.32 5 36s10.32 23 23 23 23-10.32 23-23-10.32-23-23-23z",fill:"#fff"});a.p;const ga=["sells_unsupported","buy_ach_notice","buy_ny_notice","buy_trade_disclosure"],fa=(e=[])=>{const t=s.a.Children.toArray(rt()(e));return t.length>0?t:null};function va({tradeWarning:e,onClick:t}){var a,n;return Object(de.useLogEventOnMount)("trade_disclosure",{loggingId:"fb65743b-1486-4562-b745-e4692afc4773",componentType:de.ComponentType.card,display_type:"label"}),Object(l.a)(j.y,{text:e.message,link:{text:null!=(a=null===e||void 0===e||null===(n=e.context)||void 0===n?void 0:n.linkText)?a:"",onClick:t}})}const ja=(e,t)=>Object(d.e)(e).withConfig({displayName:"PreviewStep__styleIcon",componentId:"gf6oqn-0"})(["width:","px;min-width:","px;height:","px;"],t,t,t),Oa=ja((function(e){return i.createElement("svg",sa({fill:"none",height:64,viewBox:"0 0 64 64",width:64},e),ca,ua,da,ba,pa,ma,ya)}),30),Sa=ja((function(e){return i.createElement("svg",Vt({width:100,height:100,viewBox:"0 0 100 100",fill:"none"},e),Ht,qt)}),30),ha=ja((function(e){return i.createElement("svg",Ft({width:24,height:24,viewBox:"0 0 24 24",fill:"none"},e),At,It)}),24),ka=Object(d.e)(ot.a).attrs(()=>({align:"center"})).withConfig({displayName:"PreviewStep__PromoContainer",componentId:"gf6oqn-1"})([""]),Ca=d.e.div.withConfig({displayName:"PreviewStep__PromoAmount",componentId:"gf6oqn-2"})(["color:",";margin-right:8px;"],({theme:e})=>e.color.textAccent),Ta=Object(d.e)(ut.a).withConfig({displayName:"PreviewStep__StrikedFormattedAmount",componentId:"gf6oqn-3"})(["text-decoration:line-through;"]),wa=d.e.div.withConfig({displayName:"PreviewStep__SubscriptionBadgeContainer",componentId:"gf6oqn-4"})(["padding-right:",";display:inline-block;vertical-align:middle;"],it.spacing[1]);var Ba=Object(re.b)(({footer:e,store:t,recurringTransactions:a})=>{var n,r,o;const{tradeStore:c}=t,d=G(),p=ve(),m=W(),{goToStep:y,goBack:g}=Object(P.j)(U.c),{eventContext:f,isSellingAll:v,transferType:O,recurringPeriod:S}=Object(b.a)(U.a),{showErrorToast:h}=Object(mt.a)(),{isCommitting:C,isFetching:T}=c,w=Bt({tradeState:c}),{isInJapan:B,isInSingapore:M,hasMadeAPurchase:F}=Object(yt.a)(),[A,I]=Object(i.useState)(!1),_="apple_pay"===d.type,{experimentalAssets:x}=K(),E="google_pay"===d.type,{submitApplePayBuy:R,isApplePayReady:L}=kt({transfer:c.transferData,paymentMethod:d}),{submitGooglePayBuy:D,isGooglePayReady:N}=(({total:e,paymentMethod:t})=>{const[{paymentRequest:a,googlePayClient:n},l]=Object(i.useState)({}),{getBraintreeClient:r}=Object(Ne.a)("google_pay"),{formatMessage:o}=Object(u.a)(),{showErrorToast:s}=Object(mt.a)(),{country:c}=Object(yt.a)(),d=Object(i.useCallback)((e,t)=>{Bugsnag.notify(e,{metaData:{context:"useGooglePayBuySubmitter."+t}}),s(o(Mt.genericError))},[s,o]);return Object(i.useEffect)(()=>{let a,n;if("google_pay"===(null===t||void 0===t?void 0:t.type)&&e){const{promise:t,cancel:o}=Object(jt.a)(Promise.resolve());return t.then(async()=>{a=await r()}).then(async()=>{n=await vt.a.googlePayment.create({client:a,googlePayVersion:Pt.b.googlePayVersion,googleMerchantId:Pt.b.googleMerchantId})}).then(()=>{if(n)return n.createPaymentDataRequest({transactionInfo:{currencyCode:e.currency,totalPriceStatus:"FINAL",totalPrice:e.amount,totalPriceLabel:"Total",checkoutOption:"COMPLETE_IMMEDIATE_PURCHASE",displayItems:[{label:"Subtotal",type:"SUBTOTAL",price:e.amount}]}})}).then(e=>{if(!e)return;const{billingAddressParameters:t,billingAddressRequired:a,allowCreditCards:r,allowPrepaidCards:o}=Pt.b,i=e.allowedPaymentMethods.find(e=>"CARD"===e.type);i&&(i.parameters.billingAddressRequired=a,i.parameters.billingAddressParameters=t,i.parameters.allowCreditCards=r,i.parameters.allowPrepaidCards=o),e.callbackIntents=["PAYMENT_AUTHORIZATION"],e.merchantInfo.merchantName="Coinbase",e.transactionInfo.countryCode=c.code,l({googlePayClient:n,paymentRequest:e})}).catch(e=>{d(e,"createGooglePayClientAndPaymentRequest")}),()=>{var e,t;o(),null===(e=n)||void 0===e||e.teardown(),null===(t=a)||void 0===t||t.teardown()}}},[]),{isGooglePayReady:!(!n||!a),submitGooglePayBuy:Object(i.useCallback)(async()=>{if(!n||!a)throw new Error("Google Pay Braintree client not initialized");const e=new google.payments.api.PaymentsClient({environment:Pt.b.environment,paymentDataCallbacks:{onPaymentAuthorized:()=>({transactionState:"SUCCESS"})}}),t=await e.loadPaymentData(a);return(await n.parseResponse(t)).nonce},[a,n])}})({total:null===(n=c.transferData)||void 0===n?void 0:n.total,paymentMethod:d}),{requiredContentRef:V,footerRef:H,totalHeight:q}=function(){const e=Object(i.useRef)(null),t=Object(i.useRef)(null),[a,n]=Object(i.useState)(0),[l,r]=Object(i.useState)(0);Object(i.useEffect)(()=>{e.current&&n(e.current.clientHeight),t.current&&r(t.current.clientHeight)},[]);const o=Object(i.useMemo)(()=>a+l+Ut.g,[l,a]);return Object(i.useMemo)(()=>({requiredContentRef:e,footerRef:t,totalHeight:o}),[o])}(),{formatMessage:z}=Object(u.a)(),Q=Object(ne.a)(),Y=ee(),J=Object(k.b)({assetId:null===m||void 0===m?void 0:m.id}),$=Qt(t),Z=Object(i.useCallback)(async()=>{if(Y("tapped_confirm_button"),!c.transferData)return;x.has(m.id)&&"buy"===O.value&&J();const e=()=>{w(O.value)};if("apple_pay"===d.type)R(t=>{c.setApplePayNonce(t),e()});else if("google_pay"===d.type)try{const t=await D();c.setGooglePayNonce(t),e()}catch(t){if("CANCELED"===(null===t||void 0===t?void 0:t.statusCode))return;Bugsnag.notify(t,{metaData:{context:"handleCommitTrade"}}),h($.genericError)}else e()},[Y,c,x,m.id,d.type,J,R,D,w,O.value,$.genericError,h]),X=Object(de.useEventLogger)("trade_disclosure_cta",{action:de.ActionType.click,loggingId:"19f3d9ab-2132-4f4f-b0cc-8ef9e60c173c",componentType:de.ComponentType.button,display_type:"label",cta_type:"primary"}),te=Object(j.K)(),ae=Object(pt.a)("june_2021_web_buy_preview_modal","treatment"),le="buy"===O.value?"tapped_buy_fee_explanation_button":"tapped_sell_fee_explanation_button",re=Object(i.useCallback)(()=>{Y(le)},[Y,le]),oe=Object(i.useCallback)(()=>{re(),te&&y("feesInfo")},[re,te,y]),se=null===c||void 0===c||null===(r=c.transferData)||void 0===r?void 0:r.fee,ce=null===c||void 0===c||null===(o=c.transferData)||void 0===o?void 0:o.defaultFee,ue=M&&"buy"===O.value;function pe(e){return t.tradeStore.userWarnings.find(t=>t.id===e)}Object(i.useEffect)(()=>{Y("viewed_preview")},[]);const me=Object(i.useCallback)(()=>{v.onChange(!1),g()},[g,v]),ye="treatment"===Object(st.useVariant)(bt.a.mar_2020_recurring_buy_fee,{skipTracking:!0})&&"buy"===O.value&&"never"!==S.value,ge=Boolean(!F&&ce&&se&&ce.amount!==se.amount&&0===parseFloat(se.amount)),fe=ge?Object(l.a)(j.u,{icon:Object(l.a)(ha,{}),text:$.feeWaived}):null,je=$.wblNoticeTextNew&&!ge?Object(l.a)(j.u,{icon:Object(l.a)(Oa,{}),text:$.wblNoticeTextNew}):null,Oe=$.instantAchText?Object(l.a)(j.u,{icon:Object(l.a)(Sa,{}),text:$.instantAchText}):null,Se=ye?Object(l.a)(j.t,{text:$.promoDescription,link:{text:$.promoLink,url:j.l,onClick:re}}):null,he=pe("sells_unsupported")?Object(l.a)(j.t,{text:$.sellsUnsupportedText,link:{text:$.sellsUnsupportedLink,url:j.m}}):null,ke=t.tradeStore.userWarnings.filter(e=>!ga.includes(e.id)&&!("rewards_notice"===e.id&&"defiYield"===f.value)).map(e=>Object(l.a)(j.t,{text:e.message})),Ce=pe("buy_ach_notice"),Te=Ce?Object(l.a)(j.y,{text:Ce.message}):null,we=pe("buy_ny_notice"),Be=we?Object(l.a)(j.y,{text:we.message}):null,Pe=pe("buy_trade_disclosure"),Me=(null===Pe||void 0===Pe?void 0:Pe.context)?Object(l.a)(va,{tradeWarning:Pe,onClick:()=>{y("disclosures"),X()}}):null,Fe=Object(l.a)(j.h,{goBack:me,title:$.header}),Ae=Boolean(ce&&se&&se.amount!==ce.amount),Ie=$.actionLabel,_e=Object(l.a)(j.A,{label:$.paymentLabel,rightContent:$.paymentValue,rightIcon:p.icon}),xe=Object(l.a)(j.A,{label:$.priceLabel,rightContent:$.priceValue}),Ee=s.a.createElement(s.a.Fragment,null,Object(l.a)(j.I,{text:$.cryptoAmount}),Object(l.a)(j.F,{size:"enormous"}),_e,$.recurringValue&&Object(l.a)(ct.m,{highlighted:A},void 0,Object(l.a)(j.A,{label:$.recurringLabel,isLastRow:!0,rightContent:s.a.createElement(s.a.Fragment,null,$.recurringValue,Object(l.a)("br",{}),$.recurringValueDetails)})),xe,Object(l.a)(j.A,{label:Ie,rightContent:$.actionValue}),Object(l.a)(j.w,{includesTaxes:ue,hasPromo:Ae,rightContent:(()=>{var e;return se?(null===(e=c.transferData)||void 0===e?void 0:e.appliedSubscriptionBenefit)?s.a.createElement(s.a.Fragment,null,Object(l.a)(wa,{},void 0,Object(l.a)(gt.a,{height:16,type:"badge"})),$.free):ce&&Ae?Object(l.a)(ka,{},void 0,Object(l.a)(Ca,{},void 0,0===parseFloat(se.amount)?$.free:s.a.createElement(ut.a,Object.assign({},se))),s.a.createElement(Ta,Object.assign({},ce))):s.a.createElement(ut.a,Object.assign({},se)):null})(),onClick:oe,feeLink:B?j.k:j.l}),Object(l.a)(j.A,{label:$.totalLabel,rightContent:$.totalValue,isLastRow:!0})),Re=Nt(t,a.length>0),Le=fa([Re?Object(l.a)(Kt,{store:t,messages:$,setHighlightRecurringBuy:I}):null,fe,je,Oe,he,Se,...ke]),De=fa([Te,Me,Be]),Ke=Object(l.a)(j.C,{},void 0,Object(l.a)(j.B,{},void 0,Fe,Object(l.a)(j.i,{},void 0,Ee),Object(l.a)(j.F,{size:"medium"}),Le&&Object(l.a)(j.v,{},void 0,Le,Object(l.a)(ia,{store:t,messages:$}))),Object(l.a)(j.B,{},void 0,Object(l.a)(j.i,{},void 0,Object(l.a)(be.Button,{block:!0,loading:T||C,onPress:Z,disabled:C||T||(null===p||void 0===p?void 0:p.rejected)||_&&!L||E&&!N,testID:O.value+"-confirm-button","data-testid":O.value+"-confirm-button","aria-label":"buy"===O.value?z(Wt.buyButton):z(Wt.sellButton)},void 0,$.button)),e),De&&Object(l.a)(j.z,{},void 0,De)),Ue=Object(l.a)(j.C,{isMobile:Q,isExperiment:!0,totalRequiredHeight:q},void 0,Fe,Object(l.a)(dt.b,{noTopPadding:!0,noHorizontalPadding:!0,noBottomPadding:!0},void 0,Object(l.a)(j.B,{},void 0,s.a.createElement(ie.VStack,{ref:V,key:"requiredContentRef"},Object(l.a)(j.i,{},void 0,Ee)),Object(l.a)(j.F,{size:"medium"}),Le&&Object(l.a)(j.v,{},void 0,Le,Object(l.a)(ia,{store:t,messages:$})))),s.a.createElement(dt.i,{hasFooter:!0,noPaddingHorizontal:!0,ref:H,key:"footerRef"},Object(l.a)(j.i,{},void 0,Object(l.a)(be.Button,{block:!0,loading:T||C,onPress:Z,disabled:C||T||(null===p||void 0===p?void 0:p.rejected)||_&&!L||E&&!N,testID:O.value+"-confirm-button","data-testid":O.value+"-confirm-button"},void 0,$.button)),e,De&&Object(l.a)(j.z,{},void 0,De)));return ae?Ue:Ke}),Pa=a("An2z"),Ma=a("OUjm"),Fa=a("QIsu"),Aa=a("5ezY");function Ia(){return(Ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var _a=i.createElement("path",{d:"M20.429 22.143c6.114 0 11.071-4.957 11.071-11.072C31.5 4.957 26.543 0 20.429 0 14.314 0 9.357 4.957 9.357 11.071c0 6.115 4.957 11.072 11.072 11.072z",fill:"#F5B867"}),xa=i.createElement("path",{d:"M.5 17.714C.5 11.46 5.704 6.421 11.959 6.643c6.034.221 10.684 5.314 10.684 11.348v10.795A6.643 6.643 0 0116 35.429h-3.321a3.321 3.321 0 01-3.322-3.322 3.321 3.321 0 00-3.321-3.321A2.22 2.22 0 013.82 26.57v-2.767a1.66 1.66 0 00-1.66-1.661A1.66 1.66 0 01.5 20.483v-2.769z",fill:"#56B4FC"}),Ea=i.createElement("path",{d:"M11.959 6.643a2.3 2.3 0 00-2.26 1.744c-.22.87-.342 1.777-.342 2.684 0 6.09 4.982 11.072 11.072 11.072 1.305 0 2.214-1.146 2.214-2.452v-1.7c0-6.034-4.65-11.127-10.684-11.348z",fill:"#1652F0"}),Ra=i.createElement("path",{d:"M15.333 12.155c.2-.659 1.133-.659 1.334 0a.697.697 0 00.464.464c.658.2.658 1.133 0 1.334a.697.697 0 00-.464.463c-.2.66-1.133.659-1.334 0a.697.697 0 00-.464-.463c-.658-.201-.658-1.134 0-1.334a.697.697 0 00.464-.464z",fill:"#fff"});a.p;const La=Object(c.c)({recurringBuysPromoText:{id:"RecurrenceSelectStep.PromoBanner.promoText",defaultMessage:"Save on all recurring buys! Get flat 1.49% fees until June 30, 2020."}}),Da=()=>{const{formatMessage:e}=Object(u.a)();return Object(l.a)(Ka,{},void 0,Object(l.a)(Na,{}),Object(l.a)(ot.a,{auto:!0,justify:"center"},void 0,Object(l.a)(Aa.a,{size:"tiny",weight:"demiBold"},void 0,e(La.recurringBuysPromoText))))},Ka=Object(d.e)(ot.a).attrs(()=>({align:"center",justify:"space-between"})).withConfig({displayName:"PromoBanner__PromoContainer",componentId:"sc-1xbu4sb-0"})(["padding:20px 10px 20px 17px;"]),Na=Object(d.e)((function(e){return i.createElement("svg",Ia({width:32,height:36,viewBox:"0 0 32 36",fill:"none"},e),_a,xa,Ea,Ra)})).withConfig({displayName:"PromoBanner__PromoLogo",componentId:"sc-1xbu4sb-1"})(["width:40px;margin-right:15px;"]);var Ua=Object(i.memo)(Da);const Va=Object(c.c)({title:{id:"RecurrenceSelectStep.title",defaultMessage:"Repeat this purchase?"}}),Ha=()=>{const{formatMessage:e}=Object(u.a)(),{goBack:t}=Object(P.j)(U.c),{recurringPeriod:a}=Object(b.a)(U.a),n=Object(i.useCallback)(e=>{a.onChange(e),t()},[t,a]),r="treatment"===Object(st.useVariant)(bt.a.mar_2020_recurring_buy_fee),o=Te();return Object(l.a)(Fa.h,{},void 0,Object(l.a)(Ma.b,{goBack:t,title:e(Va.title)}),Object(l.a)(qa,{},void 0,["never","daily","weekly","first_and_fifteenth","monthly"].map(e=>{const t=e===a.value,r=o(e);return Object(l.a)(Pa.ListCell,{as:"li",selected:t,variant:"foregroundMuted",onPress:()=>n(e),title:r.title,description:r.text},e)}),r&&Object(l.a)(Ua,{})))},qa=Object(d.e)(Fa.b).withConfig({displayName:"RecurrenceSelectStep__StyledInnerStepContent",componentId:"sc-108ypss-0"})(["padding:0 ",";"],e=>e.theme.size.medium);var za=Object(i.memo)(Ha);var Wa=Object(c.c)({title:{id:"RecurringRewardTermsStep.title",defaultMessage:"Terms and conditions"},termsAndConditions:{id:"RecurringRewardTermsStep.termsAndConditions",defaultMessage:"\u2022 To receive this reward, complete the required number of recurring crypto buys. Only one reward per invited customer. Not available for USD Coin buys or if Coinbase finds gaming or fraudulent activity.<br></br><br></br>\n    \u2022 Allow 5 days after your qualifying buy to receive reward, which will be paid in Bitcoin (BTC).<br></br><br></br>\n    \u2022 Coinbase may cancel this offer at anytime prior to you scheduling recurring buys."},understand:{id:"RecurringRewardTermsStep.understand",defaultMessage:"I understand"}});const Qa=({onDone:e,footer:t})=>{const{formatMessage:a}=Object(u.a)();return s.a.createElement(s.a.Fragment,null,Object(l.a)(Ga,{},void 0,Object(l.a)(Ya,{column:!0,auto:!0,align:"center"},void 0,Object(l.a)(_t.a,{level:3,marginBottom:"lg"},void 0,a(Wa.title)),Object(l.a)(oe.a,{color:"light",align:"left"},void 0,a(Wa.termsAndConditions,{br:()=>Object(l.a)("br",{})}))),Object(l.a)(Ja,{column:!0,bottomPadded:!0},void 0,Object(l.a)(se.a,{fullWidth:!0,type:"light",size:"xlarge",onClick:e},void 0,a(Wa.understand)))),t)},Ga=Object(d.e)(ot.a).attrs(()=>({column:!0,auto:!0,justify:"space-between"})).withConfig({displayName:"RecurringRewardTermsStep__PaddedContent",componentId:"nnn9i-0"})(["position:relative;flex:1;flex-shrink:0;padding:","px ","px 0 ","px;"],Ut.d,Ut.d,Ut.d),Ya=Object(d.e)(ot.a).withConfig({displayName:"RecurringRewardTermsStep__TopContent",componentId:"nnn9i-1"})(["text-align:center;"]),Ja=Object(d.e)(ot.a).withConfig({displayName:"RecurringRewardTermsStep__BottomContent",componentId:"nnn9i-2"})(["",";padding-top:","px;"],e=>e.bottomPadded&&`padding-bottom: ${Ut.d}px`,Ut.d);var $a=Object(i.memo)(Qa),Za=a("dViE");function Xa(){const{goBack:e}=Object(P.j)(U.c),{transferType:t}=Object(b.a)(U.a),a=W(),n=function(){const{goToStep:e}=Object(P.j)(U.c),{assetSymbol:t}=Object(b.a)(U.a),a=ee(),n=W();return Object(i.useCallback)(l=>{l.symbol!==n.symbol&&(a("tapped_asset"),t.onChange(l.symbol),a("modal_buy_currency_selected",{action:de.ActionType.click,componentType:de.ComponentType.dropdown,currency:l.symbol,context:"buyPage",loggingId:"9a36771d-3dd9-4b65-9378-efe7e448aed8"})),e("entry")},[t,e,n.symbol,a])}(),{tradableAssets:r}=Object(f.a)(),o=G(),s=Object(pt.a)("july_2021_web_filter_zero_balance","treatment"),c=Object(i.useMemo)(()=>r.map(e=>e.id),[r]);return Object(l.a)(Za.a,{onBack:e,assetIds:c,activeAssetId:a.id,onAssetSelect:n,showBalance:"sell"===t.value,sortByBalance:"sell"===t.value,filterZeroBalance:s&&"sell"===t.value,targetFiatCurrency:o.currency,dataHandlePrefix:t.value})}var en=a("xi+P"),tn=a("4Id/"),an=a("cqL8");var nn=Object(c.c)({addPaymentMethod:{id:"SelectPaymentStep.addPaymentMethod",defaultMessage:"Add a payment method"},blocked:{id:"SelectPaymentStep.blocked",defaultMessage:"Blocked. <link>Add again</link>"},temporarilyDisabled:{id:"SelectPaymentStep.temporarilyDisabled",defaultMessage:"Temporarily disabled"}});function ln(){const{isInUS:e}=Object(yt.a)(),t=Object(an.b)(),a=Object(at.a)(),n=Object(tn.a)(),{goToStep:r}=Object(P.j)(U.c),{transferType:o}=Object(b.a)(U.a),{showModal:s}=Object(x.a)(),{formatMessage:c}=Object(u.a)(),d=Object(i.useMemo)(()=>{const a=t.find(e=>"EUR"===e.currency.code);return"sell"===o.value&&(a||e)},[t,e,o.value]),p=Object(i.useCallback)(()=>{a(),n(),r("entry")},[a,n,r]),m=Object(i.useCallback)(()=>{s(Object(l.a)(en.a,{transferTypes:[o.value+"s"],onSuccess:p,entryPoint:o.value}))},[p,s,o.value]);return d?null:Object(l.a)(dt.i,{},void 0,Object(l.a)(be.Button,{onPress:m,variant:"secondary",startIcon:"add"},void 0,c(nn.addPaymentMethod)))}var rn=a("t9Cp"),on=a("+Ppe");const sn=Object(c.c)({title:{id:"BuyFedwireInstructions.title",defaultMessage:"Wire transfer"},description:{id:"BuyFedwireInstructions.description",defaultMessage:"Wire funds from your bank into Coinbase. Recommended for amounts greater than $25,000."}});function cn({transferType:e}){const{formatMessage:t}=Object(u.a)(),{showModal:a}=Object(x.a)(),n=Object(i.useCallback)(()=>{a(Object(l.a)(on.a,{entryPoint:e}))},[a,e]);return Object(l.a)(Pa.ContentCell,{as:"li",title:t(sn.title),description:t(sn.description),media:Object(l.a)(rn.a,{"aria-hidden":"true"}),onPress:n})}var un=a("zBan");function dn({paymentMethod:e,store:t}){const{activePaymentMethodId:a,transferType:n}=Object(b.a)(U.a),{description:r,onPress:o}=function(e,t){const{showModal:a}=Object(x.a)(),{goToStep:n}=Object(P.j)(U.c),{formatMessage:r}=Object(u.a)(),o=Ve(t),s=Object(at.a)(),c=Object(tn.a)(),d=Object(i.useCallback)(()=>{s(),c(),n("entry")},[s,c,n]);return Object(i.useMemo)(()=>e.rejected?{description:Object(l.a)(Ae.TextBody,{as:"div",color:"negative"},void 0,r(nn.blocked,{link:e=>[e?Object(l.a)(Ae.Link,{variant:"body"},void 0,e):null]})),onPress:()=>a(Object(l.a)(un.a,{type:e.type,reauthCardData:{last4:e.conciseDescription,paymentMethodId:e.id},onSuccess:d}))}:"wbl"===e.disableBuyReason?{description:Object(l.a)(Ae.TextBody,{as:"div",color:"negative"},void 0,r(nn.temporarilyDisabled)),onPress:()=>o(e.id)}:{description:e.description,onPress:()=>o(e.id)},[o,r,d,e.conciseDescription,e.description,e.disableBuyReason,e.id,e.rejected,e.type,a])}(e,t),s=Object(i.useMemo)(()=>{const t=e.type.replace(/_/g,"-");return`${n.value}-select-${t}-${e.currency}`},[e.currency,e.type,n.value]);return Object(l.a)(Pa.ContentCell,{as:"li",title:e.label,meta:e.conciseDescription,description:r,onPress:o,selected:e.id===a.value,media:e.icon,testID:s,"data-testid":s})}const bn=e=>Object(l.a)(dt.a,{fixedHeight:!0},void 0,s.a.createElement(pn,Object.assign({},e))),pn=({title:e,store:t})=>{const{goBack:a}=Object(P.j)(U.c),{transferType:n}=Object(b.a)(U.a),{isInUS:r,adminFlags:o}=Object(yt.a)(),s=!(null===o||void 0===o?void 0:o.includes("disable_push_payment_deposits"))&&r&&"buy"===n.value,{formattedPaymentMethods:c,allowedPaymentMethods:u}=K(),{isSupportedWithActiveCard:d}=Object(A.b)(),{isGooglePaySupportedWithActiveCard:p}=Object(I.a)(u),m=Object(i.useMemo)(()=>c.filter(e=>"apple_pay"===e.type?d:"google_pay"!==e.type||p),[c,d,p]);return Object(l.a)(dt.h,{},void 0,Object(l.a)(Ma.b,{goBack:a,title:e}),Object(l.a)(mn,{},void 0,m.map(e=>Object(l.a)(dn,{store:t,paymentMethod:e},e.id)),s&&Object(l.a)(cn,{transferType:n.value})),Object(l.a)(ln,{}))},mn=Object(d.e)(dt.b).withConfig({displayName:"SelectPaymentStep__StyledInnerStepContent",componentId:"sc-6vb3n4-0"})(["padding:0 ",";"],e=>e.theme.size.medium);var yn=Object(i.memo)(bn),gn=a("oNR1"),fn=a("ic3r"),vn=a("Nq15"),jn=a("oZSt");const On=4,Sn=100,hn=10;function kn({tradeState:e,isDisabled:t}){var a;const[n,l]=Object(i.useState)(),r=e.addError,o=null===(a=e.transferData)||void 0===a?void 0:a.resourcePath,s=Object(jn.a)(),c=Object(i.useRef)(0),u=Object(i.useCallback)(e=>{c.current++,c.current>=On&&l("created"),c.current<Sn&&setTimeout(()=>{s&&e()},(e=>{let t=1e3;return e>hn&&(t=1e3*Math.min(60,Math.pow(2,e-hn))),t})(c.current))},[c,s]),d=Object(i.useCallback)(async e=>{try{const t=await R.b.get(e);if(!s)return;switch(t.data.status){case"completed":return void l("completed");case"failed":case"expired":case"canceled":return void l("canceled");default:u(()=>d(e))}}catch(n){const e=await R.b.get(o);if("canceled"===e.data.status){var t,a;const n=null!=(t=null===(a=e.data.cancelReason)||void 0===a?void 0:a.message)?t:void 0;return l("canceled"),void r(n)}}},[r,u,s,o]),b=Object(i.useCallback)(async()=>{const e=()=>u(b);try{const n=await R.b.get(o);if(!s)return;const{data:i}=n,{status:c,transaction:u}=i;if("completed"===c)return void l("completed");if("canceled"===c){var t,a;const e=null!=(t=null===(a=i.cancelReason)||void 0===a?void 0:a.message)?t:void 0;return l("canceled"),void r(e)}const b=null===u||void 0===u?void 0:u.resourcePath;if(b)return void d(b);e()}catch(n){return void e()}},[r,u,s,o,d]);return Object(i.useEffect)(()=>{t||b()},[]),n}var Cn=a("pLDr");var Tn=a("Jegn"),wn=a("hCv+"),Bn=a("vq8b"),Pn=a("Y0sT"),Mn=a("tSF3"),Fn=a("BOQu");function An({store:e,tradeData:t}){const{goToStep:a}=Object(P.j)(U.c),{recurringPeriod:n}=Object(b.a)(U.a),r=Q(),o=ae(),s=Object(Mn.a)({accountId:null===r||void 0===r?void 0:r.id}),c=Object(i.useMemo)(()=>{var a,n,l,r,o;const i=s.some(e=>{var a;return"buy"===e.type&&(null===(a=e.amount)||void 0===a?void 0:a.currency)===t.sourceCurrency}),c=(null===(a=e.tradeStore.transferData)||void 0===a||null===(n=a.total)||void 0===n?void 0:n.currency)===t.sourceCurrency&&"buy"===(null===(l=e.tradeStore.transferData)||void 0===l?void 0:l.resource)&&(null===(r=e.tradeStore.transferData)||void 0===r||null===(o=r.recurringPayment)||void 0===o?void 0:o.period);return i||c},[s,t.sourceCurrency,e.tradeStore]),u=Object(i.useCallback)(()=>{n.onChange("weekly"),a("entry")},[a,n]);return o&&!c?Object(l.a)(Fn.a,{onAddFunds:u}):null}function In({store:e,tradeData:t}){return Object(l.a)(Pn.a,{name:"CardUpsellBanner",fallback:null,errorFallback:()=>null},void 0,Object(l.a)(An,{store:e,tradeData:t}))}var _n=Object(i.memo)(In);function xn({store:e,tradeData:t,footer:a,closeModal:n,onComplete:r,showStatusHeaderClose:o}){var s,c,u,d,p,m,y,g;const{businessBanking:f}=Object(yt.a)(),v=Object(gn.h)(),O=Object(ne.a)(),S=Object(tn.a)(),{goToStep:h}=Object(P.j)(U.c),k=W(),{eventContext:C,isSellingAll:T,tradeComplete:w,transferType:B}=Object(b.a)(U.a),F=He({store:e}),A=Object(pt.a)("aug_2021_web_pending_order_improvements","treatment"),I=kn({tradeState:e.tradeStore,isDisabled:!A}),_=function({tradeState:e,isDisabled:t}){var a;const[n,l]=Object(i.useState)(),r=e.addError,o=null===(a=e.transferData)||void 0===a?void 0:a.resourcePath,s=o,c=Object(Tt.a)(),u=Object(i.useCallback)(()=>{c({resource:async()=>R.b.get(o),onResponse:e=>{const{status:t}=e.data;switch(t){case"completed":return{type:"Result",result:"completed"};case"canceled":return{type:"Result",result:"canceled"};default:return{type:"ContinuePolling"}}},onComplete:e=>{switch(e.type){case"Success":l(e.result);break;case"MaxRetries":l("created");break;case"Error":r(e.error),l("canceled");break;default:l("canceled")}}})},[c,r,o]);return Object(i.useEffect)(()=>{t||s&&u()},[s]),n}({tradeState:e.tradeStore,isDisabled:A}),x=A||f?I:_,E=function(){const e=Object(at.a)(),t=Object(Cn.a)(),a=Object(tn.a)(),n=Object(M.a)();return Object(i.useCallback)(()=>{e(),t(),a(),n({type:"buys"}),n({type:"sells"})},[e,t,a,n])}(),L="coinbaseCard"===C.value,D="defiYield"===C.value;Object(i.useEffect)(()=>{if(t.cardStatus){const{promise:e,cancel:t}=Object(jt.a)(S());return e.then(()=>h("paymentError")),()=>t()}},[t.cardStatus]);const K=Boolean((null===(s=e.tradeStore.transferData)||void 0===s||null===(c=s.commitNotice)||void 0===c?void 0:c.title)&&(null===(u=e.tradeStore.transferData)||void 0===u||null===(d=u.commitNotice)||void 0===d?void 0:d.description)||(null===(p=e.tradeStore.transferData)||void 0===p||null===(m=p.wblUxData)||void 0===m?void 0:m.title)&&(null===(y=e.tradeStore.transferData)||void 0===y||null===(g=y.wblUxData)||void 0===g?void 0:g.description)),N=Object(i.useCallback)(e=>{w.onChange(!0),"success"===e&&E()},[w,E]),V=Object(de.useEventLogger)("preview_trade_button_click_"+B.value,{action:de.ActionType.click,componentType:de.ComponentType.page,loggingId:"f23eb031-a959-4a01-b29b-d6c51fc481b3"}),H=Object(i.useCallback)(async()=>{F({amount:e.inputValue,onFailure:()=>{e.resetStepper(),h("entry")}})},[F,h,e]),q=Object(i.useCallback)(async()=>{await e.sellAll()},[e]),z=Object(i.useCallback)(()=>{Object(fn.n)(t)&&T.value?(V(),q()):Object(fn.n)(t)?(V(),H()):(e.resetStepper(),h("entry"))},[t,T.value,V,q,H,e,h]),Q=Object(i.useCallback)(()=>{K&&h("wbl")},[K,h]),G=Object(i.useCallback)(()=>{n&&n()},[n]),Y=Object(i.useCallback)(()=>{const t=k.slug;O&&"assetPage"===C.value&&t?v.push(Object(vn.c)(t)):(n&&n(),e.resetStepper({resetPeriod:!0}),h("entry"))},[k.slug,O,C.value,v,n,e,h]),J=Object(de.useEventLogger)("trade_failure_exchange_rate_updated",{action:de.ActionType.render,componentType:de.ComponentType.page,loggingId:"20f944ef-78dd-4837-8faf-037bbc4c7bba"});Object(fn.n)(t)&&J();const $=Object(i.useMemo)(()=>Object.assign({},t,{status:x}),[t,x]),Z=function({status:e,isInCoinbaseCardFlow:t,isInDefiYieldOptInFlow:a,store:n,tradeData:r,closeModal:o}){const s=Object(Tn.a)(),c=W(),u=Object(pt.a)("oct_2021_defi_lend","treatment"),d="completed"===e;return Object(i.useMemo)(()=>{return d?t?Object(l.a)(_n,{store:n,tradeData:r}):u&&!a?Object(l.a)(wn.a,{closeModal:o,assetUuid:c.id}):s?Object(l.a)(Bn.a,{closeModal:o,isSubscribed:Boolean(null===(e=n.tradeStore.transferData)||void 0===e?void 0:e.appliedSubscriptionBenefit),feeWithoutSubscriptionBenefitValue:null===(i=n.tradeStore.transferData)||void 0===i||null===(b=i.feeWithoutSubscriptionBenefit)||void 0===b?void 0:b.amount,feeWithoutSubscriptionBenefitCurrency:null===(p=n.tradeStore.transferData)||void 0===p||null===(m=p.feeWithoutSubscriptionBenefit)||void 0===m?void 0:m.currency}):null:null;var e,i,b,p,m},[d,t,a,n,r,u,o,c.id,s])}({status:x,isInCoinbaseCardFlow:L,isInDefiYieldOptInFlow:D,store:e,tradeData:t,closeModal:n});return Object(l.a)(j.G,{tradeData:$,showWBL:K,onComplete:r,onContinue:Q,onRetry:z,onViewTransaction:G,onClose:Y,onAnimationEnd:N,trackEvent:e.trackEvent,footer:a,isFetching:e.tradeStore.isFetching,banner:Z,showStatusHeaderClose:o})}var En=Object(i.memo)(xn),Rn=a("n+nn"),Ln=a("/Rdd"),Dn=a("9+F0");const Kn=Object(c.c)({sendCtaButton:{id:"WBLStep.sendCta",defaultMessage:"Send now"},ackButton:{id:"WBLStep.ackButton",defaultMessage:"Got it"}}),Nn=Object(d.e)(ot.a).attrs(()=>({auto:!0,center:!0,column:!0})).withConfig({displayName:"WBLStep__Container",componentId:"sc-1fosiz3-0"})(["padding-top:12px;margin-bottom:24px;"]),Un=Object(d.e)(j.i).withConfig({displayName:"WBLStep__AnimationPadding",componentId:"sc-1fosiz3-1"})(["padding-top:45px;margin-bottom:8px;"]),Vn=Object(d.e)(j.i).withConfig({displayName:"WBLStep__TopHorizontalPadding",componentId:"sc-1fosiz3-2"})(["padding-bottom:20px;"]);var Hn=Object(re.b)(({store:e,tradeData:t,footer:a,closeModal:n,onComplete:r})=>{var o,c,d,p,m,y,g,f,v,O,S,h,k;const{formatMessage:C}=Object(u.a)(),T=Object(gn.h)(),w=Object(ne.a)(),{goToStep:B}=Object(P.j)(U.c),{eventContext:M}=Object(b.a)(U.a),F=W(),A=Object(i.useCallback)(()=>{e.resetStepper(),B("entry")},[B,e]),I=Object(i.useCallback)(()=>{n&&n()},[n]),_=Object(i.useCallback)(()=>{const e=F.slug;w&&"assetPage"===M.value&&e?T.push(Object(vn.c)(e)):A()},[F.slug,w,M.value,T,A]),E=Object(i.useMemo)(()=>{const e=Object(fn.l)({tradeData:t,showWBL:!0});switch(e){case"success":case"emailSent":return Object(l.a)(Rn.a,{buttonType:e,tradeData:t,onViewTransaction:I,onClose:_,onComplete:r});default:return null}},[t,I,r,_]),{showModal:R}=Object(x.a)(),L=Object(i.useCallback)(()=>{n&&n(),R(Object(l.a)(Ln.a,{defaultTab:"send",entryPoint:"wbl"}))},[n,R]),D=(null===(o=e.tradeStore.transferData)||void 0===o?void 0:o.includeCta)?Object(l.a)(Vn,{},void 0,Object(l.a)(se.a,{fullWidth:!0,size:"xlarge",onClick:L},void 0,C(Kn.sendCtaButton))):void 0,K=!!(null===(c=e.tradeStore.transferData)||void 0===c||null===(d=c.commitNotice)||void 0===d?void 0:d.title)&&!!(null===(p=e.tradeStore.transferData)||void 0===p||null===(m=p.commitNotice)||void 0===m?void 0:m.description),N=K?Object(l.a)(Dn.a,{image:Object(l.a)(Un,{},void 0,Object(l.a)(fn.h,{animationType:"instantAchSuccess"})),title:(null===(y=e.tradeStore.transferData)||void 0===y||null===(g=y.commitNotice)||void 0===g?void 0:g.title)||"",body:(null===(f=e.tradeStore.transferData)||void 0===f||null===(v=f.commitNotice)||void 0===v?void 0:v.description)||""}):Object(l.a)(Dn.a,{title:(null===(O=e.tradeStore.transferData)||void 0===O||null===(S=O.wblUxData)||void 0===S?void 0:S.title)||"",body:(null===(h=e.tradeStore.transferData)||void 0===h||null===(k=h.wblUxData)||void 0===k?void 0:k.description)||""}),V=K?Object(l.a)(fn.b,{onPress:n},void 0,C(Kn.ackButton)):E;return s.a.createElement(s.a.Fragment,null,Object(l.a)(Nn,{},void 0,Object(l.a)(j.i,{},void 0,N)),D,Object(l.a)(j.i,{},void 0,V),a)}),qn=a("Uih2"),zn=a.n(qn),Wn=a("9/Bj"),Qn=a("j6ZD"),Gn=a.n(Qn),Yn=a("vRDy"),Jn=a("JvuD");function $n({client:e,debounceTime:t,accounts:a,totalHoldBalance:n,totalNativeBalance:r}){var o,s;const c=G(),u=function({client:e,debounceTime:t=180}){const a=Object(i.useRef)(""),n=Object(i.useRef)(""),r=Object(i.useRef)(""),o=Object(i.useRef)(""),s=Object(i.useRef)(""),[c,u]=Object(i.useState)({transferData:void 0,isFetching:!1,committed:!1,submitted:!1,completed:!1,canceled:!1,plaidRelinkSkipped:!1,isCommitting:!1,isSubmitting:!1,fiatSubtotalValue:void 0,fiatTotalValue:void 0,cryptoValue:void 0,inputType:void 0,inputValue:"",serverValidationError:void 0,serverValidationErrorId:void 0,userWarnings:[],braintreeCorrelationId:void 0,additionalErrorInfo:void 0}),{transferType:{value:d},recurringPeriod:p,activePaymentMethodId:m}=Object(b.a)(U.a),y=G(),g=Q(),f=W(),v=Object(M.a)(),{showModal:j}=Object(x.a)(),{transferData:O,committed:S,completed:h,canceled:k,fiatSubtotalValue:C,fiatTotalValue:T,cryptoValue:w,inputType:B,serverValidationError:P}=c,F=f.symbol,A=Object(i.useCallback)((e={})=>{u(t=>Object.assign({},t,{validationError:!1,serverValidationError:void 0,serverValidationErrorId:void 0},e))},[]),I=Object(i.useCallback)((e={})=>{A(Object.assign({transferData:void 0,cryptoValue:void 0,fiatTotalValue:void 0,fiatSubtotalValue:void 0},e))},[A]),_=Object(i.useMemo)(()=>{switch(B){case"amount":return J()(w);case"total":return J()(T);case"subtotal":return J()(C);default:return""}},[B,w,C,T]),E=!(!F||!g),R=Object(i.useCallback)(e=>{var t;Bugsnag.notify("AssetTradeStore error",{metaData:{apiError:e}});const a=null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.errors;var n,r;a&&a[0]&&(X.a.track(d+"_viewed_error",{action:de.ActionType.render,componentType:de.ComponentType.page,currency:F,context:"assetPage",error_type:null===(n=a[0])||void 0===n?void 0:n.id,error:a[0].message,loggingId:"13d5bca2-9ea3-4336-8f85-34d47bc33dc8"}),"personal_details_required"===(null===(r=a[0])||void 0===r?void 0:r.id)?j(Object(l.a)(Yn.a,{})):a[0]&&u(e=>{var t,n,l;return Object.assign({},e,{serverValidationErrorId:null===(t=a[0])||void 0===t?void 0:t.id,serverValidationError:null===(n=a[0])||void 0===n?void 0:n.message,additionalErrorInfo:null===(l=a[0])||void 0===l?void 0:l.additionalInformation})}))},[F,j,d]),L=y.currency,D=Object(i.useCallback)(({transfer:e,type:t})=>{var a;return(null===e||void 0===e||null===(a=e[t])||void 0===a?void 0:a.amount)||"0"},[]),K=Object(i.useCallback)(({inputType:e,amount:t,transferData:a})=>{u(n=>{const{cryptoValue:l,fiatSubtotalValue:r,fiatTotalValue:o}=n;if(n.inputType!==e)return n;switch(e){case"amount":if(l===t){if("buy"===d){const e=D({transfer:a,type:"total"});return Object.assign({},n,{fiatTotalValue:e})}{const e=D({transfer:a,type:"subtotal"});return Object.assign({},n,{fiatSubtotalValue:e})}}return n;case"total":if(o===t){const e=D({transfer:a,type:"amount"});return Object.assign({},n,{cryptoValue:e})}return n;case"subtotal":if(r===t){const e=D({transfer:a,type:"amount"});return Object.assign({},n,{cryptoValue:e})}return n;default:return n}})},[D,d]),N=Object(i.useCallback)((e,t,a)=>{const l={quote:!1,commit:e};l.payment_method=m.value,"total"===a?(l.total=(t||0).toString(),l.currency=L):"amount"===a?(l.amount=(t||0).toString(),l.currency=F):"subtotal"===a&&(l.amount=(t||0).toString(),l.currency=L),"never"!==p.value&&(l.recurring_period=p.value);const i=y.type;return e||"buy"!==d||("paypal_account"===i&&(l.paypal_correlation_id=r.current),"apple_pay"!==i&&"google_pay"!==i||(l.braintree_correlation_id=r.current)),e&&(n.current&&(l.threatmetrix_session_id=n.current),o.current&&(l.apple_pay_nonce=o.current),s.current&&(l.braintree_pm_nonce=s.current)),"google_pay"===i&&(l.pmsvc_id=y.pmsvcId),l},[m.value,p.value,y.type,d,L,F,y.pmsvcId]),V=Object(i.useCallback)(async({amount:t,submit:l,inputType:r,paramsOverride:o})=>{if(!E)return;if(!n.current){X.a.track("threatmetrix_profiling_started",{action:de.ActionType.render,componentType:de.ComponentType.page,loggingId:"849e2797-f017-48ca-bae5-23358a46338d",entry:"createTransfer"});const e=Object(Jn.a)();e&&(n.current=e,X.a.track("threatmetrix_profiling_finished",{action:de.ActionType.render,componentType:de.ComponentType.page,loggingId:"bbef422b-7bab-4c79-ba17-591f66137ce4",entry:"createTransfer",sessionId:e}))}u(e=>Object.assign({},e,{isFetching:!0,isSubmitting:!0}));const i=N(!1,t,r),s=Object.assign({},i,o);a.current=JSON.stringify(s);const c=`/v2/accounts/${g.id}/${d}s`;let b;try{b=await e.post(c,s)}catch(m){u(e=>Object.assign({},e,{transferData:void 0})),R(m)}if(u(e=>Object.assign({},e,{isFetching:!1,isSubmitting:!1})),b){var p;if(q()(b.data,"we expect res.data to be defined at this point"),!l&&a.current!==JSON.stringify(s))return;const e={transferData:b.data,userWarnings:b.userWarnings||[]};return l&&(e.submitted=!0,e.plaidRelinkSkipped=!1),A(e),K({inputType:r,amount:t,transferData:b.data}),null===(p=b)||void 0===p?void 0:p.data}},[g,R,E,A,e,N,d,K]),H=Object(i.useCallback)(e=>{Gn()(e)?(u(e=>Object.assign({},e,{inputType:"total"})),V({amount:e,submit:!1,inputType:"total"})):u(e=>Object.assign({},e,{inputType:"total",transferData:void 0}))},[V]),z=Object(Wn.a)(H,t),Y=null===O||void 0===O?void 0:O.subtotal,$=null===O||void 0===O?void 0:O.fee,Z=null===O||void 0===O?void 0:O.total,ee=!!P,te=Boolean("worldpay_card"===y.type&&"sell"!==d&&S&&!h&&!k),ae="buy"===d?L:F,ne="buy"===d?F:L,le=Object(i.useCallback)(e=>{r.current=e},[]),re=Object(i.useCallback)(e=>{o.current=e},[]),oe=Object(i.useCallback)(e=>{s.current=e},[]),ie=Object(i.useCallback)(e=>{u(t=>Object.assign({},t,{cryptoValue:void 0,fiatSubtotalValue:void 0,fiatTotalValue:e})),z(e)},[z]),se=Object(i.useCallback)(({resetPeriod:e=!1}={})=>{const t={transferData:void 0,committed:!1,submitted:!1,completed:!1,canceled:!1,isCommitting:!1,cryptoValue:void 0,fiatTotalValue:void 0,fiatSubtotalValue:void 0,braintreeCorrelationId:void 0};o.current="",s.current="",e&&p.onChange("never"),A(t),v({type:d+"s"})},[A,v,d,p]),ce=Object(i.useCallback)(async()=>{u(e=>Object.assign({},e,{isCommitting:!0}));const t=N(!0,_,B);q()(O&&O.id,"transferData must be defined in commitTransfer");const a=`/v2/accounts/${g.id}/${d}s/${O.id}/commit`;let n;try{n=await e.post(a,t)}catch(l){u(e=>Object.assign({},e,{transferData:void 0})),R(l),Bugsnag.notify("TradeStore failed commit transfer",{metaData:{apiError:l}})}n&&(q()(n.data,"we expect res to still be defined when Commit transfer runs in commitTransfer"),A({transferData:n.data,submitted:!1,committed:!0})),u(e=>Object.assign({},e,{isFetching:!1,isCommitting:!1}))},[g,R,A,e,N,B,O,d,_]),ue=Object(i.useCallback)(e=>{u(t=>Object.assign({},t,{serverValidationError:e}))},[]),be=Object(i.useCallback)(e=>{u(t=>Object.assign({},t,{isFetching:e}))},[]),pe=Object(i.useCallback)(e=>{u(t=>Object.assign({},t,{isCommitting:e}))},[]),me=Object(i.useCallback)(e=>{u(t=>Object.assign({},t,{transferData:e}))},[]),ye=Object(i.useCallback)(e=>{u(t=>Object.assign({},t,e))},[]);return Object.assign({},c,{braintreeCorrelationId:r.current,setTradeState:ye,handleDebouncedTotalInput:z,subtotal:Y,fee:$,total:Z,activeFiatCurrency:L,showAuthorizing:te,allowCreateTransfer:E,sourceCurrency:ae,targetCurrency:ne,setBraintreeCorrelationId:le,setApplePayNonce:re,setGooglePayNonce:oe,changeFiatTotalValue:ie,resetTransferState:se,resetInputState:I,addError:R,clearErrors:A,getConvertedAmountsFromTransfer:D,updateInputs:K,createTransfer:V,commitTransfer:ce,client:e,showError:ee,params:N,inputValue:_,setServerValidationError:ue,setIsFetching:be,setIsCommitting:pe,setTransferData:me,activeCurrency:f.symbol})}({client:e,debounceTime:t}),d=Q(),{isFiatInput:p,isSellingAll:m,tradeComplete:y,transferType:{value:g}}=Object(b.a)(U.a),f=W(),v=ee(),{assetBalance:j}=Z(),{goToStep:O}=Object(P.j)(U.c),{setTradeState:S}=u,h=Object($.a)(),k=Object(_.a)({accounts:a,totalHoldBalance:n,totalNativeBalance:r}),C=Object(Wn.a)(u.createTransfer),T=Object(i.useCallback)((e,t)=>{S({isFetching:!0}),C({amount:t,inputType:e,submit:!1})},[S,C]),w=c.currency,B=Object(i.useMemo)(()=>p.value?"buy"===g?"total":"subtotal":"amount",[p.value,g]),F=Object(i.useMemo)(()=>{switch(B){case"amount":return J()(u.cryptoValue);case"total":return J()(u.fiatTotalValue);case"subtotal":return J()(u.fiatSubtotalValue);default:return""}},[B,u.cryptoValue,u.fiatSubtotalValue,u.fiatTotalValue]),A=(null===(o=a.filter(e=>e.currency.code===f.symbol)[0])||void 0===o||null===(s=o.currency)||void 0===s?void 0:s.name)||f.symbol,I=Object(i.useCallback)(({resetPeriod:e=!1}={})=>{m.onChange(!1),y.onChange(!1),u.resetTransferState({resetPeriod:e})},[m,y,u]),E=Object(i.useCallback)(e=>{switch(B){case"amount":S({inputType:"amount",cryptoValue:e});break;case"total":S({inputType:"total",fiatTotalValue:e});break;case"subtotal":S({inputType:"subtotal",fiatSubtotalValue:e})}},[S,B]),R=Object(i.useCallback)((e,t=!0)=>{F!==e&&(""!==e?(E(e),u.clearErrors(),t&&(T(B,e),v("viewed_updated_amount"))):u.resetInputState())},[T,u,B,F,v,E]),L=Object(i.useCallback)(e=>{S({transferData:e,isFetching:!1})},[S]),D=Object(i.useCallback)(e=>{u.addError(e),S({isFetching:!1})},[u,S]),K=Object(i.useCallback)(async t=>{const a=`/v2/accounts/${(null===d||void 0===d?void 0:d.id)||""}/${g}s`;try{S({isFetching:!0});const n=await e.post(a,Object.assign({commit:!1,quote:!1,recurring_period:"never",payment_method:c.id,pmsvc_id:c.pmsvcId},t));return L(null===n||void 0===n?void 0:n.data),null===n||void 0===n?void 0:n.data}catch(n){D(n)}},[e,L,c,D,d,S,g]),N=Object(i.useCallback)(async()=>{var e;v("tapped_sell_all"),u.resetInputState();const t=k({paymentMethod:c,transferType:g});let a;if(t){var n;const e=h({currency:d.currency.code,amount:d.balance.amount},w),l=null===(n=zn()(rt()([t,e])))||void 0===n?void 0:n.toString();a=await K({amount:l,currency:w})}else a=await K(Object.assign({},j));m.onChange(!0),(null===(e=a)||void 0===e?void 0:e.id)?O("preview"):(I(),O("entry"))},[v,u,g,d,m,K,j,w,O,I,c,k,h]);return{fiatCode:w,inputType:B,inputValue:F,assetName:A,sellAll:N,setInputAmount:R,resetStepper:I,client:e,debouncedCreateTransfer:C,createTransferFromInput:T,updateTradeStoreInputs:E,createTransfer:K,onTransferComplete:L,onTransferFail:D,tradeStore:u}}var Zn=a("f8zI"),Xn=a.n(Zn),el=a("As4l"),tl=a.n(el);const al=Object(c.c)({header:{id:"AddPaymentPolicyRestriction.header",defaultMessage:"You're almost ready to buy. Please complete your account."},body:{id:"AddPaymentPolicyRestriction.body",defaultMessage:"To make an investment, please add a payment method."},addPaymentMethod:{id:"AddPaymentPolicyRestriction.addPaymentMethod",defaultMessage:"Add a Payment Method"}}),nl=({isVisible:e=!0,entryButton:t=null,hideFooter:a=!1,closeModal:n,onComplete:r,openRecurrence:o,recurringPeriod:s,initialInputAmount:c,showStatusHeaderClose:d=!0,accounts:g,recurringTransactions:f,totalHoldBalance:v,rewards:h})=>{var C,T,M,_,L,D;const N=Object(u.a)(),{showModal:V}=Object(x.a)(),H=Object(m.a)(),{currentStep:q,goToStep:z,goBack:Y,replaceStep:J}=Object(P.j)(U.c),{recurringPeriod:$,tradeComplete:X,transferType:te}=Object(b.a)(U.a),re=ae(),oe=G(),ie=Object(E.a)({accounts:g}),{allowedPaymentMethods:se}=K(),ce=$n({client:R.b,debounceTime:500,accounts:g,totalHoldBalance:v,totalNativeBalance:ie});Object(I.a)(se);const de=ee(),be=W(),pe=Object(B.a)({rewards:h,assetUuid:be.id}),me=Object(i.useCallback)(()=>{z("entry")},[z]);Object(i.useEffect)(()=>{const{tradeStore:{resetTransferState:e}}=ce;e()},[]),Object(i.useEffect)(()=>{o&&re&&$.onChange(null!=s?s:"monthly")},[]),Object(i.useEffect)(()=>{c&&ce.setInputAmount(c)},[]),Object(i.useEffect)(()=>{e&&de("viewed")},[e]);const ye=Object(i.useCallback)(()=>{const{resetStepper:e}=ce;("status"!==q||X.value)&&("status"===q&&X.value&&e({resetPeriod:!0}),z("entry"),de("tapped_close"))},[q,z,ce,de,X.value]),ge=Object(F.a)(be.symbol),{assetBalance:fe,assetBalanceInFiat:ve}=Z(),je=Q(),Oe=function(){const{currentStep:e}=Object(P.j)(U.c),t=Object(le.j)(),a=Object(ne.a)();return Object(i.useMemo)(()=>"entry"!==e&&!t&&!a,[e,a,t])}(),Se=Object(l.a)(j.g,{label:ge?Object(l.a)(S.a,{assetSymbol:be.symbol,onBalanceClick:()=>V(Object(l.a)(y.a,{hidePendingHolds:!0,assetSymbol:be.symbol}))}):void 0,balance:fe,fiatBalance:ve,hideFooter:a}),he=Object(i.useCallback)(()=>{J("preview")},[J]),ke={type:te.value,apiErrorId:ce.tradeStore.serverValidationErrorId,apiError:ce.tradeStore.serverValidationError,cardStatus:null===(C=ce.tradeStore.transferData)||void 0===C?void 0:C.cardStatus,sourceAmount:H({amount:null===(T=ce.tradeStore.transferData)||void 0===T?void 0:T.amount,isFiat:!1}),sourceCurrency:ce.tradeStore.sourceCurrency,targetCurrency:ce.tradeStore.targetCurrency,status:null===(M=ce.tradeStore.transferData)||void 0===M?void 0:M.status,accountId:null===je||void 0===je?void 0:je.id,fiatAccountId:null===(_=oe.fiatAccount)||void 0===_?void 0:_.id,showAuthorizing:ce.tradeStore.showAuthorizing,isCommitting:ce.tradeStore.isCommitting};return Object(l.a)(A.a,{paymentMethods:se},void 0,Object(l.a)(p.a,{show:Oe,onClick:ye}),Object(l.a)(ol,{showOverlay:Oe},void 0,Object(l.a)(U.c.Steps,{},void 0,Object(l.a)(j.H,{},"entry",Object(l.a)(Ye,{store:ce,footer:Se,entryButton:t,closeModal:n})),Object(l.a)(j.H,{},"principalInsolvency",Object(l.a)(w.a,{assetRewardPrincipalInsolvency:pe,handleGoBack:me})),Object(l.a)(j.H,{},"recurringSelect",Object(l.a)(za,{})),Object(l.a)(j.H,{},"paymentError",Object(l.a)(nt,{tradeData:ke})),Object(l.a)(j.H,{},"preview",Object(l.a)(Ba,{store:ce,footer:Se,recurringTransactions:f})),Object(l.a)(j.H,{},"disclosures",Object(l.a)(ue,{store:ce})),Object(l.a)(j.H,{},"selectPayment",Object(l.a)(yn,{title:Be(ce,N,te.value).selectPaymentLabel,store:ce})),Object(l.a)(j.H,{},"selectAsset",Object(l.a)(Xa,{})),Object(l.a)(j.H,{},"status",Object(l.a)(En,{store:ce,tradeData:ke,footer:Se,closeModal:n,onComplete:r,showStatusHeaderClose:d})),Object(l.a)(j.H,{},"wbl",Object(l.a)(Hn,{store:ce,tradeData:ke,footer:Se,closeModal:n,onComplete:r})),Object(l.a)(j.H,{},"experimentalAssetConfirmation",Object(l.a)(k.a,{onBack:Y,assetId:null===be||void 0===be?void 0:be.id,onContinue:he})),Object(l.a)(j.H,{},"additionalInfo",Object(l.a)(O.a,{onBack:Y,footer:Se,additionalInfo:ce.tradeStore.additionalErrorInfo})),Object(l.a)(j.H,{},"recurringRewardTerms",Object(l.a)($a,{onDone:Y,footer:Se})),Object(l.a)(j.H,{},"feesInfo",Object(l.a)(et,{recurringPeriod:null===(L=ce.tradeStore.transferData)||void 0===L||null===(D=L.recurringPayment)||void 0===D?void 0:D.period,tradeType:te.value})))))};function ll(e){var t;let{eventContext:a,transferType:r="buy",assetCode:c="BTC"}=e,d=Object(n.a)(e,["eventContext","transferType","assetCode"]);const{accounts:b,tradableAssets:p,paymentMethods:m,recurringTransactions:y,totalHoldBalance:j,experimentalAssets:O,rewards:S}=Object(f.a)(),h=Object(i.useMemo)(()=>function(e,t){const a=e.filter(e=>e["allow"+Xn()(t)]&&e.verified);return tl()(a,e=>Object.keys(e.limits).includes(t)?-Gn()(e.limits[t][0].remaining.amount):0)}(m,r),[m,r]),k=Object(E.a)({accounts:b}),T=function({paymentMethods:e,accounts:t,totalHoldBalance:a,totalNativeBalance:n,transferType:l}){const r=Object(u.a)(),o=Object(_.a)({accounts:t,totalHoldBalance:a,totalNativeBalance:n});return Object(i.useMemo)(()=>e.map(e=>Object(te.a)({accounts:t,intl:r,transferType:l,limit:o({paymentMethod:e,transferType:l}),paymentMethod:e})),[e,t,r,l,o])}({paymentMethods:h,accounts:b,totalHoldBalance:j,totalNativeBalance:k,transferType:r}),w=Object(_.a)({accounts:b,totalHoldBalance:j,totalNativeBalance:k}),B=Object(i.useMemo)(()=>Object(V.a)({tradableAssets:p,assetSymbol:c}),[c,p]),P=null!=(t=h.find(e=>"buy"===r?e.primaryBuy:e.primarySell))?t:h[0],F=P?w({paymentMethod:P,transferType:r}):0,A=Object(v.a)(null!=F?F:0),I=Object(i.useMemo)(()=>Object.assign({},U.b,{eventContext:a,transferType:r,assetSymbol:B?c:"BTC",activePaymentMethodId:null===P||void 0===P?void 0:P.id,showPresetAmountsIfAvailable:"buy"===r&&!!A}),[a,r,B,c,null===P||void 0===P?void 0:P.id,A]),{formatMessage:x}=Object(u.a)(),{renderTabs:R}=Object(i.useContext)(C.b),L=Object(M.a)();if(!P){const e={id:"payment_method_required",message:x(al.header),description:x(al.body),restrictionUrl:{link:"/settings/linked-accounts",text:x(al.addPaymentMethod)},action:"buys",error:void 0,userType:void 0,pendingPaymentMethod:void 0,pending:!1,pk:()=>""},t=r+"s";return s.a.createElement(s.a.Fragment,null,R&&R(),Object(l.a)(g.a,{isWidget:!0,transferType:t,policyRestriction:e,title:e.message,description:e.description,onSuccess:()=>L({type:t})}))}return Object(l.a)(N,{accounts:b,tradableAssets:p,experimentalAssets:O,allowedPaymentMethods:h,formattedPaymentMethods:T},void 0,Object(l.a)(U.a.Provider,{onSubmit:o.a,initialValues:I},void 0,Object(l.a)(U.c.Provider,{},void 0,s.a.createElement(nl,Object.assign({},d,{accounts:b,tradableAssets:p,paymentMethods:m,recurringTransactions:y,totalHoldBalance:j,rewards:S})))))}function rl(e){return Object(l.a)(h.a,{},void 0,Object(l.a)(T.a,{action:e.transferType+"s"},void 0,s.a.createElement(ll,Object.assign({},e))))}const ol=d.e.div.withConfig({displayName:"BuySellStepper__Container",componentId:"sc-15didqg-0"})(["display:flex;flex:1;z-index:",";transition:z-index ",";"],e=>e.showOverlay?e.theme.zIndex.overlay:e.theme.zIndex.normal,e=>e.showOverlay?"0ms":"0ms ease-out 1000ms");var il=Object(i.memo)(rl);t.a=il},Cejn:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("mXGw"),l=a("xNHB"),r=a("O8JI"),o=a("+U6f");function i({assetId:e,assetCode:t,holdableAssets:a}){var i;const s=Object(r.J)(),c=((null===(i=Object(l.a)(o.a.indexShape(),{id:e}))||void 0===i?void 0:i.symbol)||t||s||"BTC").toUpperCase();return Object(n.useMemo)(()=>a.find(e=>e.symbol.toLowerCase()===c.toLowerCase())||a.find(e=>e.symbol.toLowerCase()==="BTC".toLowerCase()),[a,c])}},DAgE:function(e,t,a){"use strict";a.r(t);const n=function(){var e={defaultValue:null,kind:"LocalArgument",name:"accountId"},t={defaultValue:null,kind:"LocalArgument",name:"transferId"},a=[{kind:"Variable",name:"uuid",variableName:"accountId"}],n=[{kind:"Variable",name:"uuid",variableName:"transferId"}],l={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"useSellStatusQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"Account",kind:"LinkedField",name:"accountByUuid",plural:!1,selections:[{alias:null,args:n,concreteType:"TransferSell",kind:"LinkedField",name:"sellByUuid",plural:!1,selections:[l,{alias:null,args:null,concreteType:"AccountHistoryEntry",kind:"LinkedField",name:"accountHistory",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"useSellStatusQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"Account",kind:"LinkedField",name:"accountByUuid",plural:!1,selections:[{alias:null,args:n,concreteType:"TransferSell",kind:"LinkedField",name:"sellByUuid",plural:!1,selections:[l,{alias:null,args:null,concreteType:"AccountHistoryEntry",kind:"LinkedField",name:"accountHistory",plural:!1,selections:[l,r],storageKey:null},r],storageKey:null},r],storageKey:null},r],storageKey:null}]},params:{id:"a383eabdcbc7ed4bad9577d6336fe6da23a09ea06380c4cb504755c081d44da2",metadata:{},name:"useSellStatusQuery",operationKind:"query",text:null}}}();n.hash="88f4d839909b555f3045c84ce3f99adb",t.default=n},FyJg:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n,l=a("/PpR"),r=a("cqL8"),o=a("NRCK"),i=a("HWI8"),s=a("S8AC"),c=a("vF80"),u=a("FGnu"),d=a("tSF3"),b=a("FjqB"),p=a("JSRU"),m=a("WkzM"),y=a("3w8C"),g=a("oN8/");var f=void 0!==n?n:n=a("8/nl");function v({skip:e}){const{viewer:t}=Object(g.useLazyLoadQuery)(f,{skip:e});return t}function j(e){const{withRelay:t=!1}=e||{},a=Object(y.a)(),[n,g,f,j,O,S,h,k,C,T,w]=Object(l.a)(e=>e(r.b)(),e=>e(m.a)({withRelay:t}),e=>e(s.a)({hasEZExperiment:a}),e=>e(u.b)(),e=>e(d.a)({isRequired:!1,withRelay:!0}),e=>e(o.c)({isRequired:!1}),e=>e(c.a)(),e=>e(i.a)(),e=>e(b.a)({isRequired:!1}),e=>e(p.a)({isRequired:!1,withRelay:!0}),e=>e(v)({skip:!t}));return{accounts:n,tradableAssets:g,experimentalAssets:f,paymentMethods:j,recurringTransactions:O,totalHoldBalance:S,holdableAssets:h,convertibleAssets:k,rewards:C,subscriptionStatus:T,buySellStepperQueryData:w}}},IBLe:function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},l],o={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:r,storageKey:null},i={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"subtotal",plural:!1,selections:r,storageKey:null},s={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"total",plural:!1,selections:r,storageKey:null},c={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"fee",plural:!1,selections:r,storageKey:null},u={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"defaultFee",plural:!1,selections:r,storageKey:null},d={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"feeWithoutSubscriptionBenefit",plural:!1,selections:r,storageKey:null},b={alias:null,args:null,concreteType:"UnitPrice",kind:"LinkedField",name:"unitPrice",plural:!1,selections:[o],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"resource",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"rejected",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},v={alias:null,args:null,concreteType:"Link",kind:"LinkedField",name:"link",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},j={alias:null,args:null,concreteType:"TransferUserWarningContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"details",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"linkText",storageKey:null}],storageKey:null},O={kind:"InlineFragment",selections:[f],type:"GenericError",abstractKey:null},S={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useRefreshSellQuoteMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{kind:"InlineDataFragmentSpread",name:"createSellFragment",selections:[{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[n,o,i,s,c,u,d,b,p,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[m,l,y],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[g,f,v,j],storageKey:null}]}],type:"CreateSellSuccess",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"error",plural:!1,selections:[O],storageKey:null}],type:"CreateSellPartialError",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useRefreshSellQuoteMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[n,o,i,s,c,u,d,b,p,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[m,l,y,S],storageKey:null},S],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[g,f,v,j,S],storageKey:null}],type:"CreateSellSuccess",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"error",plural:!1,selections:[a,O],storageKey:null}],type:"CreateSellPartialError",abstractKey:null}],storageKey:null}]},params:{id:"bf7fe2e9ca5c460d00010fc22d2a8b9be17c500f04996f98860e5eb1ba974100",metadata:{},name:"useRefreshSellQuoteMutation",operationKind:"mutation",text:null}}}();n.hash="404bfe92aa3ebbb91875f3afdae663ec",t.default=n},JdeL:function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},r={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null}],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"GenericError",kind:"LinkedField",name:"error",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},o],storageKey:null}],type:"CommitSellPartialError",abstractKey:null},s={kind:"InlineFragment",selections:[o],type:"GenericError",abstractKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useSellCommitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"commitSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[l,r],storageKey:null}],type:"CommitSellSuccess",abstractKey:null},i,s],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useSellCommitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"commitSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"CommitSellSuccess",abstractKey:null},i,s],storageKey:null}]},params:{id:"a915f7e57859eb4e2986c6f12cf8fe568b4a93b3cc05c7acdbc1ee2f928ea96d",metadata:{},name:"useSellCommitterMutation",operationKind:"mutation",text:null}}}();n.hash="eb9185dbd33bdb234056fdec710a651b",t.default=n},NLgM:function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"resource",storageKey:null},r={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null}],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"recurringPayment",storageKey:null},i=[{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],s={alias:null,args:null,concreteType:"CommitNoticeData",kind:"LinkedField",name:"commitNotice",plural:!1,selections:i,storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"cardStatus",storageKey:null},u={alias:null,args:null,concreteType:"TransferWblUxData",kind:"LinkedField",name:"wblUxData",plural:!1,selections:i,storageKey:null},d={alias:null,args:null,concreteType:"TransferNextStep",kind:"LinkedField",name:"nextStep",plural:!1,selections:[{alias:"action",args:null,kind:"ScalarField",name:"Action",storageKey:null},{alias:"maxPollAttempts",args:null,kind:"ScalarField",name:"MaxPollAttempts",storageKey:null},{alias:"pollIntervalMs",args:null,kind:"ScalarField",name:"PollIntervalInMs",storageKey:null}],storageKey:null},b={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"GenericError",abstractKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"use3dsBuyCompleterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"completeSecure3DBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"commitBuyFragment",selections:[n,l,r,o,s,c,u,d]}],storageKey:null}],type:"CompleteSecure3DBuySuccess",abstractKey:null},b],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"use3dsBuyCompleterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"completeSecure3DBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[n,l,r,o,s,c,u,d,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"CompleteSecure3DBuySuccess",abstractKey:null},b],storageKey:null}]},params:{id:"fc22cf935041f2a66bf72d583d39ff97b7978052a76166d2c8e38955c3f27978",metadata:{},name:"use3dsBuyCompleterMutation",operationKind:"mutation",text:null}}}();n.hash="80eabc320af9f4e9b1854a75a4cad668",t.default=n},VNxb:function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"accountId"},{defaultValue:null,kind:"LocalArgument",name:"transferId"}],t=[{kind:"Variable",name:"uuid",variableName:"accountId"}],a=[{kind:"Variable",name:"uuid",variableName:"transferId"}],n={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"requiresCompletionStep",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"cardStatus",storageKey:null},o={alias:null,args:null,concreteType:"Secure3DVerificationData",kind:"LinkedField",name:"secure3DVerification",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,concreteType:"Secure3DVerificationDataPayload",kind:"LinkedField",name:"payload",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"usePollFor3dsDetailsQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:t,concreteType:"Account",kind:"LinkedField",name:"accountByUuid",plural:!1,selections:[{alias:null,args:a,concreteType:"TransferBuy",kind:"LinkedField",name:"buyByUuid",plural:!1,selections:[n,l,r,o],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"usePollFor3dsDetailsQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:t,concreteType:"Account",kind:"LinkedField",name:"accountByUuid",plural:!1,selections:[{alias:null,args:a,concreteType:"TransferBuy",kind:"LinkedField",name:"buyByUuid",plural:!1,selections:[n,l,r,o,i],storageKey:null},i],storageKey:null},i],storageKey:null}]},params:{id:"6d2e681a8af080683c010edcabc70214997b800823068353ed8ce1b2d67d1454",metadata:{},name:"usePollFor3dsDetailsQuery",operationKind:"query",text:null}}}();n.hash="ad1170aecad639bafcb8094b24efed5c",t.default=n},Zm4r:function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],l={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:n,storageKey:null},r={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"subtotal",plural:!1,selections:n,storageKey:null},o={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"total",plural:!1,selections:n,storageKey:null},i={alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[l,r,o],storageKey:null},s={alias:null,args:null,concreteType:"GenericError",kind:"LinkedField",name:"error",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],storageKey:null},c={alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[l,r,o,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useBuyQuoterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[i],type:"CreateBuySuccess",abstractKey:null},{kind:"InlineFragment",selections:[i,s],type:"CreateBuyPartialError",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useBuyQuoterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[c],type:"CreateBuySuccess",abstractKey:null},{kind:"InlineFragment",selections:[c,s],type:"CreateBuyPartialError",abstractKey:null}],storageKey:null}]},params:{id:"ee1fd8f365aa969271802413cd7a97d9c091508e39ec99021b1e77f6fa82f119",metadata:{},name:"useBuyQuoterMutation",operationKind:"mutation",text:null}}}();n.hash="a29f4acf13a6b855f7584ec99509237d",t.default=n},bdjm:function(e,t,a){"use strict";function n({assetSymbol:e,tradableAssets:t}){return t.some(t=>t.symbol.toUpperCase()===e.toUpperCase())}a.d(t,"a",(function(){return n}))},"hCv+":function(e,t,a){"use strict";var n=a("5n0U"),l=a("mXGw"),r=a("tPLw"),o=a("FQEq"),i=a("i7H4"),s=a("Y0sT"),c=a("7mc1");function u({assetUuid:e,closeModal:t}){return Object(n.a)(s.a,{fallback:null,errorFallback:()=>null,name:"DefiLendPromotionBanner"},void 0,Object(n.a)(d,{closeModal:t,assetUuid:e}))}function d({assetUuid:e,closeModal:t}){const{assetCta:a,shouldShowPromo:s,goToDeepLink:u}=Object(c.a)({assetUuid:e}),d=Object(l.useCallback)(()=>{t&&t(),u()},[t,u]);return s&&(null===a||void 0===a?void 0:a.cta)?Object(n.a)(o.Card,{spacing:1,spacingStart:2,onPress:d},void 0,Object(n.a)(o.HStack,{},void 0,Object(n.a)(o.VStack,{justifyContent:"center"},void 0,Object(n.a)(i.TextBody,{as:"p",color:"foregroundMuted"},void 0,a.title),Object(n.a)(o.Spacer,{vertical:.5}),Object(n.a)(i.TextHeadline,{as:"h4",color:"primary"},void 0,a.text)),Object(n.a)(r.SpotSquare,{name:"defiEarnAnnouncement",scaleMultiplier:.75}))):null}t.a=Object(l.memo)(u)},p8ry:function(e,t,a){"use strict";a.r(t),a.d(t,"BuySell",(function(){return Nl})),a.d(t,"BuySellContent",(function(){return Kl}));var n=a("5n0U"),l=a("mXGw"),r=a.n(l),o=a("hWgQ"),i=a("gN02"),s=a("TDwA"),c=a("djRk"),u=a("qSbN"),d=a("hPOx"),b=a("bEtP"),p=a("Y9+S"),m=a("zjnm"),y=a("XV9Y"),g=a("4gc5"),f=a("+I+c"),v=a("7IP4"),j=a.n(v),O=a("UutA"),S=a("O0l7"),h=a("h0AC"),k=a("MH3X"),C=a("FyJg"),T=a("vIZW"),w=a("O8JI"),B=a("VLiW"),P=a("nU37"),M=a("LWNj"),F=a("zjQG"),A=a("sMDT"),I=a("KqNE"),_=a("Mxns"),x=a("8nDi"),E=a("fqMU"),R=a("p/Ll"),L=a("w48d");const D=Object(l.createContext)({accounts:[],allowedPaymentMethods:[],formattedPaymentMethods:[],tradableAssets:[],subscriptionStatus:"NOT_SUBSCRIBED"});function K({children:e,accounts:t,allowedPaymentMethods:a,formattedPaymentMethods:r,tradableAssets:o,subscriptionStatus:i}){const s=Object(l.useMemo)(()=>({accounts:t,allowedPaymentMethods:a,formattedPaymentMethods:r,tradableAssets:o,subscriptionStatus:i}),[t,a,r,o,i]);return Object(n.a)(D.Provider,{value:s},void 0,e)}function N(){return Object(l.useContext)(D)}var U=Object(l.memo)(K),V=a("uEse");const H=Object(I.c)({steps:["entry","principalInsolvency","recurringSelect","paymentError","buyPreview","sellPreview","buyStatus","sellStatus","wbl","selectAsset","selectPayment","recurringRewardTerms","buyPresetAmounts","plaidRelink","buyDisclosures","feesInfo","experimentalAssetConfirmation","confirm3ds","donationConfirmation"],defaultStep:"entry"}),q={amount:"",activePaymentMethodId:void 0,recurringPeriod:"never",isFiatInput:!0,tradeComplete:!1,showPresetAmountsIfAvailable:!1,eventContext:"assetPage",transferType:"buy",assetId:"",donationAmount:void 0,buyQuoteResponse:void 0,sellQuoteResponse:void 0,buyCommitResponse:void 0,sellCommitResponse:void 0,cardStatus:void 0,buyInputParams:void 0,sellInputParams:void 0},z=Object(V.a)({initialValues:q});var W=a("K/G0"),Q=a("QLaP"),G=a.n(Q);function Y(){const{activePaymentMethodId:e}=Object(S.a)(z),{allowedPaymentMethods:t}=N();return Object(l.useMemo)(()=>{const a=t.find(t=>e.value===t.id);return G()(a,"there should always be an active payment method"),a},[t,e])}function J(){const{assetId:e}=Object(S.a)(z),{tradableAssets:t}=N(),a=Object(l.useMemo)(()=>t.find(({asset:t})=>t.uuid===e.value),[e,t]);return G()(a,"There should always be a selected asset"),a}function $(){const{isFiatInput:e,eventContext:t,transferType:a,recurringPeriod:n}=Object(S.a)(z),r=J(),o=Y().type,i=Object(l.useMemo)(()=>({currencyType:e.value?"fiat":"crypto",currency:r.asset.symbol,repeat:"first_and_fifteenth"===n.value?"every_two_weeks":n.value,context:t.value,payment_method:o}),[e.value,r.asset,n,o,t.value]);return Object(l.useCallback)((e,t={})=>{W.a.track(`${a.value}_${e}`,Object.assign({},i,t))},[i,a.value])}var Z=a("+fIm");function X(){const e=Y(),t=Object(l.useMemo)(()=>e.recurringOptions?e.recurringOptions.map(e=>({key:e.period,label:e.label,value:e.period})):[],[e.recurringOptions]);return Object(l.useMemo)(()=>t.length>0,[t])}var ee=a("U0rQ"),te=a("B6gP");var ae=a("QFYQ"),ne=a.n(ae),le=a("WI56"),re=a("5vQi"),oe=a("eEWS"),ie=a("FQEq"),se=a("yVYY"),ce=a("iiUS"),ue=a("i7H4"),de=a("e29S"),be=a("oN8/"),pe=a("/bOI"),me=a("dgBL"),ye=a("V21s"),ge=a("wiuo"),fe=a("qMrP"),ve=a("JSRU"),je=a("DDg1"),Oe=a("tUXj"),Se=a("UP4x"),he=a("TqGZ"),ke=a("f8+8"),Ce=a("ckIB"),Te=a("hOK7"),we=a("9iU7"),Be=a("zYYD"),Pe=a.n(Be),Me=a("N8wZ");function Fe(){const e=function(){const{accounts:e,tradableAssets:t}=N(),{transferType:a}=Object(S.a)(z),n=J().asset.uuid,r=Object(l.useCallback)(e=>t.some(({asset:t})=>t.uuid===e),[t]);return Object(l.useMemo)(()=>"buy"===a.value?e.filter(e=>r(e.currency.assetId)&&!["multisig_vault","multisig"].includes(e.type)&&n===e.currency.assetId):e.filter(e=>r(e.currency.assetId)&&"wallet"===e.type),[e,n,a,r])}(),t=J().asset.symbol;return Object(l.useMemo)(()=>e.find(e=>e.currency.code===t&&("BTC"===t&&e.primary||"BTC"!==t&&"wallet"===e.type))||e[0],[t,e])}function Ae(){const e=Object(Me.a)(),t=Fe(),a=J(),n=Y().currency,r=Object(l.useMemo)(()=>(null===t||void 0===t?void 0:t.balance)||{amount:"0",currency:a.asset.symbol},[a.asset,null===t||void 0===t?void 0:t.balance]),o=e({currency:a.asset.symbol,amount:r.amount},n);return{assetBalance:r,assetBalanceInFiat:Object(l.useMemo)(()=>({amount:Pe()(o),currency:n}),[n,o])}}function Ie(){const{showModal:e}=Object(Te.a)(),t=J(),a=Object(Ce.a)(t.asset.symbol),{assetBalance:l,assetBalanceInFiat:r}=Ae();return Object(n.a)(we.b,{label:a?Object(n.a)(ke.a,{assetSymbol:t.asset.symbol,onBalanceClick:()=>e(Object(n.a)(he.a,{hidePendingHolds:!0,assetSymbol:t.asset.symbol}))}):void 0,balance:l,fiatBalance:r})}var _e=Object(l.memo)(Ie);function xe(){const{activePaymentMethodId:e}=Object(S.a)(z),{formattedPaymentMethods:t}=N();return Object(l.useMemo)(()=>{const a=t.find(t=>t.id===e.value);return G()(a,"there should always be a formatted payment method"),a},[e.value,t])}var Ee=a("oNR1"),Re=a("9dgA"),Le=a("+xbH"),De=a("D0bR"),Ke=a("mxbj"),Ne=a("hGpA"),Ue=a.n(Ne),Ve=a("hIT1"),He=a("dkP0"),qe=a("nuP0");const ze=Object(o.c)({genericError:{id:"UseApplePayBuySubmitter.genericError",defaultMessage:"Something went wrong. Please try again later"}}),We="Coinbase",Qe=({total:e,paymentMethod:t})=>{const[{paymentRequest:a,applePayClient:n},r]=Object(l.useState)({}),{getBraintreeClient:o}=Object(He.a)("apple_pay"),{formatMessage:s}=Object(i.a)(),{showErrorToast:c}=Object(Ke.a)(),u=Object(l.useCallback)((e,t)=>{Bugsnag.notify(e,{metaData:{context:"useApplePayBuySubmitter."+t}}),c(s(ze.genericError))},[c,s]);Object(l.useEffect)(()=>{let a,n;if("apple_pay"===(null===t||void 0===t?void 0:t.type)){const{promise:l,cancel:i}=Object(Ve.a)((async()=>{try{a=await o(),n=await Ue.a.applePay.create({client:a})}catch(e){u(e,"createApplePayClient")}})());return l.then(()=>{if(n){const a=n.createPaymentRequest(Object.assign({total:{label:We,amount:e.value}},Object(qe.b)(null===t||void 0===t?void 0:t.pickerData)));r({applePayClient:n,paymentRequest:a})}}).catch(e=>{u(e,"createPaymentRequest")}),()=>{var e,t;i(),null===(e=a)||void 0===e||e.teardown(),null===(t=n)||void 0===t||t.teardown()}}},[]);return{isApplePayReady:Object(l.useMemo)(()=>!(!n||!a),[n,a]),submitApplePayBuy:Object(l.useCallback)(e=>{if(n)try{const t=new ApplePaySession(3,a);t.onvalidatemerchant=e=>{n.performValidation({validationURL:e.validationURL,displayName:We},(e,a)=>{e?u(e,"submitApplePayBuy.onvalidatemerchant"):t.completeMerchantValidation(a)})},t.onpaymentauthorized=a=>{n.tokenize({token:a.payment.token},(a,n)=>{if(a)return u(a,"submitApplePayBuy.onpaymentauthorized"),void t.completePayment(ApplePaySession.STATUS_FAILURE);t.completePayment(ApplePaySession.STATUS_SUCCESS),e(n.nonce)})},t.begin()}catch(t){u(t,"submitApplePayBuy"),console.error(t)}},[a,n,u])}};var Ge=a("sjxy");const Ye=Object(o.c)({genericError:{id:"UseGooglePayBuySubmitter.genericError",defaultMessage:"Something went wrong. Please try again later"}});var Je;const $e=void 0!==Je?Je:Je=a("376Q");var Ze=a("bNYv"),Xe=a("qlI+");var et,tt,at=a("4Id/"),nt=a("F1kk"),lt=a("9Twb");function rt(){var e;const t=Object(l.useRef)(""),n=Object(l.useRef)(""),[r,o]=Object(l.useState)(!1),{showErrorToast:c}=Object(Ke.a)(),{formatMessage:u}=Object(i.a)(),d=Object(Ee.i)(),{buyQuoteResponse:b,buyCommitResponse:p}=Object(S.a)(z),{goToStep:m}=Object(I.j)(H),y=Fe(),f=Y(),v=J(),j=Object(De.a)("createTransfer"),O=function(){const e=Object(nt.a)(),t=Object(lt.a)(),{goToStep:n}=Object(I.j)(H),{cardStatus:r}=Object(S.a)(z),o=Object(at.a)();return Object(l.useCallback)(({accountId:l,transferId:i,onComplete:s,maxPollAttempts:c=100,pollIntervalInMs:u=1e3})=>{e({maxPollAttempts:c,retryDelayMilliseconds:u,resource:async()=>t(void 0!==et?et:et=a("VNxb"),{accountId:l,transferId:i}),onResponse:({viewer:e})=>{var t;const{status:a,secure3DVerification:l,cardStatus:i,requiresCompletionStep:s}=(null===(t=e.accountByUuid)||void 0===t?void 0:t.buyByUuid)||{};switch(a){case"CANCELED":return i?(o().then(()=>{r.onChange(i),n("paymentError")}),{type:"ContinuePolling"}):{type:"Result",result:{status:a}};case"COMPLETED":return{type:"Result",result:{status:a}};case"STARTED":case"CREATED":return s?{type:"Result",result:{status:a,options:Object(Re.a)(l)}}:{type:"ContinuePolling"};default:return{type:"ContinuePolling"}}},onComplete:e=>{switch(e.type){case"Success":return s(e.result);case"MaxRetries":case"Error":return s({status:"CANCELED"})}}})},[r,o,t,n,e])}(),h=Object(P.b)({assetId:v.asset.uuid}),k=null===(e=b.value)||void 0===e?void 0:e.transferBuy;G()(k,"There should be a quote id");const C="apple_pay"===f.type,T="google_pay"===f.type,{submitApplePayBuy:w,isApplePayReady:B}=Qe({total:k.total,paymentMethod:f}),{submitGooglePayBuy:M,isGooglePayReady:F}=(({total:e,paymentMethod:t})=>{const[{paymentRequest:a,googlePayClient:n},r]=Object(l.useState)({}),{getBraintreeClient:o}=Object(He.a)("google_pay"),{formatMessage:s}=Object(i.a)(),{showErrorToast:c}=Object(Ke.a)(),{country:u}=Object(g.a)(),d=Object(l.useCallback)((e,t)=>{Bugsnag.notify(e,{metaData:{context:"useGooglePayBuySubmitter."+t}}),c(s(Ye.genericError))},[c,s]);return Object(l.useEffect)(()=>{let a,n;if("google_pay"===(null===t||void 0===t?void 0:t.type)&&e){const{promise:t,cancel:l}=Object(Ve.a)(Promise.resolve());return t.then(async()=>{a=await o()}).then(async()=>{n=await Ue.a.googlePayment.create({client:a,googlePayVersion:Ge.b.googlePayVersion,googleMerchantId:Ge.b.googleMerchantId})}).then(()=>{if(n)return n.createPaymentDataRequest({transactionInfo:{currencyCode:e.currency,totalPriceStatus:"FINAL",totalPrice:e.value,totalPriceLabel:"Total",checkoutOption:"COMPLETE_IMMEDIATE_PURCHASE",displayItems:[{label:"Subtotal",type:"SUBTOTAL",price:e.value}]}})}).then(e=>{if(!e)return;const{billingAddressParameters:t,billingAddressRequired:a,allowCreditCards:l,allowPrepaidCards:o}=Ge.b,i=e.allowedPaymentMethods.find(e=>"CARD"===e.type);i&&(i.parameters.billingAddressRequired=a,i.parameters.billingAddressParameters=t,i.parameters.allowCreditCards=l,i.parameters.allowPrepaidCards=o),e.callbackIntents=["PAYMENT_AUTHORIZATION"],e.merchantInfo.merchantName="Coinbase",e.transactionInfo.countryCode=u.code,r({googlePayClient:n,paymentRequest:e})}).catch(e=>{d(e,"createGooglePayClientAndPaymentRequest")}),()=>{var e,t;l(),null===(e=n)||void 0===e||e.teardown(),null===(t=a)||void 0===t||t.teardown()}}},[]),{isGooglePayReady:!(!n||!a),submitGooglePayBuy:Object(l.useCallback)(async()=>{try{if(!n||!a)throw new Error("Google Pay Braintree client not initialized");const e=new google.payments.api.PaymentsClient({environment:Ge.b.environment,paymentDataCallbacks:{onPaymentAuthorized:()=>({transactionState:"SUCCESS"})}}),t=await e.loadPaymentData(a);return(await n.parseResponse(t)).nonce}catch(e){if("CANCELED"===(null===e||void 0===e?void 0:e.statusCode))return!1;d(e,"submitGooglePayBuy")}},[a,n,d])}})({total:k.total,paymentMethod:f}),[A,_]=Object(be.useMutation)(void 0!==tt?tt:tt=a("3qCY")),x=Object(l.useCallback)(e=>{var t;const a=Object(be.readInlineData)($e,e);if("poll_and_secure3d_redirect"!==(null===(t=a.nextStep)||void 0===t?void 0:t.action))return p.onChange(a),m("buyStatus");o(!0),O(Object.assign({accountId:y.id,transferId:a.uuid,onComplete:e=>{switch(o(!1),e.status){case"CANCELED":case"COMPLETED":return p.onChange(a),m("buyStatus");case"STARTED":case"CREATED":return function({verify3dsOptions:e,onError:t,accountId:a,originRoute:n,commitResponse:l,paymentMethodId:r,assetId:o}){const{url:i,payload:c}=e,u=()=>{W.a.track("three_ds_load_failed",{action:s.ActionType.render,componentType:s.ComponentType.page,loggingId:"8cc8c6b3-6f99-4b09-aa1e-ed8424541a94"}),t()};try{const e={id:l.uuid,assetId:o};localStorage.setItem(Xe.a,a),localStorage.setItem(Xe.e,JSON.stringify(e)),localStorage.setItem(Xe.d,r),localStorage.setItem(Xe.b,n),localStorage.getItem(Xe.a)&&localStorage.getItem(Xe.e)&&localStorage.getItem(Xe.d)?(W.a.track("three_ds_load_completed",{action:s.ActionType.render,componentType:s.ComponentType.page,loggingId:"5b6fc053-5d7f-499f-8b1e-566368082491"}),Object(Ze.a)(i,"POST",c)):u()}catch(d){Bugsnag.notify(d),u()}}({verify3dsOptions:e.options,commitResponse:a,onError:()=>c(u(Le.a.commitError)),accountId:y.id,paymentMethodId:f.id,assetId:v.asset.uuid,originRoute:d.pathname})}}},a.nextStep))},[y.id,f.id,p,u,m,d.pathname,O,v.asset,c]),E=Object(l.useCallback)(async()=>{v.asset.experimental&&h();const e=()=>{A({variables:{input:{threatmetrixSessionId:j,accountUuid:y.id,transferBuyUuid:k.uuid,applePayNonce:t.current,braintreePmNonce:n.current}},onCompleted:({response:e})=>{const t=Object(Re.a)(null===e||void 0===e?void 0:e.commitBuy);switch(t.__typename){case"CommitBuySuccess":return x(t.transferBuy);case"GenericError":return Bugsnag.notify("Commit buy request failed",{metaData:{context:"useBuyCommitter",apiError:t.message}}),c(t.message);default:Bugsnag.notify("Unexpected typename returned",{metaData:{context:"useBuyCommitter",typename:t.__typename}})}},onError:()=>{c(u(Le.a.commitError))}})};if(C)w(a=>{t.current=a,e()});else if(T){const t=await M();t&&(n.current=t,e())}else e()},[v.asset.experimental,C,T,h,A,j,y.id,k.uuid,x,c,u,w,M]),R=Object(l.useMemo)(()=>_||r||C&&!B||T&&!F,[_,r,C,T,B,F]);return Object(l.useMemo)(()=>({commitBuy:E,isCommitting:R}),[E,R])}var ot,it,st=a("UIe9"),ct=a("08rN");function ut(){const{isFiatInput:e}=Object(S.a)(z),t=Fe(),a=Y(),n=J();return Object(l.useMemo)(()=>({amount:void 0,total:void 0,quote:!1,commit:!1,accountUuid:t.id,currency:e.value?a.currency:n.asset.symbol,paymentMethodUuid:a.id,pmsvcId:a.pmsvcId}),[t.id,a.currency,a.id,a.pmsvcId,e.value,n.asset])}function dt(){const[e,t]=Object(l.useState)(!1),n=Object(l.useRef)(""),r=Y(),{formatMessage:o}=Object(i.a)(),{getCorrelationId:s}=Object(He.a)(Object(ct.d)(r.type)),[c,u]=Object(be.useMutation)(void 0!==ot?ot:ot=a("tLUS")),{recurringPeriod:d}=Object(S.a)(z),b=ut(),p=Object(l.useCallback)(async({variables:e,onSuccess:a,onError:l})=>{if(["apple_pay","google_pay"].includes(r.type)&&!n.current){t(!0);const e=await s();n.current=e,t(!1)}let i;"paypal_account"===r.type&&(t(!0),i=await s(),t(!1));const u=Object.assign({},b,{recurringPeriod:d.value,braintreeCorrelationId:n.current,paypalCorrelationId:i,pmsvcId:r.pmsvcId},e);c({variables:{input:u},onCompleted:({response:e})=>{const t=Object(Re.a)(e.createBuy);switch(t.__typename){case"CreateBuyPartialError":return l(new Error(t.error.message));case"CreateBuySuccess":return a(t,u);default:Bugsnag.notify(t.__typename+" __typename received",{context:"useBuyQuoteSubmitter"})}},onError:()=>l(new Error(o(st.b.genericError)))})},[r.type,r.pmsvcId,b,d.value,c,s,o]);return Object(l.useMemo)(()=>({submitBuy:p,isSubmittingBuy:u||e}),[p,u,e])}const bt=void 0!==it?it:it=a("yiHw");var pt=a("bH2g"),mt=a("iNnr"),yt=a("abUL"),gt=a("qHf1"),ft=a("zJ1k"),vt=a("7rk+"),jt=a("yn0T"),Ot=a("r4+4");const St=Object(o.c)({buyAssetHeader:{id:"BuySellStepper.EntryStep.buyAssetHeader",defaultMessage:"Buy {assetName}"},buyDefaultButton:{id:"BuySellStepper.EntryStep.buyDefaultButton",defaultMessage:"Buy {assetName}"},sellDefaultButton:{id:"BuySellStepper.EntryStep.sellDefaultButton",defaultMessage:"Sell {assetName}"},buyPreviewButton:{id:"BuySellStepper.EntryStep.buyPreviewButton",defaultMessage:"Preview Buy"},sellPreviewButton:{id:"BuySellStepper.EntryStep.sellPreviewButton",defaultMessage:"Preview Sell"},buySelectAssetLabel:{id:"BuySellStepper.EntryStep.buySelectAssetLabel",defaultMessage:"Buy"},sellSelectAssetLabel:{id:"BuySellStepper.EntryStep.sellSelectAssetLabel",defaultMessage:"Sell"},buySelectPaymentLabel:{id:"BuySellStepper.EntryStep.buySelectPaymentLabel",defaultMessage:"Pay with"},sellSelectPaymentLabel:{id:"BuySellStepper.EntryStep.sellSelectPaymentLabel",defaultMessage:"Add to"},sellEmptyError:{id:"BuySellStepper.EntryStep.sellEmptyError",defaultMessage:"You don\u2019t have any {assetName} to sell. Try buying some to get started."},sellAll:{id:"BuySellStepper.EntryStep.sellAll",defaultMessage:"Sell all"},achBuyDisabled:{id:"BuySellStepper.EntryStep.achBuyDisabled",defaultMessage:"Buying crypto with a bank account is temporarily unavailable. Please use a different payment method."}});function ht(e){const t=J().asset.name,{formatMessage:a}=Object(i.a)(),n=a(St.buyAssetHeader,{assetName:t}),r=St[e+"DefaultButton"],o=St[e+"PreviewButton"],s=St[e+"SelectAssetLabel"],c=St[e+"SelectPaymentLabel"],u=a(St.sellAll),d=a(St.achBuyDisabled),b=a(St.sellEmptyError,{assetName:t});return Object(l.useMemo)(()=>({buyAssetHeader:n,defaultButton:a(r,{assetName:t}),previewButton:a(o),selectAssetLabel:a(s),selectPaymentLabel:a(c),sellAll:u,sellEmptyError:b,achBuyDisabled:d}),[d,t,n,r,a,o,s,c,u,b])}const kt=Object(o.c)({previewHeader:{id:"BuySellStepper.PreviewStep.previewHeader",defaultMessage:"Order preview"},priceLabel:{id:"BuySellStepper.PreviewStep.priceLabel",defaultMessage:"Price"},seeMore:{id:"BuySellStepper.PreviewStep.seeMore",defaultMessage:"See more"},free:{id:"BuySellStepper.PreviewStep.free",defaultMessage:"Free"}}),Ct=Object(o.c)({buyButton:{id:"BuySellStepper.PreviewStep.buyButton",defaultMessage:"Buy now"},recurringLabel:{id:"BuySellStepper.PreviewStep.recurringLabel",defaultMessage:"Recurring"},buyActionLabel:{id:"BuySellStepper.PreviewStep.buyActionLabel",defaultMessage:"Purchase"},buyTotalLabel:{id:"BuySellStepper.PreviewStep.buyTotalLabel",defaultMessage:"Total"},wblNoticeText:{id:"BuySellStepper.PreviewStep.wblNoticeText",defaultMessage:"Trade instantly on Coinbase, available to send in {holdDays} days."},wblNoticeTextInHeader:{id:"BuySellStepper.PreviewStep.wblNoticeTextInHeader",defaultMessage:"Trade instantly, available to send in {holdDays} days"},wblNoticeLink:{id:"BuySellStepper.PreviewStep.wblNoticeLink",defaultMessage:"Need to send instantly?"},wblNoticeTextNew:{id:"BuySellStepper.PreviewStep.wblNoticeTextNew",defaultMessage:"Trade your {assetCode} <now>now</now> while we wait for your funds. You can send your {assetCode} in up to {holdDays}."},wblNoticeTextNewHoldDays:{id:"BuySellStepper.PreviewStep.wblNoticeTextNewHoldDays",defaultMessage:"{holdDays} days"},instantAchEntireText:{id:"BuySellStepper.PreviewStep.instantAchEntireText",defaultMessage:"Want to send your {assetCode}? You can send the full amount <b>instantly</b>."},instantAchPartialText:{id:"BuySellStepper.PreviewStep.instantAchPartialText",defaultMessage:"Want to send your {assetCode}? You can send {amount} in {assetCode} <b>instantly</b>. The rest of your purchase will be available to send in <b>{x} days</b>, after your funds arrive."},processedByText:{id:"BuySellStepper.PreviewStep.processedByText",defaultMessage:"Processed by"},processedByLink:{id:"BuySellStepper.PreviewStep.processedByLink",defaultMessage:"Coinbase UK, Ltd."},promoDescription:{id:"BuySellStepper.PreviewStep.promoDescription",defaultMessage:"Until June 30th, enjoy flat 1.49% fees on all recurring buys.  After that, fees return to normal."},promoLink:{id:"BuySellStepper.PreviewStep.promoLink",defaultMessage:"Learn more about our fees."},recurringReward:{id:"BuySellStepper.PreviewStep.recurringReward",defaultMessage:"You'll earn {reward} {assetSymbol} after your {nth} buy"},recurringRewardMultiplePayouts:{id:"BuySellStepper.PreviewStep.recurringRewardMultiplePayouts",defaultMessage:"You'll earn {reward} {assetSymbol} after both your {nth} buys"},recurringRewardNudge:{id:"BuySellStepper.PreviewStep.recurringRewardNudge",defaultMessage:"Add {amount} and get {reward} {assetSymbol} after your {nth} recurring buy"},recurringRewardNudgeMultiplePayouts:{id:"BuySellStepper.PreviewStep.recurringRewardNudgeMultiplePayouts",defaultMessage:"Add {amount} and get {reward} {assetSymbol} after both your {nth} buys"},recurringRewardAdd:{id:"BuySellStepper.PreviewStep.recurringRewardAdd",defaultMessage:"Add {amount}"},recurringTransactionRewardTerms:{id:"BuySellStepper.PreviewStep.recurringTransactionRewardTerms",defaultMessage:"See terms for this recurring buy offer."},feeWaived:{id:"BuySellStepper.PreviewStep.feeWaived",defaultMessage:"We've waived the fee on your first Coinbase purchase. <b>Enjoy your crypto!</b>"},upsellRecurringBuyTitle:{id:"BuySellStepper.PreviewStep.upsellRecurringBuyTitle",defaultMessage:"Make this a weekly buy?"},upsellRecurringBuyDescription:{id:"BuySellStepper.PreviewStep.upsellRecurringBuyDescription",defaultMessage:"You can cancel any time"},upsellRecurringBuyButton:{id:"BuySellStepper.PreviewStep.upsellRecurringBuyButton",defaultMessage:"Yes"}}),Tt=()=>{var e,t;const a=Object(i.a)(),{formatMessage:l}=a,r=Object(re.a)(),o=J(),s=Object(vt.a)(),{isFiatInput:c,buyQuoteResponse:u}=Object(S.a)(z),d=ht("buy"),b=null===(e=u.value)||void 0===e?void 0:e.transferBuy;G()(b,"There should be a quote response");const p=xe(),{subtotal:m,amount:y,total:g,paymentMethod:f,unitPrice:v,holdDays:j=0,recurringPayment:O,instantAch:h}=b,k=r({amount:y,isFiat:!1}),C=r({amount:g,isFiat:!0}),T=r({amount:v.amount,isFiat:!0,exponent:Object(ft.a)(parseFloat(v.amount.value))}),w=null!=(t=null===O||void 0===O?void 0:O.toLowerCase())?t:"never",B="never"!==w?Object(Ot.b)({formatMessage:l,period:w,amount:c.value?C:k}):void 0,P="never"!==w?Object(Ot.a)({formatMessage:l,period:w}):void 0,M=l(Ct.feeWaived,{b:e=>[Object(n.a)("b",{},"feeWaived",e)]}),F=0===j?void 0:l(Ct.wblNoticeText,{holdDays:j}),A=0===j?void 0:l(Ct.wblNoticeTextInHeader,{holdDays:j}),I=0===j||h?void 0:l(Ct.wblNoticeTextNew,{holdDays:Object(n.a)("b",{},void 0,l(Ct.wblNoticeTextNewHoldDays,{holdDays:j})),assetCode:o.asset.symbol,now:e=>[Object(n.a)("b",{},void 0,e)]}),_=h?h.isTotalInstant||0===j?l(Ct.instantAchEntireText,{assetCode:o.asset.symbol,b:e=>[Object(n.a)("b",{},"limitPeriod",e)]}):l(Ct.instantAchPartialText,{assetCode:o.asset.symbol,b:e=>[Object(n.a)("b",{},"limitPeriod",e)],x:j,amount:r({amount:h.instantAchAmount,isFiat:!0,exponent:0})}):void 0;return{header:l(kt.previewHeader),cryptoAmount:k,paymentLabel:d.selectPaymentLabel,paymentValue:p.label,recurringLabel:l(Ct.recurringLabel),recurringValue:B,recurringValueDetails:P,priceLabel:l(kt.priceLabel),priceValue:`${T} / ${o.asset.symbol}`,priceValueShort:""+T,actionLabel:l(Ct.buyActionLabel),actionValue:r({amount:m,isFiat:!0}),totalLabel:l(Ct.buyTotalLabel),totalValue:C,button:l(Ct.buyButton),wblNoticeText:F,wblNoticeTextInHeader:A,wblNoticeTextNew:I,instantAchText:_,wblNoticeLink:l(Ct.wblNoticeLink),processedByText:l(Ct.processedByText),processedByLink:l(Ct.processedByLink),promoDescription:l(Ct.promoDescription),promoLink:l(Ct.promoLink),recurringReward:(e,t)=>l(1===t.length?Ct.recurringReward:Ct.recurringRewardMultiplePayouts,{reward:r({amount:{amount:e.value,currency:e.currency},isFiat:!0,exponent:0}),assetSymbol:"BTC",nth:Object(jt.b)(t,l)}),recurringRewardNudge:(e,t,a)=>{var n;return l(1===a.length?Ct.recurringRewardNudge:Ct.recurringRewardNudgeMultiplePayouts,{amount:r({amount:{value:e,currency:null!=(n=null===f||void 0===f?void 0:f.currency)?n:s},isFiat:!0}),reward:r({amount:t,isFiat:!0,exponent:0}),assetSymbol:"BTC",nth:Object(jt.b)(a,l)})},recurringRewardAdd:e=>{var t;return l(Ct.recurringRewardAdd,{amount:r({amount:{amount:e,currency:null!=(t=null===f||void 0===f?void 0:f.currency)?t:s},isFiat:!0})})},recurringTransactionRewardTerms:l(Ct.recurringTransactionRewardTerms),feeWaived:M,free:l(kt.free),seeMore:l(kt.seeMore),upsellRecurringBuyTitle:l(Ct.upsellRecurringBuyTitle),upsellRecurringBuyDescription:l(Ct.upsellRecurringBuyDescription),upsellRecurringBuyButton:l(Ct.upsellRecurringBuyButton)}};var wt=Tt,Bt=a("kSTq"),Pt=a("dUm2"),Mt=a("JY1H"),Ft=a("HSok");const At=({messages:e,bonusDetails:t,fiatTotalValue:a,useNewPreviewCard:o})=>{const{goToStep:i}=Object(I.j)(H),{amount:s}=Object(S.a)(z),{splitTestName:c,recurringTransactionBonus:u,hasRewardData:d}=t,{amountThreshold:b,payout:p,nthPaymentTriggers:m}=u,{banner:y,difference:g}=Object(Mt.a)(null===b||void 0===b?void 0:b.value,a),f=Object(Ft.c)({bonus:u}),v=Object(Ft.d)({bonus:u}),j=Object(je.a)("dec_2021_web_streamline_trade_preview","treatment"),O=Object(l.useCallback)(()=>{f(),i("entry"),s.onChange(b.value)},[f,b.value,i,s]),h=Object(pe.useVariant)(fe.a[c]),k=h&&"control"!==h&&d;Object(l.useEffect)(()=>{k&&v({reachedThreshold:"reward"===y})},[]);const C=o?me.k:me.e,T=Object(l.useMemo)(()=>"upsell"===y&&b.value?Object(n.a)(It,{body:e.recurringRewardNudge(g,p,m),upsellText:e.recurringRewardAdd(g),onUpsellClick:O,useNewPreviewCard:o}):"reward"===y?Object(n.a)(C,{customIcon:j?void 0:Object(n.a)(Pt.default,{symbol:"BTC",size:30}),description:e.recurringReward(p,m)}):void 0,[C,b.value,y,g,O,j,e,m,p,o]);if(!k)return null;const B=y?Object(n.a)(w.x,{text:e.recurringTransactionRewardTerms,onClick:()=>i("recurringRewardTerms")}):null;return r.a.createElement(r.a.Fragment,null,T,B)},It=({body:e,upsellText:t,onUpsellClick:a,useNewPreviewCard:l})=>{const r=l?me.k:me.e;return Object(n.a)(r,{customIcon:l?void 0:Object(n.a)(Pt.default,{symbol:"BTC",size:30}),description:e,onPress:a,action:Object(n.a)(_t,{},void 0,t)})},_t=Object(O.e)(Bt.a).attrs({color:"accent"}).withConfig({displayName:"RecurringTradeRewardPreviewBanners__PreviewButtonText",componentId:"hdtubr-0"})(["font-weight:",";font-size:",";text-align:center;"],e=>e.theme.fontWeight.demiBold,e=>e.theme.fontSize.tiny);var xt=Object(l.memo)(At);var Et=function({hasRecurringTransactions:e,buyQuote:t}){const{isInUS:a}=Object(g.a)(),n=X()&&!e;return Object(l.useMemo)(()=>{const e=Number(t.total.value)<=25e3,l=!!t.recurringPayment;return a&&(e&&!l)&&n},[t.recurringPayment,t.total.value,n,a])};function Rt(e){return Object(n.a)(mt.a,{},void 0,Object(n.a)(yt.b,{boundaryName:"BuyPreviewCards"},void 0,Object(n.a)(pt.a,{fallback:null},void 0,r.a.createElement(Lt,Object.assign({},e)))))}function Lt({buyQuote:e,hasRecurringTransactions:t,onPressRecurringUpsell:a,disabled:r}){const o=wt(),{hasMadeAPurchase:i}=Object(g.a)(),s=Object(je.a)("dec_2021_web_streamline_trade_preview","treatment"),c=Et({hasRecurringTransactions:t,buyQuote:e}),{defaultFee:u,fee:d,total:{value:b},recurringPayment:p,amount:{currency:m}}=e,y=Object(gt.a)(m,!p||!m),{userEligibleForNewBonus:f,recurringTransactionBonus:v}=y,j=Object(l.useMemo)(()=>!i&&u&&d&&u.value!==d.value&&0===parseFloat(d.value),[u,i,d]),O=Object(l.useMemo)(()=>{const e=[],t=s?me.k:me.e;return c&&e.push(Object(n.a)(t,{testID:"recurring-upsell-card",title:o.upsellRecurringBuyTitle,description:o.upsellRecurringBuyDescription,icon:s?void 0:"recurring",action:Object(n.a)(oe.Button,{compact:!0,variant:"secondary",onPress:a,disabled:r},void 0,o.upsellRecurringBuyButton)},"recurring-upsell-card")),j?e.push(Object(n.a)(t,{testID:"first-buy-card",icon:s?void 0:"circleCheckmark",description:o.feeWaived},"first-buy-card")):o.wblNoticeTextNew&&!s&&e.push(Object(n.a)(t,{testID:"wbl-card",description:o.wblNoticeText},"wbl-card")),o.instantAchText&&e.push(Object(n.a)(t,{testID:"instant-ach-card",description:o.instantAchText},"instant-ach-card")),f&&(null===v||void 0===v?void 0:v.assetEligible)&&e.push(Object(n.a)(xt,{messages:o,fiatTotalValue:b,bonusDetails:y,useNewPreviewCard:s})),e},[s,c,j,o,f,null===v||void 0===v?void 0:v.assetEligible,a,r,b,y]);return Object(n.a)(Dt,{},void 0,O)}const Dt=O.e.div.withConfig({displayName:"BuyPreviewCards__PreviewCardGrid",componentId:"sc-1x1efvb-0"})(["display:grid;grid-auto-rows:auto;grid-gap:16px;padding-left:24px;padding-right:24px;padding-bottom:16px;"]);var Kt=a("DRDe");function Nt(){const e=Object(l.useRef)(null),t=Object(l.useRef)(null),[a,n]=Object(l.useState)(0),[r,o]=Object(l.useState)(0);Object(l.useEffect)(()=>{e.current&&n(e.current.clientHeight),t.current&&o(t.current.clientHeight)},[]);const i=Object(l.useMemo)(()=>a+r+Kt.g,[r,a]);return Object(l.useMemo)(()=>({requiredContentRef:e,footerRef:t,totalHeight:i}),[i])}var Ut,Vt=a("Cwlv");var Ht=a("vmnu");const qt=["buy_ach_notice","buy_ny_notice","buy_trade_disclosure"],zt=(e=[])=>{const t=r.a.Children.toArray(ne()(e));return t.length>0?t:null};function Wt({tradeWarning:e,onClick:t}){var a,l;return Object(s.useLogEventOnMount)("trade_disclosure",{loggingId:"fb65743b-1486-4562-b745-e4692afc4773",componentType:s.ComponentType.card,display_type:"label"}),Object(n.a)(w.y,{text:e.message,link:{text:null!=(a=null===e||void 0===e||null===(l=e.context)||void 0===l?void 0:l.linkText)?a:"",onClick:t}})}const Qt=Object(O.e)(le.a).attrs(()=>({align:"center"})).withConfig({displayName:"BuyPreviewStep__PromoContainer",componentId:"sc-1ym8jwu-0"})([""]),Gt=O.e.div.withConfig({displayName:"BuyPreviewStep__PromoAmount",componentId:"sc-1ym8jwu-1"})(["color:",";margin-right:8px;"],({theme:e})=>e.color.textAccent),Yt=Object(O.e)(ye.a).withConfig({displayName:"BuyPreviewStep__StrikedFormattedAmount",componentId:"sc-1ym8jwu-2"})(["text-decoration:line-through;"]);var Jt,$t=({recurringTransactions:e})=>{var t,o,c,u;const d=xe(),{goToStep:b,goBack:p}=Object(I.j)(H),{eventContext:m,buyQuoteResponse:y,recurringPeriod:f,isFiatInput:v,buyInputParams:j}=Object(S.a)(z),{subscriptionStatus:O}=N(),h=Object(ve.b)(O),{isInJapan:k,isInSingapore:C}=Object(g.a)(),[T,B]=Object(l.useState)(!1),P=Object(re.a)(),M=null===(t=y.value)||void 0===t?void 0:t.transferBuy,F=null!=(o=null===(c=y.value)||void 0===c?void 0:c.userWarnings)?o:[];G()(M,"There should be a buy quote response");const{commitBuy:A,isCommitting:_}=rt(),{requiredContentRef:x,footerRef:E,totalHeight:R}=Nt(),{formatMessage:L}=Object(i.a)(),D=Object(ee.a)(),K=$(),U="treatment"===Object(pe.useVariant)(fe.a.sep_2021_web_buy_sell_live_quotes);G()(j.value,"buy input params should be set");const{stopPolling:V,isSignificantChange:q}=((e,t,n)=>{const r=Object(l.useRef)(),[o]=Object(be.useMutation)(void 0!==Ut?Ut:Ut=a("0mhu")),{startTimeout:i,stopTimeout:s}=Object(Vt.a)(),{buyQuoteResponse:c}=Object(S.a)(z),u=Object(l.useRef)(n),[d,b]=Object(l.useState)(!1),p=Object(l.useCallback)(e=>{const t=Object(be.readInlineData)(bt,e);c.onChange(t),parseFloat(t.transferBuy.unitPrice.amount.value)/parseFloat(u.current)>1.02&&b(!0)},[c]),m=Object(l.useCallback)(()=>o({variables:{input:e},onCompleted:({response:e})=>{const t=Object(Re.a)(e.createBuy);switch(t.__typename){case"CreateBuySuccess":return p(t),void i(()=>{r.current=m()},8e3);default:Bugsnag.notify("Buy quote refresh failed",{context:"useRefreshBuyQuote"})}},onError:()=>{Bugsnag.notify("Buy quote refresh failed",{context:"useRefreshBuyQuote"})}}),[o,p,e,i]),y=Object(l.useCallback)(()=>{var e;null===(e=r.current)||void 0===e||e.dispose(),s()},[s]);return Object(l.useEffect)(()=>(t&&i(()=>{r.current=m()},8e3),()=>{y()}),[t]),{stopPolling:y,isSignificantChange:d}})(j.value,U,M.unitPrice.amount.value),{showModal:W}=Object(Oe.a)();Object(l.useEffect)(()=>{q&&W(Object(n.a)(Ht.a,{asset:M.amount.currency,displayInputCurrency:M.total.currency,onConfirm:V,onBack:p,type:v?"fiat":"crypto"}))},[q]);const Q=Object(l.useCallback)(()=>{K("tapped_confirm_button"),V(),A()},[K,A,V]),Y=Object(s.useEventLogger)("trade_disclosure_cta",{action:s.ActionType.click,loggingId:"19f3d9ab-2132-4f4f-b0cc-8ef9e60c173c",componentType:s.ComponentType.button,display_type:"label",cta_type:"primary"}),J=Object(w.K)(),Z=Object(je.a)("june_2021_web_buy_preview_modal","treatment"),X=Object(je.a)("dec_2021_web_streamline_trade_preview","treatment"),te=Tt(),ae="tapped_buy_fee_explanation_button",ne=Object(l.useCallback)(()=>{K(ae)},[K,ae]),le=Object(l.useCallback)(()=>{ne(),J&&b("feesInfo")},[ne,J,b]),ye=M.fee,he=M.defaultFee;function ke(e){return F.find(t=>t.code===e)}Object(l.useEffect)(()=>{K("viewed_preview")},[]);const Ce=F.filter(e=>!qt.includes(e.code)&&!("rewards_notice"===e.code&&"defiYield"===m.value)).map(e=>Object(n.a)(w.t,{text:e.message})),Te=ke("buy_ach_notice"),we=Te?Object(n.a)(w.y,{text:Te.message}):null,Be=ke("buy_ny_notice"),Pe=Be?Object(n.a)(w.y,{text:Be.message}):null,Me=ke("buy_trade_disclosure"),Fe=(null===Me||void 0===Me?void 0:Me.context)?Object(n.a)(Wt,{tradeWarning:Me,onClick:()=>{b("buyDisclosures"),Y()}}):null,Ae=Object(n.a)(w.h,{goBack:_?void 0:p,title:te.header}),Ie=Boolean(ye&&he&&ye.value!==he.value),Ee=()=>ye?he&&Ie?Object(n.a)(Qt,{},void 0,Object(n.a)(Gt,{},void 0,0===parseFloat(null===ye||void 0===ye?void 0:ye.value)?te.free:P({amount:ye,isFiat:!0})),r.a.createElement(Yt,Object.assign({},he,{amount:he.value}))):h?Object(n.a)(se.HStack,{gap:1,alignItems:"center"},void 0,h&&Object(n.a)(Se.a,{height:16,type:"badge"}),te.free):P({amount:ye,isFiat:!0}):null,Le=Object(n.a)(w.A,{label:te.paymentLabel,rightContent:te.paymentValue,rightIcon:d.icon}),De=Object(n.a)(w.A,{label:te.priceLabel,rightContent:te.priceValue}),Ke=r.a.createElement(r.a.Fragment,null,Object(n.a)(w.I,{text:te.cryptoAmount,useTicker:U}),Object(n.a)(w.F,{size:"enormous"}),Le,te.recurringValue&&Object(n.a)(me.m,{highlighted:T},void 0,Object(n.a)(w.A,{label:te.recurringLabel,isLastRow:!0,rightContent:r.a.createElement(r.a.Fragment,null,te.recurringValue,Object(n.a)("br",{}),te.recurringValueDetails)})),De,Object(n.a)(w.A,{label:te.actionLabel,rightContent:te.actionValue}),Object(n.a)(w.w,{includesTaxes:C,hasPromo:Ie,rightContent:Ee(),onClick:le,feeLink:k?w.k:w.l}),Object(n.a)(w.A,{label:te.totalLabel,rightContent:te.totalValue,isLastRow:!0})),Ne=r.a.createElement(r.a.Fragment,null,Object(n.a)(w.I,{text:te.cryptoAmount,useTicker:U}),Object(n.a)(ue.TextLabel2,{as:"p",align:"start",spacingTop:.5},void 0,te.priceValue),Object(n.a)(de.TextLegal,{as:"p",color:"foregroundMuted",spacingTop:2,align:"center"},void 0,te.wblNoticeTextInHeader),Object(n.a)(w.F,{size:"enormous"}),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,Object(n.a)(w.A,{label:te.actionLabel,rightContent:te.actionValue})),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,Object(n.a)(w.w,{includesTaxes:C,hasPromo:Ie,rightContent:Ee(),onClick:le,feeLink:k?w.k:w.l})),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,Object(n.a)(w.A,{label:te.totalLabel,rightContent:te.totalValue})),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,Le),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,te.recurringValue&&Object(n.a)(me.m,{highlighted:T},void 0,Object(n.a)(w.A,{label:te.recurringLabel,isLastRow:!0,rightContent:r.a.createElement(r.a.Fragment,null,te.recurringValue,Object(n.a)("br",{}),te.recurringValueDetails)})))),{submitBuy:Ue,isSubmittingBuy:Ve}=dt(),He=Object(l.useMemo)(()=>v.value?"total":"amount",[v.value]),qe=Object(l.useCallback)(()=>{K("tapped_recurring_trade_upsell_banner",{recurringPeriod:"weekly"}),V(),Ue({variables:{recurringPeriod:"weekly",[He]:M[He].value,currency:M[He].currency},onSuccess:e=>{y.onChange(Object(be.readInlineData)(bt,e)),f.onChange("weekly"),B(!0)},onError:()=>b("entry")})},[K,V,Ue,He,M,y,f,b]),ze=zt(Ce),We=zt([we,Fe,Pe]),Qe=Object(n.a)(w.C,{},void 0,Object(n.a)(w.B,{},void 0,Ae,Object(n.a)(w.i,{},void 0,X?Ne:Ke),Object(n.a)(w.F,{size:"medium"}),Object(n.a)(Rt,{buyQuote:M,onPressRecurringUpsell:qe,disabled:Ve||_,hasRecurringTransactions:e.length>0}),ze&&Object(n.a)(w.v,{},void 0,ze),X&&Object(n.a)(ie.Spacer,{vertical:3})),Object(n.a)(w.B,{},void 0,Object(n.a)(w.i,{},void 0,Object(n.a)(oe.Button,{block:!0,loading:_||Ve,onPress:Q,disabled:null===(u=M.paymentMethod)||void 0===u?void 0:u.rejected,testID:"buy-confirm-button","data-testid":"buy-confirm-button"},void 0,te.button)),!X&&Object(n.a)(_e,{})),We&&Object(n.a)(w.z,{hasBorderTop:!X},void 0,We)),Ge=Object(n.a)(w.C,{isMobile:D,isExperiment:!0,totalRequiredHeight:R},void 0,Ae,Object(n.a)(ge.b,{noTopPadding:!0,noHorizontalPadding:!0,noBottomPadding:!0},void 0,Object(n.a)(w.B,{},void 0,r.a.createElement(ce.VStack,{ref:x,key:"requiredContentRef"},Object(n.a)(w.i,{},void 0,X?Ne:Ke)),Object(n.a)(w.F,{size:"medium"}),Object(n.a)(Rt,{buyQuote:M,onPressRecurringUpsell:qe,disabled:Ve||_,hasRecurringTransactions:e.length>0}),ze)),r.a.createElement(ge.i,{hasFooter:!0,noPaddingHorizontal:!0,ref:E,key:"footerRef"},X&&Object(n.a)(ie.Spacer,{vertical:3}),Object(n.a)(w.i,{},void 0,Object(n.a)(oe.Button,{block:!0,loading:_||Ve,onPress:Q,disabled:null===d||void 0===d?void 0:d.rejected,testID:"buy-confirm-button","data-testid":"buy-confirm-button","aria-label":L(Ct.buyButton)},void 0,te.button)),Object(n.a)(_e,{}),We&&Object(n.a)(w.z,{hasBorderTop:!X},void 0,We)));return Z?Ge:Qe},Zt=a("Nq15");var Xt=a("OKDF"),ea=a("pLDr");function ta(){const e=Object(Xt.a)(),t=Object(ea.a)(),a=Object(at.a)(),n=Object(_.a)();return Object(l.useCallback)(()=>{e(),t(),a(),n({type:"buys"}),n({type:"sells"})},[e,t,a,n])}var aa=a("Jegn"),na=a("Y0sT"),la=a("tSF3"),ra=a("BOQu");function oa({commitData:e}){const{goToStep:t}=Object(I.j)(H),{recurringPeriod:a}=Object(S.a)(z),r=X(),o=Object(la.a)({withRelay:!0}),i=Object(l.useMemo)(()=>{const t=o.some(t=>{var a,n,l;return(null===(a=t.account)||void 0===a||null===(n=a.assetOrFiatCurrency)||void 0===n||null===(l=n.asset)||void 0===l?void 0:l.symbol)===e.amount.currency}),a=!!e.recurringPayment;return t||a},[o,e.recurringPayment,e.amount.currency]),s=Object(l.useCallback)(()=>{a.onChange("weekly"),t("entry")},[t,a]);return r&&!i?Object(n.a)(ra.a,{onAddFunds:s}):null}function ia({commitData:e}){return Object(n.a)(na.a,{name:"CardUpsellBanner",fallback:null,errorFallback:()=>null},void 0,Object(n.a)(oa,{commitData:e}))}var sa=Object(l.memo)(ia),ca=a("hCv+"),ua=a("vq8b"),da=a("ebOw"),ba=a("tPLw");const pa=Object(o.c)({headline:{id:"VerifySSNBanner.headline",defaultMessage:"Ready to earn interest?"},subtitle:{id:"VerifySSNBanner.subtitle",defaultMessage:"We need to verify your Social Security number."}});function ma(){const e=Object(Ee.h)(),t=Object(te.h)(),{formatMessage:a}=Object(i.a)(),r=Object(l.useCallback)(()=>{t(),e.push("/yield/ssn-verify")},[e,t]);return Object(n.a)(da.Card,{spacing:1,spacingStart:2,onPress:r},void 0,Object(n.a)(ie.HStack,{},void 0,Object(n.a)(ie.VStack,{justifyContent:"center"},void 0,Object(n.a)(ue.TextHeadline,{as:"h4",color:"foreground"},void 0,a(pa.headline)),Object(n.a)(ie.Spacer,{vertical:.5}),Object(n.a)(ue.TextBody,{as:"p",color:"foregroundMuted"},void 0,a(pa.subtitle))),Object(n.a)(ba.SpotSquare,{name:"yieldCenter",scaleMultiplier:.75})))}var ya,ga=Object(l.memo)(ma);function fa({closeModal:e,onComplete:t,showStatusHeaderClose:r,fragmentRef:o}){var i,s,c,u,d;const b=Object(Ee.h)(),p=Object(ee.a)(),{goToStep:m}=Object(I.j)(H),y=J(),g=Fe(),f=Y(),v=Object(re.a)(),j=$(),{subscriptionStatus:O}=N(),h=Object(ve.b)(O),{eventContext:k,tradeComplete:C,buyCommitResponse:T,transferType:B}=Object(S.a)(z),P=T.value;G()(P,"There should be a commit response");const M=function(e){const[t,n]=Object(l.useState)(),r=Object(nt.a)(),o=Object(lt.a)(),i=Fe(),s=Object(l.useCallback)(()=>{r({maxPollAttempts:6,resource:async()=>o(void 0!==Jt?Jt:Jt=a("24oI"),{transferId:e,accountId:i.id}),onResponse:e=>{var t,a,n;switch(null===(t=e.viewer.accountByUuid)||void 0===t||null===(a=t.buyByUuid)||void 0===a||null===(n=a.accountHistory)||void 0===n?void 0:n.status){case"COMPLETED":return{type:"Result",result:"completed"};case"FAILED":case"EXPIRED":case"CANCELED":return{type:"Result",result:"canceled"};default:return{type:"ContinuePolling"}}},onComplete:e=>{switch(e.type){case"Success":n(e.result);break;case"MaxRetries":n("created");break;default:n("canceled")}}})},[i.id,o,r,e]);return Object(l.useEffect)(()=>{s()},[]),t}(P.uuid),F=ta(),A=Boolean((null===(i=P.commitNotice)||void 0===i?void 0:i.title)&&(null===(s=P.commitNotice)||void 0===s?void 0:s.description)||(null===(c=P.wblUxData)||void 0===c?void 0:c.title)&&(null===(u=P.wblUxData)||void 0===u?void 0:u.description)),_=Object(l.useCallback)(e=>{C.onChange(!0),"success"===e&&F()},[C,F]),x=Object(l.useCallback)(()=>{A&&m("wbl")},[A,m]),E=Object(l.useCallback)(()=>{e&&e()},[e]),R=Object(l.useCallback)(()=>{const t=y.asset.slug;p&&"assetPage"===k.value&&t?b.push(Object(Zt.c)(t)):(e&&e(),m("entry"))},[y.asset,p,k.value,b,e,m]),L=function({fragmentRef:e,selectedAsset:t,isSubscribedUser:r}){var o,i;const s=Object(te.h)(),c=Object(aa.a)(),u=Object(je.a)("oct_2021_defi_lend","treatment"),d=Object(je.a)("oct_2021_web_yield_ssn_not_found","treatment"),{userProperties:b}=Object(be.useFragment)(void 0!==ya?ya:ya=a("4i+S"),e),{eventContext:p,buyCommitResponse:m,buyQuoteResponse:y}=Object(S.a)(z),g=m.value,f=null===(o=y.value)||void 0===o||null===(i=o.transferBuy)||void 0===i?void 0:i.feeWithoutSubscriptionBenefit,v=Object(l.useMemo)(()=>{var e;return Boolean(t.reward&&!b.hasSsn&&(null===(e=b.regionFeatures)||void 0===e?void 0:e.isInUs)&&d)},[t,b,d]);return Object(l.useMemo)(()=>v?Object(n.a)(ga,{}):"coinbaseCard"===p.value?Object(n.a)(sa,{commitData:g}):c?Object(n.a)(ua.a,{closeModal:s,isSubscribed:r,feeWithoutSubscriptionBenefitValue:null===f||void 0===f?void 0:f.value,feeWithoutSubscriptionBenefitCurrency:null===f||void 0===f?void 0:f.currency}):u&&"defiYield"!==p.value?Object(n.a)(ca.a,{assetUuid:t.asset.uuid,closeModal:s}):null,[p.value,g,u,t.asset,s,c,r,f,v])}({fragmentRef:o,selectedAsset:y,isSubscribedUser:h}),D=Object(l.useMemo)(()=>{var e;return{status:M,type:B.value,sourceAmount:v({amount:P.amount,isFiat:!1}),sourceCurrency:f.currency,targetCurrency:P.amount.currency,accountId:g.id,fiatAccountId:null===(e=f.fiatAccount)||void 0===e?void 0:e.id,isCommitting:!1}},[g.id,f.currency,null===(d=f.fiatAccount)||void 0===d?void 0:d.id,P.amount,v,M,B.value]);return Object(n.a)(w.G,{tradeData:D,showWBL:A,onComplete:t,onContinue:x,onRetry:()=>m("entry"),onViewTransaction:E,onClose:R,onAnimationEnd:_,trackEvent:j,footer:Object(n.a)(_e,{}),banner:L,showStatusHeaderClose:r})}var va,ja=Object(l.memo)(fa);function Oa(){return Object(l.useCallback)((e,t)=>{W.a.track(e,{action:s.ActionType.unknown,componentType:s.ComponentType.unknown,loggingId:t})},[])}function Sa(){const{assetId:e,buyCommitResponse:t}=Object(S.a)(z),{goToStep:n}=Object(I.j)(H),r=Oa(),o=function(){const e=Oa(),{formatMessage:t}=Object(i.a)(),[n]=Object(be.useMutation)(void 0!==va?va:va=a("NLgM"));return Object(l.useCallback)(({accountId:a,transferId:l,pares:r,onCompleted:o,onError:i})=>{e("three_ds_commit_start","c1204e13-cb71-4e9a-a4b8-2405f1a49bca"),n({variables:{input:{accountUuid:a,transferBuyUuid:l,redirectParams:r}},onCompleted:({response:e})=>{const t=Object(Re.a)(e.completeSecure3DBuy);switch(t.__typename){case"CompleteSecure3DBuySuccess":return o(t.transferBuy);case"GenericError":return Bugsnag.notify("Commit buy request failed",{metaData:{context:"use3dsBuyCompleter",apiError:t.message}}),i(t.message);default:Bugsnag.notify("Unexpected typename returned",{metaData:{context:"use3dsBuyCompleter",typename:t.__typename}})}},onError:()=>i(t(Le.a.commitError))})},[n,t,e])}(),{showErrorToast:s}=Object(Ke.a)(),c=Object(l.useCallback)(e=>{const a=Object(be.readInlineData)($e,e);return t.onChange(a),n("buyStatus")},[t,n]);return Object(l.useEffect)(()=>(r("three_ds_page_loaded","d20292fa-bc4d-4e50-a759-9218566f5ac9"),()=>Object(Xe.f)()),[]),Object(l.useEffect)(()=>{r("three_ds_verification_completed","6c5278f0-fdbf-4b03-867e-6884ced6c265");const t=Object(Xe.g)();if(!t)throw r("three_ds_local_storage_missing_data","c7f48f40-8408-4c3f-992b-2975ec0e32ef"),new Error("missing local3dsData");const{transferData:a,accountId:n,pares:l}=t;e.onChange(a.assetId),o({accountId:n,transferId:a.id,pares:l,onCompleted:c,onError:e=>s(e)})},[]),null}var ha=a("AaJB");const ka=Object(o.c)({backToOrderPreview:{id:"BuySellStepper.DisclosuresStep.backToOrderPreview",defaultMessage:"Back to order preview"}});var Ca,Ta,wa=function(){var e,t;const{formatMessage:a}=Object(i.a)(),{goBack:o}=Object(I.j)(H),{buyQuoteResponse:s}=Object(S.a)(z),c=(null!=(e=null===(t=s.value)||void 0===t?void 0:t.userWarnings)?e:[]).find(e=>"buy_trade_disclosure"===e.code);return Object(l.useEffect)(()=>{(null===c||void 0===c?void 0:c.context)||o()},[c]),(null===c||void 0===c?void 0:c.context)?r.a.createElement(r.a.Fragment,null,Object(n.a)(w.h,{goBack:o,title:c.context.title}),Object(n.a)(w.s,{paddingBottom:24,align:"flex-start"},void 0,Object(n.a)(ce.VStack,{flexGrow:1,flexShrink:1,flexBasis:"auto"},void 0,c.context.details.map(e=>Object(n.a)(Bt.a,{color:"light",paddingBottom:"md"},void 0,e))),Object(n.a)(ha.a,{fullWidth:!0,size:"xlarge",type:"light",onClick:o},void 0,a(ka.backToOrderPreview)))):null},Ba=a("Uih2"),Pa=a.n(Ba),Ma=a("GcVA"),Fa=a("5nVh"),Aa=a("dZHg"),Ia=a("Fc7c"),_a=a("6pIo"),xa=a("9/Bj"),Ea=a("9MOv"),Ra=a("d9pb"),La=a("vRDy");function Da(){const{showModal:e}=Object(Te.a)(),{amount:t,transferType:a}=Object(S.a)(z),r=ht(a.value);return Object(l.useCallback)(a=>{var l;switch(null===(l=a.apiError)||void 0===l?void 0:l.id){case"limit_error_increase_eligible":return t.onErrors([Object(n.a)(Ra.b,{errorText:a.message,eventNameOnView:Ra.d.viewBuyEntry,eventNameOnClick:Ra.d.clickBuyEntry})]);case"ach_buy_unavailable":return t.onErrors([r.achBuyDisabled]);case"personal_details_required":return e(Object(n.a)(La.a,{}));default:return t.onErrors([a.message])}},[t,r.achBuyDisabled,e])}function Ka(){const{amount:e,isFiatInput:t,recurringPeriod:n,transferType:r}=Object(S.a)(z),o=function(){const e=Da(),t=Object(be.useMutation)(void 0!==Ca?Ca:Ca=a("Zm4r")),n=Object(l.useCallback)(({createBuy:e})=>{const t=Object(Re.a)(e);switch(t.__typename){case"CreateBuySuccess":return{quoteAmounts:{fiatAmount:t.transferBuy.total.value,cryptoAmount:t.transferBuy.amount.value}};case"CreateBuyPartialError":return{quoteAmounts:{fiatAmount:t.transferBuy.total.value,cryptoAmount:t.transferBuy.amount.value},error:{id:t.error.code,message:t.error.message}};default:return Bugsnag.notify("Unexpected typename returned",{context:"useBuyQuoter",metaData:{typename:t.__typename}}),{}}},[]);return Object(Ea.a)({mutationHandler:t,parseResponse:n,onError:e})}(),i=function(){const e=Da(),t=Object(be.useMutation)(void 0!==Ta?Ta:Ta=a("0bS+")),n=Object(l.useCallback)(({createSell:e})=>{const t=Object(Re.a)(e);switch(t.__typename){case"CreateSellSuccess":return{quoteAmounts:{fiatAmount:t.transferSell.subtotal.value,cryptoAmount:t.transferSell.amount.value}};case"CreateSellPartialError":{const e={quoteAmounts:{fiatAmount:t.transferSell.subtotal.value,cryptoAmount:t.transferSell.amount.value}};switch(t.error.__typename){case"GenericError":case"CreateSellBadRequestError":e.error={id:t.error.code,message:t.error.message}}return e}default:return Bugsnag.notify("Unexpected typename returned",{context:"useSellQuoter",metaData:{typename:t.__typename}}),{}}},[]);return Object(Ea.a)({mutationHandler:t,parseResponse:n,onError:e})}(),s=Y(),c=ut(),u="buy"===r.value,d=Object(l.useMemo)(()=>u&&t.value?"total":"amount",[t.value,u]),b=Object(l.useCallback)((t=e.value)=>{const a=Object.assign({},c,{[d]:t});"buy"===r.value?o.fetchQuote({input:Object.assign({},a,{recurringPeriod:n.value,pmsvcId:s.pmsvcId})}):i.fetchQuote({input:a})},[d,e.value,o,n.value,i,c,r.value,s.pmsvcId]),p=Object(xa.a)(b,250);return Object(l.useMemo)(()=>{const e={fetchQuote:b,debouncedFetchQuote:p};return"buy"===r.value?Object.assign({},o,e):Object.assign({},i,e)},[o,p,i,r.value,b])}var Na,Ua=a("/4QY"),Va=a("tU0a"),Ha=a("avPW"),qa=a("NTCc");const za=void 0!==Na?Na:Na=a("/If1");var Wa;function Qa({rewards:e}){const{amount:t,transferType:r,buyQuoteResponse:o,sellQuoteResponse:s,activePaymentMethodId:c,buyInputParams:u,sellInputParams:d}=Object(S.a)(z),{goToStep:b}=Object(I.j)(H),{showModal:p}=Object(Te.a)(),{formatMessage:m}=Object(i.a)(),y=Object(qa.a)(),g=Object(Ha.a)(),f=Y(),v=xe(),O=J(),{submitBuy:h,isSubmittingBuy:k}=dt(),{submitSell:C,isSubmittingSell:T}=function(){const{formatMessage:e}=Object(i.a)(),[t,n]=Object(be.useMutation)(void 0!==Wa?Wa:Wa=a("tKeM")),r=ut(),o=Object(l.useCallback)(({variables:a,onSuccess:n,onError:l})=>{const o=Object.assign({},r,a);t({variables:{input:o},onCompleted:({response:e})=>{const t=Object(Re.a)(e.createSell);switch(t.__typename){case"CreateSellPartialError":return l(new Error(t.error.message));case"CreateSellSuccess":return n(t,o);default:Bugsnag.notify(t.__typename+" __typename received",{context:"useSellQuoteSubmitter"})}},onError:()=>l(new Error(e(st.b.genericError)))})},[t,e,r]);return Object(l.useMemo)(()=>({submitSell:o,isSubmittingSell:n}),[n,o])}(),w=Object(l.useCallback)(e=>{t.onErrors([null===e||void 0===e?void 0:e.message])},[t]),B=Object(P.c)({assetId:O.asset.uuid,isExperimental:O.asset.experimental}),M=Object(A.a)({rewards:e,assetUuid:O.asset.uuid}),F=Object(l.useCallback)((e,t)=>{s.onChange(Object(be.readInlineData)(za,e)),d.onChange(t),b("sellPreview")},[b,d,s]),_=Object(l.useCallback)((e,t)=>{o.onChange(Object(be.readInlineData)(bt,e)),u.onChange(t);b(B?"experimentalAssetConfirmation":"buyPreview")},[u,o,b,B]),x="buy"===r.value,E=Object(l.useCallback)(async e=>{try{const t=await g(e);t&&(c.onChange(t.id),b("entry"))}catch(t){w(t)}},[c,g,b,w]),R=Object(Va.a)({payPalPaymentMethod:f,onSignInComplete:E,onError:e=>w(e),onSubmit:j.a}),L=Object(l.useCallback)(async e=>{var t;if(M)return b("principalInsolvency");if(y&&v.paypalReauthRequired)return p(Object(n.a)(Ua.a,{}));if(f.rejected)return b("paymentError");const a="paypal_account"===f.type,l=null===f||void 0===f||null===(t=f.pickerData)||void 0===t?void 0:t.payoutOnly,r=new Error(m(st.b.genericError));x?(a&&l&&await R(),h({onSuccess:_,onError:()=>w(r),variables:e})):C({onSuccess:F,onError:()=>w(r),variables:e})},[M,y,v.paypalReauthRequired,f.rejected,f.type,null===f||void 0===f?void 0:f.pickerData,m,x,b,p,h,_,R,w,C,F]);return Object(l.useMemo)(()=>({submitQuote:L,isSubmitting:k||T}),[k,T,L])}var Ga=Object(o.c)({invalidInputWarning:{id:"BuySell.invalidInputWarning",defaultMessage:"Please enter a valid input amount."}}),Ya=a("8KiG"),Ja=a("Ptqz");const $a=Object(o.c)({neverTitle:{id:"BuySell.RecurrenceSelect.neverTitle",defaultMessage:"One time purchase"},dailyTitle:{id:"BuySell.RecurrenceSelect.dailyTitle",defaultMessage:"Daily"},dailyText:{id:"BuySell.RecurrenceSelect.dailyText",defaultMessage:"Every day starting today"},weeklyTitle:{id:"BuySell.RecurrenceSelect.weeklyTitle",defaultMessage:"Weekly"},weeklyText:{id:"BuySell.RecurrenceSelect.weeklyText",defaultMessage:"Every {weekday} starting today"},firstAndFifteenthTitle:{id:"BuySell.RecurrenceSelect.firstAndFifteenthTitle",defaultMessage:"1st and 15th of the month"},firstAndFifteenthText:{id:"BuySell.RecurrenceSelect.firstAndFifteenthText",defaultMessage:"Twice a month, including today"},monthlyTitle:{id:"BuySell.RecurrenceSelect.monthlyTitle",defaultMessage:"Monthly"},monthlyText:{id:"BuySell.RecurrenceSelect.monthlyText",defaultMessage:"Every month on the {dayOfMonth}"}}),Za={never:$a.neverTitle,daily:$a.dailyTitle,weekly:$a.weeklyTitle,first_and_fifteenth:$a.firstAndFifteenthTitle,monthly:$a.monthlyTitle},Xa={daily:$a.dailyText,weekly:$a.weeklyText,first_and_fifteenth:$a.firstAndFifteenthText,monthly:$a.monthlyText};var en=()=>{const{formatMessage:e}=Object(i.a)(),t=Object(l.useMemo)(()=>{const t=new Date;return{weekday:Object(Ja.a)(t.getDay(),e),dayOfMonth:Object(jt.a)(t.getDate(),e)}},[e]);return Object(l.useCallback)(a=>({title:e(Za[a]),text:Xa[a]?e(Xa[a],t):void 0}),[t,e])};function tn({onPressSell:e=j.a,disabled:t}){const{recurringPeriod:a,transferType:l}=Object(S.a)(z),{goToStep:r}=Object(I.j)(H),o=X(),i=en(),s=ht(l.value);return"sell"===l.value?Object(n.a)(Ya.a,{disabled:t,onPress:e,testID:"sell-all"},void 0,s.sellAll):o?Object(n.a)(Ya.a,{disabled:t,onPress:()=>r("recurringSelect"),endIcon:"caretDown",testID:"recurring-period"},void 0,i(a.value).title):null}var an=a("eSKr");const nn=Object(o.c)({customAmountButtonTitle:{id:"BuySellStepper.EntryStep.PresetAmountsPanel.customAmountButtonTitle",defaultMessage:"Custom"}}),ln=({amounts:e,onPressAmount:t,isSubmitting:a})=>{const[o,s]=Object(l.useState)(),{showPresetAmountsIfAvailable:c}=Object(S.a)(z),u=Object(i.a)(),d=Object(re.a)(),b=Object(vt.a)(),p=ht("buy"),m=Object(l.useCallback)(e=>{s(e),t(e)},[t]),y=Object(l.useMemo)(()=>Object(n.a)(oe.Button,{variant:"secondary",onPress:()=>c.onChange(!1),disabled:a},void 0,u.formatMessage(nn.customAmountButtonTitle)),[a,u,c]),g=Object(l.useMemo)(()=>{const t=e.map(e=>Object(n.a)(oe.Button,{variant:"secondary",disabled:a,loading:o===e,onPress:()=>m(e),testID:null!=e?e:"buy-preset-custom-amount-button"},e,d({amount:{amount:e,currency:b},isFiat:!0,exponent:0})));return 3===t.length?Object(n.a)(ie.VStack,{},void 0,Object(n.a)(rn,{},void 0,t),Object(n.a)(ie.Spacer,{vertical:2}),y):Object(n.a)(rn,{},void 0,[...t,y])},[e,y,d,m,a,b,o]);return r.a.createElement(r.a.Fragment,null,Object(n.a)(ie.VStack,{},void 0,Object(n.a)(ue.TextHeadline,{as:"label",align:"center"},void 0,p.buyAssetHeader),Object(n.a)(ie.Spacer,{vertical:1}),Object(n.a)(ie.VStack,{alignItems:"center"},void 0,Object(n.a)(tn,{disabled:a}),Object(n.a)(ie.Spacer,{vertical:2})),g),Object(n.a)(ie.Spacer,{vertical:2}))},rn=O.e.div.withConfig({displayName:"PresetAmountsPanel__ButtonGrid",componentId:"sc-3eb1y9-0"})(["display:grid;grid-gap:",";grid-template-columns:repeat(3,1fr);grid-auto-rows:auto;"],()=>an.a.size.large);var on=Object(l.memo)(ln);var sn=a("hqqT");const cn=Object(o.c)({buyPowerText:{id:"BuySellStepper.EntryStep.buyPowerText",defaultMessage:"You can buy up to {limit}"}}),un=Object(o.c)({previewButtonLabel:{id:"BuySellStepper.EntryStep.previewButtonLabel",defaultMessage:"Preview {type}"}}),dn=({children:e})=>(Object(s.useLogEventOnMount)("trading_ex_buy_power_viewed",{componentType:s.ComponentType.page,loggingId:"6f24c5b3-575a-4172-b72b-336a9c66d05b"}),r.a.createElement(r.a.Fragment,null,e)),bn=O.e.div.withConfig({displayName:"EntryStep__ButtonWrapper",componentId:"av3ius-0"})(["opacity:",";"],e=>e.faded?.5:1);var pn=Object(Ma.b)(({closeModal:e})=>{const{renderTabs:t}=Object(l.useContext)(d.b),a=Object(ee.a)(),{amount:o,isFiatInput:s,showPresetAmountsIfAvailable:c,transferType:u}=Object(S.a)(z),b=ht(u.value),p=J(),{assetBalance:m}=Ae(),y=$(),g=function(){const{goToStep:e}=Object(I.j)(H),{transferType:t}=Object(S.a)(z),{asset:a}=J(),{name:n,imageUrl:r}=a,o=ht(t.value);return Object(l.useMemo)(()=>({primaryLabel:o.selectAssetLabel,image:r,secondaryLabel:n,onPress:()=>e("selectAsset"),testID:t.value+"-asset-selector"}),[o.selectAssetLabel,r,n,t.value,e])}(),f=function(){const{goToStep:e}=Object(I.j)(H),{transferType:t}=Object(S.a)(z),a=$(),{rejected:r,isRevoked:o,disableBuyReason:i}=Y(),{label:s,icon:c}=xe(),u=ht(t.value),d=Object(l.useCallback)(()=>{a("tapped_select_payment_method"),e("selectPayment")},[a,e]),b=Object(l.useMemo)(()=>o||r?Object(n.a)(sn.Icon,{name:"error",color:r?"negative":"foreground",size:"s"}):null,[o,r]);return Object(l.useMemo)(()=>({icon:c,hasError:r,primaryLabel:u.selectPaymentLabel,secondaryLabel:s,pmDisabled:"wbl"===i,rightIcon:b,onPress:d,testID:t.value+"-payment-method-selector"}),[i,d,c,s,u.selectPaymentLabel,r,b,t.value])}(),v=Fe(),j=Object(Me.a)(),{formatMessage:O,formatNumber:h}=Object(i.a)(),k="buy"===u.value,B=Object(l.useMemo)(()=>k&&s.value?"total":"amount",[s.value,k]),{accounts:P,totalHoldBalance:M,rewards:F}=Object(C.a)({withRelay:!0}),A=Object(L.a)({accounts:P}),_=Object(R.a)({accounts:P,totalHoldBalance:M,totalNativeBalance:A}),x=Y(),E=_({paymentMethod:x,transferType:u.value}),D=Object(T.a)(null!=E?E:0),K=c.value&&!!D,N=a&&!!e,U=N,V=Object(l.useMemo)(()=>N&&e?e:void 0,[N,e]),q=""===o.value?b.defaultButton:b.previewButton,W=Boolean("sell"===u.value&&0===parseFloat(m.amount)),Q=x.currency,G=s.value?Q:p.asset.symbol,Z=s.value?p.asset.symbol:Q,{cancelQuote:X,fetchQuote:te,debouncedFetchQuote:ae,isFetching:le,fiatAmount:re,cryptoAmount:ie}=Ka(),{submitQuote:se,isSubmitting:ue}=Qa({rewards:F}),de=Object(Aa.b)({form:z,quoteFiatAmount:re,quoteCryptoAmount:ie});Object(l.useEffect)(()=>{o.onChange(o.value),W?o.onErrors([b.sellEmptyError]):parseFloat(o.value)&&te()},[]),Object(Fa.a)(()=>{o.errors[0]&&!W&&y("viewed_error",{error:o.errors[0]})},[o.errors]);const be=Object(l.useCallback)(()=>{y("tapped_switch"),de()},[de,y]),pe=Object(l.useCallback)(e=>{if(o.onChange(e),!parseFloat(e))return X();ae(e),y("viewed_updated_amount")},[o,X,ae,y]),me=Object(l.useCallback)(e=>{X(),se({total:e})},[X,se]),ye=Object(l.useCallback)(()=>{if(X(),!parseFloat(o.value))return o.onErrors([O(Ga.invalidInputWarning)]);se({[B]:o.value})},[o,X,se,B,O]),ge=Object(l.useCallback)(()=>{y("tapped_sell_all");const e=_({paymentMethod:x,transferType:"sell"});if(e){var t;const a=j({currency:v.currency.code,amount:v.balance.amount},Q),n=null===(t=Pa()(ne()([e,a])))||void 0===t?void 0:t.toString();se({amount:n,currency:Q})}else se({amount:m.amount,currency:m.currency})},[v.balance.amount,v.currency.code,x,m,j,Q,_,se,y]),fe=!!x.rejected||"wbl"===x.disableBuyReason,ve="buy"===u.value&&!o.value&&E,je="buy"===u.value?"BUY":"SELL";return r.a.createElement(r.a.Fragment,null,Object(n.a)(_a.a,{view:je,currencies:[p.asset.symbol]}),Object(n.a)(Ia.a,{view:je,currencies:[p.asset.symbol]}),t&&t(),U&&Object(n.a)(w.h,{goBack:V}),Object(n.a)(w.s,{paddingTopDesktop:w.q,paddingTopMobile:w.q},void 0,K&&D?Object(n.a)(on,{amounts:D,onPressAmount:me,isSubmitting:ue}):Object(n.a)(w.d,{autoFocus:!0,error:o.errors[0],input:{symbol:G,value:o.value,onChange:pe,onEnter:ye,readOnly:W||ue},helperText:ve?Object(n.a)(dn,{},void 0,O(cn.buyPowerText,{limit:h(E||0,{style:"currency",currency:Q})})):null,switchActiveInput:{onPress:be,inactiveSymbol:Z,disabled:le||ue},secondaryButton:Object(n.a)(tn,{onPressSell:ge,disabled:ue})}),Object(n.a)(ce.VStack,{},void 0,Object(n.a)(w.f,{noBottomPadding:K,row1:Object.assign({},g,{disableSelection:ue}),row2:Object.assign({},f,{disableSelection:ue})}),!K&&Object(n.a)(bn,{faded:fe},void 0,Object(n.a)(oe.Button,{block:!0,disabled:!!o.errors[0],loading:le||ue,onPress:ye,testID:u.value+"-preview-button","data-testid":u.value+"-preview-button","aria-label":O(un.previewButtonLabel,{type:u.value})},void 0,q)))),Object(n.a)(_e,{}))}),mn=a("iKd7"),yn=a("4roM");const gn=Object(o.c)({titleBuy:{id:"BuySellFeesInfo.titleBuy",defaultMessage:"Fees on crypto purchases"},titleSell:{id:"BuySellFeesInfo.titleSell",defaultMessage:"Fees on cryptocurrency sales"},content:{id:"BuySellFeesInfo.content",defaultMessage:"In addition to the displayed Coinbase fee, we include a spread in the price. Cryptocurrency markets are volatile, and this allows us to temporarily lock in a price for trade execution."},contentUSDC:{id:"BuySellFeesInfo.contentUSDC",defaultMessage:"Purchases and sales of USDC do not include an additional spread in the price."},learnMore:{id:"BuySellFeesInfo.learnMore",defaultMessage:"Learn more"},titleRecurring:{id:"BuySellFeesInfo.titleRecurring",defaultMessage:"Fees on Recurring Purchases"},contentRecurring:{id:"BuySellFeesInfo.contentRecurring",defaultMessage:"For recurring purchases, we calculate the Coinbase Fee at the time of each trade. In addition to the Coinbase fee, we include a spread in the exchange rate."},contentRecurringUSDC:{id:"BuySellFeesInfo.contentRecurringUSDC",defaultMessage:"For recurring purchases, we calculate the Coinbase Fee at the time of each trade."},contentAdvancedTrade:{id:"BuySellFeesInfo.contentAdvancedTrade",defaultMessage:"In addition to the displayed Coinbase fee, we include a spread in the price. When using Advanced Trade, no spread is included because you are interacting directly with the order book. Cryptocurrency markets are volatile, and this allows us to temporarily lock in a price for trade execution."},contentRecurringAdvancedTrade:{id:"BuySellFeesInfo.contentRecurringAdvancedTrade",defaultMessage:"For recurring purchases, we calculate the Coinbase Fee at the time of each trade. In addition to the Coinbase fee, we include a spread in the exchange rate. When using Advanced Trade, no spread is included because you are interacting directly with the order book."}}),fn=()=>{const{goBack:e}=Object(I.j)(H),{formatMessage:t}=Object(i.a)(),{asset:a}=J(),{symbol:r}=a,{recurringPeriod:o,transferType:s}=Object(S.a)(z),c="never"!==o.value,u="USDC"===r,d=Object(yn.a)(),b=Object(l.useMemo)(()=>{let e;return e=c?t(gn.titleRecurring):"buy"===s.value?t(gn.titleBuy):t(gn.titleSell),e},[t,c,s.value]),p=Object(l.useMemo)(()=>{let e;return e=t(c?u?gn.contentRecurringUSDC:d?gn.contentRecurringAdvancedTrade:gn.contentRecurring:u?gn.contentUSDC:d?gn.contentAdvancedTrade:gn.content),e},[t,d,c,u]),m=Object(l.useMemo)(()=>({title:b,message:p,cta:{url:"https://help.coinbase.com/en/coinbase/trading-and-funding/pricing-and-fees/fees",text:t(gn.learnMore)}}),[t,p,b]);return Object(n.a)(mn.a,{goBackHandler:e,content:m})};var vn=Object(l.memo)(fn),jn=a("/nOA");var On=Object(Ma.b)(()=>{const{goToStep:e}=Object(I.j)(H),{transferType:t,cardStatus:a}=Object(S.a)(z),{formattedPaymentMethods:r}=N(),o=xe(),i=$(),s=Object(Xt.a)(),c=Object(l.useMemo)(()=>"REJECTED"===a.value?"rejected":"DECLINED"===a.value?"declined":o.rejected?"rejected":"declined",[a,o.rejected]);Object(l.useEffect)(()=>()=>a.onChange(void 0),[]);const u=Object(l.useCallback)(()=>{s(),e("entry")},[e,s]),d=Object(l.useCallback)(()=>{i("tapped_select_payment_method"),e("selectPayment")},[e,i]),b=!a.value;return Object(n.a)(jn.b,{cardStatus:c,onAddAccountsSuccess:u,onAddAgainSuccess:b?u:void 0,onChangePaymentMethod:r.length>1?d:void 0,onGoBack:()=>e("entry"),paymentMethod:o,transferType:t.value})}),Sn=a("An2z"),hn=a("OUjm"),kn=a("QIsu"),Cn=a("5ezY");function Tn(){return(Tn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var wn=l.createElement("path",{d:"M20.429 22.143c6.114 0 11.071-4.957 11.071-11.072C31.5 4.957 26.543 0 20.429 0 14.314 0 9.357 4.957 9.357 11.071c0 6.115 4.957 11.072 11.072 11.072z",fill:"#F5B867"}),Bn=l.createElement("path",{d:"M.5 17.714C.5 11.46 5.704 6.421 11.959 6.643c6.034.221 10.684 5.314 10.684 11.348v10.795A6.643 6.643 0 0116 35.429h-3.321a3.321 3.321 0 01-3.322-3.322 3.321 3.321 0 00-3.321-3.321A2.22 2.22 0 013.82 26.57v-2.767a1.66 1.66 0 00-1.66-1.661A1.66 1.66 0 01.5 20.483v-2.769z",fill:"#56B4FC"}),Pn=l.createElement("path",{d:"M11.959 6.643a2.3 2.3 0 00-2.26 1.744c-.22.87-.342 1.777-.342 2.684 0 6.09 4.982 11.072 11.072 11.072 1.305 0 2.214-1.146 2.214-2.452v-1.7c0-6.034-4.65-11.127-10.684-11.348z",fill:"#1652F0"}),Mn=l.createElement("path",{d:"M15.333 12.155c.2-.659 1.133-.659 1.334 0a.697.697 0 00.464.464c.658.2.658 1.133 0 1.334a.697.697 0 00-.464.463c-.2.66-1.133.659-1.334 0a.697.697 0 00-.464-.463c-.658-.201-.658-1.134 0-1.334a.697.697 0 00.464-.464z",fill:"#fff"});a.p;const Fn=Object(o.c)({recurringBuysPromoText:{id:"RecurrenceSelectStep.PromoBanner.promoText",defaultMessage:"Save on all recurring buys! Get flat 1.49% fees until June 30, 2020."}}),An=()=>{const{formatMessage:e}=Object(i.a)();return Object(n.a)(In,{},void 0,Object(n.a)(_n,{}),Object(n.a)(le.a,{auto:!0,justify:"center"},void 0,Object(n.a)(Cn.a,{size:"tiny",weight:"demiBold"},void 0,e(Fn.recurringBuysPromoText))))},In=Object(O.e)(le.a).attrs(()=>({align:"center",justify:"space-between"})).withConfig({displayName:"PromoBanner__PromoContainer",componentId:"sc-1viqhnv-0"})(["padding:20px 10px 20px 17px;"]),_n=Object(O.e)((function(e){return l.createElement("svg",Tn({width:32,height:36,viewBox:"0 0 32 36",fill:"none"},e),wn,Bn,Pn,Mn)})).withConfig({displayName:"PromoBanner__PromoLogo",componentId:"sc-1viqhnv-1"})(["width:40px;margin-right:15px;"]);var xn=Object(l.memo)(An);const En=Object(o.c)({title:{id:"RecurrenceSelectStep.title",defaultMessage:"Repeat this purchase?"}}),Rn=()=>{const{formatMessage:e}=Object(i.a)(),{goBack:t}=Object(I.j)(H),{recurringPeriod:a}=Object(S.a)(z),r=Object(l.useCallback)(e=>{a.onChange(e),t()},[t,a]),o="treatment"===Object(pe.useVariant)(fe.a.mar_2020_recurring_buy_fee),s=en();return Object(n.a)(kn.h,{},void 0,Object(n.a)(hn.b,{goBack:t,title:e(En.title)}),Object(n.a)(Ln,{},void 0,["never","daily","weekly","first_and_fifteenth","monthly"].map(e=>{const t=e===a.value,l=s(e);return Object(n.a)(Sn.ListCell,{as:"li",selected:t,variant:"foregroundMuted",onPress:()=>r(e),title:l.title,description:l.text},e)}),o&&Object(n.a)(xn,{})))},Ln=Object(O.e)(kn.b).withConfig({displayName:"RecurrenceSelectStep__StyledInnerStepContent",componentId:"jep9gk-0"})(["padding:0 ",";"],e=>e.theme.size.medium);var Dn=Object(l.memo)(Rn),Kn=a("B05N");var Nn=Object(o.c)({title:{id:"RecurringRewardTermsStep.title",defaultMessage:"Terms and conditions"},termsAndConditions:{id:"RecurringRewardTermsStep.termsAndConditions",defaultMessage:"\u2022 To receive this reward, complete the required number of recurring crypto buys. Only one reward per invited customer. Not available for USD Coin buys or if Coinbase finds gaming or fraudulent activity.<br></br><br></br>\n    \u2022 Allow 5 days after your qualifying buy to receive reward, which will be paid in Bitcoin (BTC).<br></br><br></br>\n    \u2022 Coinbase may cancel this offer at anytime prior to you scheduling recurring buys."},understand:{id:"RecurringRewardTermsStep.understand",defaultMessage:"I understand"}});const Un=({onDone:e})=>{const{formatMessage:t}=Object(i.a)();return r.a.createElement(r.a.Fragment,null,Object(n.a)(Vn,{},void 0,Object(n.a)(Hn,{column:!0,auto:!0,align:"center"},void 0,Object(n.a)(Kn.a,{level:3,marginBottom:"lg"},void 0,t(Nn.title)),Object(n.a)(Bt.a,{color:"light",align:"left"},void 0,t(Nn.termsAndConditions,{br:()=>Object(n.a)("br",{})}))),Object(n.a)(qn,{column:!0,bottomPadded:!0},void 0,Object(n.a)(ha.a,{fullWidth:!0,type:"light",size:"xlarge",onClick:e},void 0,t(Nn.understand)))),Object(n.a)(_e,{}))},Vn=Object(O.e)(le.a).attrs(()=>({column:!0,auto:!0,justify:"space-between"})).withConfig({displayName:"RecurringRewardTermsStep__PaddedContent",componentId:"z9ix8s-0"})(["position:relative;flex:1;flex-shrink:0;padding:","px ","px 0 ","px;"],Kt.d,Kt.d,Kt.d),Hn=Object(O.e)(le.a).withConfig({displayName:"RecurringRewardTermsStep__TopContent",componentId:"z9ix8s-1"})(["text-align:center;"]),qn=Object(O.e)(le.a).withConfig({displayName:"RecurringRewardTermsStep__BottomContent",componentId:"z9ix8s-2"})(["",";padding-top:","px;"],e=>e.bottomPadded&&`padding-bottom: ${Kt.d}px`,Kt.d);var zn=Object(l.memo)(Un),Wn=a("dViE");function Qn(){const{goBack:e}=Object(I.j)(H),{transferType:t}=Object(S.a)(z),a=J(),r=function(){const{goToStep:e}=Object(I.j)(H),{assetId:t}=Object(S.a)(z),a=$(),n=J();return Object(l.useCallback)(l=>{l.id!==n.asset.uuid&&(a("tapped_asset"),t.onChange(l.id),a("modal_buy_currency_selected",{action:s.ActionType.click,componentType:s.ComponentType.dropdown,currency:l.symbol,context:"buyPage",loggingId:"9a36771d-3dd9-4b65-9378-efe7e448aed8"})),e("entry")},[t,e,n,a])}(),{tradableAssets:o}=N(),i=Y(),c=Object(je.a)("july_2021_web_filter_zero_balance","treatment"),u=Object(l.useMemo)(()=>o.map(({asset:e})=>e.uuid),[o]);return Object(n.a)(Wn.a,{onBack:e,assetIds:u,activeAssetId:a.asset.uuid,onAssetSelect:r,showBalance:"sell"===t.value,sortByBalance:"sell"===t.value,filterZeroBalance:c&&"sell"===t.value,targetFiatCurrency:i.currency,dataHandlePrefix:t.value})}var Gn=a("eIhP"),Yn=a("cqL8"),Jn=a("t9Cp"),$n=a("+Ppe");const Zn=Object(o.c)({title:{id:"BuyFedwireInstructions.title",defaultMessage:"Wire transfer"},description:{id:"BuyFedwireInstructions.description",defaultMessage:"Wire funds from your bank into Coinbase. Recommended for amounts greater than $25,000."}});function Xn({transferType:e}){const{formatMessage:t}=Object(i.a)(),{showModal:a}=Object(Te.a)(),r=Object(l.useCallback)(()=>{a(Object(n.a)($n.a,{entryPoint:e}))},[a,e]);return Object(n.a)(Sn.ContentCell,{as:"li",title:t(Zn.title),description:t(Zn.description),media:Object(n.a)(Jn.a,{"aria-hidden":"true"}),onPress:r})}var el=a("zBan");var tl=Object(o.c)({addPaymentMethod:{id:"SelectPaymentStep.addPaymentMethod",defaultMessage:"Add a payment method"},blocked:{id:"SelectPaymentStep.blocked",defaultMessage:"Blocked. <link>Add again</link>"},temporarilyDisabled:{id:"SelectPaymentStep.temporarilyDisabled",defaultMessage:"Temporarily disabled"}});function al(e){const{showModal:t}=Object(Te.a)(),{goToStep:a}=Object(I.j)(H),{formatMessage:r}=Object(i.a)(),o=function(){const{goToStep:e}=Object(I.j)(H),t=$(),{activePaymentMethodId:a}=Object(S.a)(z);return Object(l.useCallback)(n=>{a.value!==n&&(a.onChange(n),t("tapped_select_payment_method"),e("entry"))},[t,a,e])}(),s=Object(Xt.a)(),c=Object(at.a)(),u=Object(l.useCallback)(()=>{s(),c(),a("entry")},[s,c,a]);return Object(l.useMemo)(()=>e.rejected?{description:Object(n.a)(ue.TextBody,{as:"div",color:"negative"},void 0,r(tl.blocked,{link:e=>[e?Object(n.a)(ue.Link,{variant:"body"},void 0,e):null]})),onPress:()=>t(Object(n.a)(el.a,{type:e.type,reauthCardData:{last4:e.conciseDescription,paymentMethodId:e.id},onSuccess:u}))}:"wbl"===e.disableBuyReason?{description:Object(n.a)(ue.TextBody,{as:"div",color:"negative"},void 0,r(tl.temporarilyDisabled)),onPress:()=>o(e.id)}:{description:e.description,onPress:()=>o(e.id)},[o,r,u,e.conciseDescription,e.description,e.disableBuyReason,e.id,e.rejected,e.type,t])}function nl({paymentMethod:e}){const{activePaymentMethodId:t,transferType:a}=Object(S.a)(z),{description:r,onPress:o}=al(e),i=Object(l.useMemo)(()=>{const t=e.type.replace(/_/g,"-");return`${a.value}-select-${t}-${e.currency}`},[e.currency,e.type,a.value]);return Object(n.a)(Sn.ContentCell,{as:"li",title:e.label,meta:e.conciseDescription,description:r,onPress:o,selected:e.id===t.value,media:e.icon,testID:i,"data-testid":i})}var ll=a("xi+P");const rl=()=>{const{transferType:e}=Object(S.a)(z),t=ht(e.value),{goBack:a}=Object(I.j)(H),{isInUS:r}=Object(g.a)(),o=Object(Yn.b)(),{formattedPaymentMethods:s,allowedPaymentMethods:c}=N(),{isSupportedWithActiveCard:u}=Object(x.b)(),{isGooglePaySupportedWithActiveCard:d}=Object(E.a)(c),b=function(e){const{isInUS:t}=Object(g.a)(),a=Object(Xt.a)(),r=Object(at.a)(),{goToStep:o}=Object(I.j)(H),{transferType:s}=Object(S.a)(z),{showModal:c}=Object(Te.a)(),{formatMessage:u}=Object(i.a)(),d=Object(l.useMemo)(()=>{const a=e.find(e=>"EUR"===e.currency.code);return"sell"===s.value&&(a||t)},[e,t,s.value]),b=Object(l.useCallback)(()=>{a(),r(),o("entry")},[a,r,o]),p=Object(l.useCallback)(()=>{c(Object(n.a)(ll.a,{transferTypes:[s.value+"s"],onSuccess:b,entryPoint:s.value}))},[b,c,s.value]);return Object(l.useMemo)(()=>{if(!d)return{variant:"secondary",value:u(tl.addPaymentMethod),onPress:p,startIcon:"add"}},[u,p,d])}(o),p=Object(l.useMemo)(()=>s.filter(e=>"apple_pay"===e.type?u:"google_pay"!==e.type||d),[s,u,d]);return Object(n.a)(Gn.a,{header:{title:t.selectPaymentLabel,onPressBack:a},cta:b},void 0,p.map(e=>Object(n.a)(nl,{paymentMethod:e},e.id)),r&&"buy"===e.value&&Object(n.a)(Xn,{transferType:e.value}))};var ol,il=Object(l.memo)(rl);var sl=a("f7Z+");const cl=Object(o.c)({sellButton:{id:"BuySellStepper.PreviewStep.sellButton",defaultMessage:"Sell now"},sellActionLabel:{id:"BuySellStepper.PreviewStep.sellActionLabel",defaultMessage:"Sale"},sellTotalLabel:{id:"BuySellStepper.PreviewStep.sellTotalLabel",defaultMessage:"Total payout"},sellsUnsupportedText:{id:"BuySellStepper.PreviewStep.sellsUnsupportedText",defaultMessage:"Selling is not yet supported in your country. You will have to hold or send."},sellsUnsupportedLink:{id:"BuySellStepper.PreviewStep.sellsUnsupportedLink",defaultMessage:"Learn more."},donationLabel:{id:"BuySellStepper.PreviewStep.donationLabel",defaultMessage:"Donation (Paid by Coinbase)"},donationPercentageLabel:{id:"BuySellStepper.PreviewStep.donationPercentageLabel",defaultMessage:"Add a 1% donation"},donationToLabel:{id:"BuySellStepper.PreviewStep.donationToLabel",defaultMessage:"Donate {donationValue} to {toLink}, our nonprofit that distributes crypto to people in need."}}),ul=()=>{var e,t;const a=Object(i.a)(),{formatMessage:l}=a,r=Object(re.a)(),o=J(),{sellQuoteResponse:s}=Object(S.a)(z),c=ht("sell"),u=null===(e=s.value)||void 0===e?void 0:e.transferSell;G()(u,"There should be a sell quote response");const d=xe(),{subtotal:b,amount:p,total:m,unitPrice:y}=u,g=r({amount:p,isFiat:!1}),f=r({amount:m,isFiat:!0}),v=r({amount:y.amount,isFiat:!0,exponent:Object(ft.a)(parseFloat(y.amount.value))}),j={value:""+.01*Number(null!=(t=null===b||void 0===b?void 0:b.value)?t:0),currency:b.currency},O=r({amount:j,isFiat:!0});return{header:l(kt.previewHeader),cryptoAmount:g,paymentLabel:c.selectPaymentLabel,paymentValue:d.label,priceLabel:l(kt.priceLabel),priceValue:`${v} / ${o.asset.symbol}`,priceValueShort:""+v,actionLabel:l(cl.sellActionLabel),actionValue:r({amount:b,isFiat:!0}),totalLabel:l(cl.sellTotalLabel),totalValue:f,button:l(cl.sellButton),sellsUnsupportedText:l(cl.sellsUnsupportedText),sellsUnsupportedLink:l(cl.sellsUnsupportedLink),free:l(kt.free),seeMore:l(kt.seeMore),donationLabel:l(cl.donationLabel),donationValue:O,donationPercentageLabel:l(cl.donationPercentageLabel),donationToLabel:l(cl.donationToLabel,{donationValue:O,toLink:Object(n.a)(sl.Link,{to:B.b,openInNewWindow:!0},void 0,B.a)}),donationAmount:j}};var dl;const bl=["sells_unsupported"],pl=Object(O.e)(le.a).attrs(()=>({align:"center"})).withConfig({displayName:"SellPreviewStep__PromoContainer",componentId:"j16d76-0"})([""]),ml=O.e.div.withConfig({displayName:"SellPreviewStep__PromoAmount",componentId:"j16d76-1"})(["color:",";margin-right:8px;"],({theme:e})=>e.color.textAccent),yl=Object(O.e)(ye.a).withConfig({displayName:"SellPreviewStep__StrikedFormattedAmount",componentId:"j16d76-2"})(["text-decoration:line-through;"]);var gl,fl=()=>{var e,t,o,c;const u=xe(),{goToStep:d,goBack:b}=Object(I.j)(H),{sellQuoteResponse:p,sellInputParams:m,isFiatInput:y,transferType:f,donationAmount:v}=Object(S.a)(z),{subscriptionStatus:j}=N(),O=Object(ve.b)(j),{isInJapan:h,isInSingapore:k}=Object(g.a)(),C=Object(re.a)(),{requiredContentRef:T,footerRef:P,totalHeight:M}=Nt(),F=null===(e=p.value)||void 0===e?void 0:e.transferSell,A=null!=(t=null===(o=p.value)||void 0===o?void 0:o.userWarnings)?t:[];G()(F,"There should be a sell quote response");const{commitSell:_,isCommitting:x}=function(){var e;const{showErrorToast:t}=Object(Ke.a)(),{sellQuoteResponse:n,sellCommitResponse:r}=Object(S.a)(z),{goToStep:o}=Object(I.j)(H),s=Fe(),{formatMessage:c}=Object(i.a)(),u=null===(e=n.value)||void 0===e?void 0:e.transferSell.uuid;G()(u,"There should be a sell quote id");const[d,b]=Object(be.useMutation)(void 0!==ol?ol:ol=a("JdeL"));return{commitSell:Object(l.useCallback)(()=>{d({variables:{input:{accountUuid:s.id,transferSellUuid:u}},onCompleted:({response:e})=>{const a=Object(Re.a)(null===e||void 0===e?void 0:e.commitSell);switch(a.__typename){case"CommitSellSuccess":r.onChange(a.transferSell),o("sellStatus");break;case"GenericError":return Bugsnag.notify("Commit sell request failed",{metaData:{context:"useSellCommitter",apiError:a.message}}),t(a.message);default:Bugsnag.notify("Unexpected typename returned",{context:"useSellCommitter",metaData:{typename:a.__typename}})}},onError:()=>{t(c(Le.a.commitError))}})},[d,s.id,u,r,o,t,c]),isCommitting:b}}(),{formatMessage:E}=Object(i.a)(),R=Object(ee.a)(),L=$(),D=ul(),K="treatment"===Object(pe.useVariant)(fe.a.sep_2021_web_buy_sell_live_quotes);G()(m.value,"sell input params should be set");const{stopPolling:U,isSignificantChange:V}=((e,t,n)=>{const[r]=Object(be.useMutation)(void 0!==dl?dl:dl=a("IBLe")),o=Object(l.useRef)(),{startTimeout:i,stopTimeout:s}=Object(Vt.a)(),{sellQuoteResponse:c}=Object(S.a)(z),u=Object(l.useRef)(n),[d,b]=Object(l.useState)(!1),p=Object(l.useCallback)(e=>{const t=Object(be.readInlineData)(za,e);c.onChange(t),parseFloat(t.transferSell.unitPrice.amount.value)/parseFloat(u.current)<.98&&b(!0)},[c]),m=Object(l.useCallback)(()=>r({variables:{input:e},onCompleted:({response:e})=>{const t=Object(Re.a)(e.createSell);switch(t.__typename){case"CreateSellSuccess":return p(t),void i(()=>{o.current=m()},8e3);default:Bugsnag.notify("Sell quote refresh failed",{context:"useRefreshSellQuote"})}},onError:()=>{Bugsnag.notify("Sell quote refresh failed",{context:"useRefreshSellQuote"})}}),[r,e,p,i]),y=Object(l.useCallback)(()=>{var e;null===(e=o.current)||void 0===e||e.dispose(),s()},[s]);return Object(l.useEffect)(()=>(t&&i(()=>{o.current=m()},8e3),()=>{y()}),[t]),{stopPolling:y,isSignificantChange:d}})(m.value,K,F.unitPrice.amount.value),{showModal:q}=Object(Oe.a)();Object(l.useEffect)(()=>{V&&q(Object(n.a)(Ht.a,{asset:F.amount.currency,displayInputCurrency:F.total.currency,onConfirm:U,onBack:b,type:y?"fiat":"crypto"}))},[V]);const{showDonationFeature:W,includeDonation:Q,setIncludeDonation:Y,trackIncludeDonationClick:J}=function({transferType:e}){const[t,a]=Object(l.useState)(!1);return{showDonationFeature:Object(je.a)("dec_2021_sell_flow_donation","treatment")&&"sell"===e,includeDonation:t,setIncludeDonation:a,trackIncludeDonationClick:Object(s.useEventLogger)("sell_flow_include_donation",{loggingId:"c97485f5-1820-47a3-aed5-3f4e7bc9f300",action:s.ActionType.click,componentType:s.ComponentType.button})}}({transferType:f.value}),Z=Object(l.useCallback)(async()=>{Q&&(v.onChange(D.donationAmount),J(Object.assign({},D.donationAmount))),L("tapped_confirm_button"),U(),_()},[L,J,_,U,Q,D.donationAmount,v]),X=Object(w.K)(),te=Object(je.a)("june_2021_web_buy_preview_modal","treatment"),ae=Object(je.a)("dec_2021_web_streamline_trade_preview","treatment"),le="tapped_buy_fee_explanation_button",de=Object(l.useCallback)(()=>{L(le)},[L,le]),me=Object(l.useCallback)(()=>{de(),X&&d("feesInfo")},[de,X,d]),ye=F.fee,he=F.defaultFee;Object(l.useEffect)(()=>{L("viewed_preview")},[]);const ke=(Ce="sells_unsupported",A.find(e=>e.code===Ce)?Object(n.a)(w.t,{text:D.sellsUnsupportedText,link:{text:D.sellsUnsupportedLink,url:w.m}}):null);var Ce;const Te=A.filter(e=>!bl.includes(e.code)).map(e=>Object(n.a)(w.t,{text:e.message})),we=Object(n.a)(w.h,{goBack:x?void 0:b,title:D.header}),Be=Boolean(ye&&he&&ye.value!==he.value),Pe=D.actionLabel,Me=()=>ye?he&&Be?Object(n.a)(pl,{},void 0,Object(n.a)(ml,{},void 0,0===parseFloat(null===ye||void 0===ye?void 0:ye.value)?D.free:C({amount:ye,isFiat:!0})),r.a.createElement(yl,Object.assign({},he,{amount:he.value}))):O?Object(n.a)(se.HStack,{gap:1,alignItems:"center"},void 0,O&&Object(n.a)(Se.a,{height:16,type:"badge"}),D.free):C({amount:ye,isFiat:!0}):null,Ae=Object(n.a)(w.A,{label:D.paymentLabel,rightContent:D.paymentValue,rightIcon:u.icon}),Ie=Object(n.a)(w.A,{label:D.priceLabel,rightContent:D.priceValue}),Ee=r.a.createElement(r.a.Fragment,null,Object(n.a)(w.I,{text:D.cryptoAmount,useTicker:K}),Object(n.a)(w.F,{size:"enormous"}),Ae,Ie,Object(n.a)(w.A,{label:Pe,rightContent:D.actionValue}),Object(n.a)(w.w,{includesTaxes:k,hasPromo:Be,rightContent:Me(),onClick:me,feeLink:h?w.k:w.l}),Q&&Object(n.a)(B.e,{label:D.donationLabel,rightContent:D.donationValue}),Object(n.a)(w.A,{label:D.totalLabel,rightContent:D.totalValue,isLastRow:!0})),De=r.a.createElement(r.a.Fragment,null,Object(n.a)(w.I,{text:D.cryptoAmount,useTicker:K}),Object(n.a)(ue.TextLabel2,{as:"p",align:"start",spacingTop:.5},void 0,D.priceValue),Object(n.a)(ie.Spacer,{vertical:3}),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%",spacingTop:1},void 0,Object(n.a)(w.A,{label:Pe,rightContent:D.actionValue})),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,Object(n.a)(w.w,{includesTaxes:k,hasPromo:Be,rightContent:Me(),onClick:me,feeLink:h?w.k:w.l})),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,Object(n.a)(w.A,{label:D.totalLabel,rightContent:D.totalValue})),Object(n.a)(ie.Box,{spacingBottom:1,width:"100%"},void 0,Ae)),Ne=((e=[])=>{const t=r.a.Children.toArray(ne()(e));return t.length>0?t:null})([ke,...Te]),Ue=Object(n.a)(w.C,{},void 0,Object(n.a)(w.B,{},void 0,we,Object(n.a)(w.i,{},void 0,ae?De:Ee),Object(n.a)(w.F,{size:"medium"}),W&&r.a.createElement(r.a.Fragment,null,Object(n.a)(w.i,{},void 0,Object(n.a)(B.c,{percentageLabel:D.donationPercentageLabel,donateToLabel:D.donationToLabel,includeDonation:Q,setIncludeDonation:Y})),Object(n.a)(w.F,{size:"large"})),Ne&&Object(n.a)(w.v,{},void 0,Ne)),Object(n.a)(w.B,{},void 0,Object(n.a)(w.i,{},void 0,Object(n.a)(oe.Button,{block:!0,loading:x,onPress:Z,disabled:x||(null===(c=F.paymentMethod)||void 0===c?void 0:c.rejected),testID:"sell-confirm-button","data-testid":"sell-confirm-button"},void 0,D.button)),ae?Object(n.a)(w.F,{size:"enormous"}):Object(n.a)(_e,{}))),Ve=Object(n.a)(w.C,{isMobile:R,isExperiment:!0,totalRequiredHeight:M},void 0,we,Object(n.a)(ge.b,{noTopPadding:!0,noHorizontalPadding:!0,noBottomPadding:!0},void 0,Object(n.a)(w.B,{},void 0,r.a.createElement(ce.VStack,{ref:T,key:"requiredContentRef"},Object(n.a)(w.i,{},void 0,ae?De:Ee)),Object(n.a)(w.F,{size:"medium"}),Ne&&Object(n.a)(w.v,{},void 0,Ne))),r.a.createElement(ge.i,{hasFooter:!0,noPaddingHorizontal:!0,ref:P,key:"footerRef"},Object(n.a)(w.i,{},void 0,Object(n.a)(oe.Button,{block:!0,loading:x,onPress:Z,disabled:x||(null===u||void 0===u?void 0:u.rejected),testID:"sell-confirm-button","data-testid":"sell-confirm-button","aria-label":E(cl.sellButton)},void 0,D.button)),ae?Object(n.a)(w.F,{size:"enormous"}):Object(n.a)(_e,{})));return te?Ve:Ue};function vl({closeModal:e,onComplete:t,onViewDonation:r,showStatusHeaderClose:o}){var i,s;const c=Object(Ee.h)(),u=Object(ee.a)(),{goToStep:d}=Object(I.j)(H),b=J(),p=Fe(),m=Object(re.a)(),y=$(),g=Object(aa.a)(),{subscriptionStatus:f}=N(),v=Object(ve.b)(f),{eventContext:j,tradeComplete:O,sellCommitResponse:h,sellQuoteResponse:k,transferType:C}=Object(S.a)(z),T=h.value,B=null===(i=k.value)||void 0===i||null===(s=i.transferSell)||void 0===s?void 0:s.feeWithoutSubscriptionBenefit;G()(T,"There should be a commit response");const P=function(e){const[t,n]=Object(l.useState)(),r=Object(nt.a)(),o=Object(lt.a)(),i=Fe(),s=Object(l.useCallback)(()=>{r({maxPollAttempts:6,resource:async()=>o(void 0!==gl?gl:gl=a("DAgE"),{transferId:e,accountId:i.id}),onResponse:e=>{var t,a,n;switch(null===(t=e.viewer.accountByUuid)||void 0===t||null===(a=t.sellByUuid)||void 0===a||null===(n=a.accountHistory)||void 0===n?void 0:n.status){case"COMPLETED":return{type:"Result",result:"completed"};case"FAILED":case"EXPIRED":case"CANCELED":return{type:"Result",result:"canceled"};default:return{type:"ContinuePolling"}}},onComplete:e=>{switch(e.type){case"Success":n(e.result);break;case"MaxRetries":n("created");break;default:n("canceled")}}})},[i.id,o,r,e]);return Object(l.useEffect)(()=>{s()},[]),t}(T.uuid),M=ta(),F=Object(l.useCallback)(e=>{O.onChange(!0),"success"===e&&M()},[O,M]),A=Object(l.useCallback)(()=>{e&&e()},[e]),_=Object(l.useCallback)(()=>{const t=b.asset.slug;u&&"assetPage"===j.value&&t?c.push(Object(Zt.c)(t)):(e&&e(),d("entry"))},[b.asset,u,j.value,c,e,d]),x=Object(l.useMemo)(()=>g?Object(n.a)(ua.a,{closeModal:e,isSubscribed:v,feeWithoutSubscriptionBenefitValue:null===B||void 0===B?void 0:B.value,feeWithoutSubscriptionBenefitCurrency:null===B||void 0===B?void 0:B.currency}):null,[g,e,v,B]),E=Object(l.useMemo)(()=>({status:P,type:C.value,sourceAmount:m({amount:T.amount,isFiat:!1}),targetCurrency:T.amount.currency,accountId:p.id,isCommitting:!1}),[p.id,m,T.amount,P,C.value]);return Object(n.a)(w.G,{tradeData:E,onComplete:t,onRetry:()=>d("entry"),onViewTransaction:A,onClose:_,onAnimationEnd:F,onViewDonation:r,trackEvent:y,footer:Object(n.a)(_e,{}),banner:x,showStatusHeaderClose:o})}var jl=Object(l.memo)(vl),Ol=a("n+nn"),Sl=a("eweW");const hl=Object(o.c)({ackButton:{id:"WBLStep.ackButton",defaultMessage:"Got it"}});var kl=Object(Ma.b)(({onComplete:e})=>{const{formatMessage:t}=Object(i.a)(),{buyCommitResponse:a}=Object(S.a)(z),r=Fe(),o=Object(te.h)(),s=a.value;G()(s,"Commit data should be defined");const c=Object(l.useCallback)(()=>{o&&o()},[o]),u=!!s.commitNotice,d=Object(l.useMemo)(()=>u?(G()(s.commitNotice,"instant ach data should be present"),{header:s.commitNotice.title,body:s.commitNotice.description}):(G()(s.wblUxData,"wbl data should be present"),{header:s.wblUxData.title,body:s.wblUxData.description}),[u,s.commitNotice,s.wblUxData]),b=Object(l.useMemo)(()=>{if(u)return Object(n.a)(oe.Button,{block:!0,variant:"secondary",onPress:o},void 0,t(hl.ackButton));const a={type:"buy",accountId:r.id};return Object(n.a)(Ol.a,{buttonType:"success",tradeData:a,onViewTransaction:c,onComplete:e})},[u,r.id,c,e,o,t]);return Object(n.a)(Sl.a,{heroName:u?"sendCryptoFaster":"tradeImmediately",content:d,ctas:b,footer:Object(n.a)(_e,{})})}),Cl=a("f8zI"),Tl=a.n(Cl),wl=a("j6ZD"),Bl=a.n(wl),Pl=a("As4l"),Ml=a.n(Pl);const Fl=Object(o.c)({header:{id:"AddPaymentPolicyRestriction.header",defaultMessage:"You're almost ready to buy. Please complete your account."},body:{id:"AddPaymentPolicyRestriction.body",defaultMessage:"To make an investment, please add a payment method."},addPaymentMethod:{id:"AddPaymentPolicyRestriction.addPaymentMethod",defaultMessage:"Add a Payment Method"}}),Al=({isVisible:e=!0,closeModal:t,onComplete:a,openRecurrence:r,recurringPeriod:o,initialInputAmount:i,showStatusHeaderClose:s=!0,recurringTransactions:c,rewards:u,buySellStepperQueryData:d})=>{const{currentStep:b,goToStep:p,goBack:m,replaceStep:y}=Object(I.j)(H),{amount:g,recurringPeriod:f,tradeComplete:v,donationAmount:j}=Object(S.a)(z),O=X(),{allowedPaymentMethods:k}=N(),C=$(),T=J(),M=!!j.value;Object(E.a)(k);const _=Object(A.a)({rewards:u,assetUuid:T.asset.uuid}),R=Object(l.useCallback)(()=>{p("entry")},[p]);Object(l.useEffect)(()=>{r&&O&&f.onChange(null!=o?o:"monthly")},[]),Object(l.useEffect)(()=>{i&&g.onChange(i)},[]),Object(l.useEffect)(()=>{e&&C("viewed")},[e]);const L=Object(l.useCallback)(()=>{("buyStatus"!==b||v.value)&&("buyStatus"===b&&v.value&&(v.onChange(!1),f.onChange("never")),p("entry"),C("tapped_close"))},[b,p,f,C,v]),D=function(){const{currentStep:e}=Object(I.j)(H),t=Object(te.j)(),a=Object(ee.a)();return Object(l.useMemo)(()=>"entry"!==e&&!t&&!a,[e,a,t])}(),K=Object(l.useCallback)(()=>{y("buyPreview")},[y]),U=Object(l.useCallback)(()=>{p("donationConfirmation")},[p]);return Object(n.a)(x.a,{paymentMethods:k},void 0,Object(n.a)(h.a,{show:D,onClick:L}),Object(n.a)(xl,{showOverlay:D},void 0,Object(n.a)(H.Steps,{},void 0,Object(n.a)(w.H,{},"entry",Object(n.a)(pn,{closeModal:t})),Object(n.a)(w.H,{},"principalInsolvency",Object(n.a)(F.a,{assetRewardPrincipalInsolvency:_,handleGoBack:R})),Object(n.a)(w.H,{},"recurringSelect",Object(n.a)(Dn,{})),Object(n.a)(w.H,{},"paymentError",Object(n.a)(On,{})),Object(n.a)(w.H,{},"buyPreview",Object(n.a)($t,{recurringTransactions:c})),Object(n.a)(w.H,{},"sellPreview",Object(n.a)(fl,{})),Object(n.a)(w.H,{},"buyDisclosures",Object(n.a)(wa,{})),Object(n.a)(w.H,{},"selectPayment",Object(n.a)(il,{})),Object(n.a)(w.H,{},"selectAsset",Object(n.a)(Qn,{})),Object(n.a)(w.H,{},"buyStatus",Object(n.a)(ja,{closeModal:t,onComplete:a,showStatusHeaderClose:s,fragmentRef:d})),Object(n.a)(w.H,{},"sellStatus",Object(n.a)(jl,{closeModal:t,onComplete:a,onViewDonation:M?U:void 0,showStatusHeaderClose:s})),Object(n.a)(w.H,{},"wbl",Object(n.a)(kl,{onComplete:a})),Object(n.a)(w.H,{},"donationConfirmation",Object(n.a)(B.d,{donationAmount:j.value,onClose:t})),Object(n.a)(w.H,{},"experimentalAssetConfirmation",Object(n.a)(P.a,{onBack:m,assetId:T.asset.uuid,onContinue:K})),Object(n.a)(w.H,{},"recurringRewardTerms",Object(n.a)(zn,{onDone:m})),Object(n.a)(w.H,{},"feesInfo",Object(n.a)(vn,{})),Object(n.a)(w.H,{},"confirm3ds",Object(n.a)(Sa,{})))))};function Il(e){var t;let{eventContext:a,transferType:o="buy",assetId:s,confirm3ds:c=!1}=e,u=Object(f.a)(e,["eventContext","transferType","assetId","confirm3ds"]);const{accounts:b,tradableAssets:p,paymentMethods:m,recurringTransactions:y,totalHoldBalance:g,rewards:v,subscriptionStatus:O,buySellStepperQueryData:S}=Object(C.a)({withRelay:!0}),h=Object(l.useMemo)(()=>{const e=p.find(({asset:e})=>e.uuid===s);return e||(Bugsnag.notify("Failed to find initial asset in tradableAssets",{metaData:{context:o,assetId:s}}),p[0])},[s,p,o]),w=Object(l.useMemo)(()=>function(e,t){const a=e.filter(e=>e["allow"+Tl()(t)]&&e.verified);return Ml()(a,e=>Object.keys(e.limits).includes(t)?-Bl()(e.limits[t][0].remaining.amount):0)}(m,o),[m,o]),B=Object(L.a)({accounts:b}),P=function({paymentMethods:e,accounts:t,totalHoldBalance:a,totalNativeBalance:n,transferType:r}){const o=Object(i.a)(),s=Object(R.a)({accounts:t,totalHoldBalance:a,totalNativeBalance:n});return Object(l.useMemo)(()=>e.map(e=>Object(Z.a)({accounts:t,intl:o,transferType:r,limit:s({paymentMethod:e,transferType:r}),paymentMethod:e})),[e,t,o,r,s])}({paymentMethods:w,accounts:b,totalHoldBalance:g,totalNativeBalance:B,transferType:o}),M=Object(R.a)({accounts:b,totalHoldBalance:g,totalNativeBalance:B}),F=null!=(t=w.find(e=>"buy"===o?e.primaryBuy:e.primarySell))?t:w[0],A=F?M({paymentMethod:F,transferType:o}):0,I=Object(T.a)(null!=A?A:0),x=Object(l.useMemo)(()=>Object.assign({},q,{eventContext:a,transferType:o,assetId:h.asset.uuid,activePaymentMethodId:null===F||void 0===F?void 0:F.id,showPresetAmountsIfAvailable:"buy"===o&&!!I}),[a,o,h.asset.uuid,null===F||void 0===F?void 0:F.id,I]),{formatMessage:E}=Object(i.a)(),{renderTabs:D}=Object(l.useContext)(d.b),K=Object(_.a)();if(!F){const e={id:"payment_method_required",message:E(Fl.header),description:E(Fl.body),restrictionUrl:{link:"/settings/linked-accounts",text:E(Fl.addPaymentMethod)},action:"buys",error:void 0,userType:void 0,pendingPaymentMethod:void 0,pending:!1,pk:()=>""},t=o+"s";return r.a.createElement(r.a.Fragment,null,D&&D(),Object(n.a)(k.a,{isWidget:!0,transferType:t,policyRestriction:e,title:e.message,description:e.description,onSuccess:()=>K({type:t})}))}return Object(n.a)(U,{accounts:b,tradableAssets:p,allowedPaymentMethods:w,formattedPaymentMethods:P,subscriptionStatus:O},void 0,Object(n.a)(z.Provider,{onSubmit:j.a,initialValues:x},void 0,Object(n.a)(H.Provider,{defaultStep:c?"confirm3ds":"entry"},void 0,r.a.createElement(Al,Object.assign({},u,{accounts:b,tradableAssets:p,paymentMethods:m,recurringTransactions:y,buySellStepperQueryData:S,totalHoldBalance:g,rewards:v})))))}function _l(e){return Object(n.a)(c.a,{},void 0,Object(n.a)(M.a,{action:e.transferType+"s"},void 0,r.a.createElement(Il,Object.assign({},e))))}const xl=O.e.div.withConfig({displayName:"BuySellStepper__Container",componentId:"ngrzfu-0"})(["display:flex;flex:1;z-index:",";transition:z-index ",";"],e=>e.showOverlay?e.theme.zIndex.overlay:e.theme.zIndex.normal,e=>e.showOverlay?"0ms":"0ms ease-out 1000ms");var El=Object(l.memo)(_l),Rl=a("AYb+"),Ll=a("Cejn");const Dl=Object(o.c)({buy:{id:"BuySell.buy",defaultMessage:"Buy"},sell:{id:"BuySell.sell",defaultMessage:"Sell"},convert:{id:"BuySell.convert",defaultMessage:"Convert"}}),Kl=({closeModal:e,onComplete:t,assetId:a="",assetCode:r,convertTargetAssetId:o="",convertTargetAssetIds:c,initialActiveTab:f="buy",eventContext:v="assetPage",openRecurrence:j,recurringPeriod:O,initialInputAmount:S,confirm3ds:h})=>{const{formatMessage:k}=Object(i.a)(),T=Object(y.a)("nov_2021_web_buy_sell_graphql_v2","treatment"),{holdableAssets:w,convertibleAssets:B,tradableAssets:P}=Object(C.a)({withRelay:T}),M=function({asset:e,tradableAssets:t,convertibleAssets:a}){var n;const l=Object(p.a)(null===e||void 0===e?void 0:e.id),r=Object(b.a)(null===e||void 0===e?void 0:e.id);if(l||r)return e;return null!=(n=t[0])?n:a[0]}({asset:Object(Ll.a)({assetId:a,assetCode:r,holdableAssets:w}),tradableAssets:P,convertibleAssets:B}),F=Object(m.a)(null===M||void 0===M?void 0:M.id),[A,I]=Object(l.useState)(f),{isCryptoOnlyTrader:_}=Object(g.a)();Object(s.useLogEventOnMount)("trade_modal",{action:s.ActionType.render,componentType:s.ComponentType.modal,loggingId:"477ab1fa-d14f-4959-b7f6-821898516009",platform:"web",page:null!=v?v:""}),Object(l.useEffect)(()=>{F.length>0&&!F.includes(A)&&I(F[0])},[F,A,I]);const x=Object(l.useCallback)(e=>{I(e)},[]),E=Object(y.a)("nov_2021_web_buy_sell_graphql_v2","treatment"),R=l=>{const r=A===l;return M?Object(n.a)(d.a,{value:l,label:k(Dl[l])},void 0,["buy","sell"].includes(l)&&(E?Object(n.a)(El,{transferType:l,isVisible:r,closeModal:e,onComplete:t,eventContext:v,assetId:a||M.id,openRecurrence:j,recurringPeriod:O,initialInputAmount:S,confirm3ds:h}):Object(n.a)(Rl.a,{transferType:l,isVisible:r,closeModal:e,onComplete:t,eventContext:v,assetCode:M.symbol,openRecurrence:j,recurringPeriod:O,initialInputAmount:S})),"convert"===l&&Object(n.a)(u.a,{sourceAssetId:M.id,targetAssetId:o,targetAssetIds:c,isVisible:r,eventContext:v,closeModal:e})):null};return A&&M?0===F.length?null:Object(n.a)(d.c,{onClickTab:x,activeTab:A,hideTabs:_},M.id,F.includes("buy")&&R("buy"),F.includes("sell")&&R("sell"),F.includes("convert")&&R("convert")):null};function Nl(e){return Object(n.a)(c.a,{},void 0,r.a.createElement(Kl,Object.assign({},e)))}t.default=Object(l.memo)(Nl)},"qlI+":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return c}));const n="SECURE3D_ACCOUNT_ID",l="SECURE3D_TRANSFER_DATA",r="SECURE3D_PAYMENT_METHOD_ID",o="SECURE3D_ORIGIN_ROUTE",i="SECURE3D_PARES",s=()=>{const e=localStorage.getItem(n),t=localStorage.getItem(l),a=localStorage.getItem(r),o=localStorage.getItem(i);if(e&&t&&a&&o)return{accountId:e,transferData:JSON.parse(t),paymentMethodId:a,pares:o};Bugsnag.notify("Missing secure3d data",{metaData:{context:"3dsFailure",localstorage:{keys:Object.keys(localStorage),accountId:e,transferData:t,paymentMethodId:a,pares:o}}})},c=()=>{localStorage.removeItem(n),localStorage.removeItem(l),localStorage.removeItem(r),localStorage.removeItem(i),localStorage.removeItem(o)}},tKeM:function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},l],o={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:r,storageKey:null},i={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"subtotal",plural:!1,selections:r,storageKey:null},s={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"total",plural:!1,selections:r,storageKey:null},c={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"fee",plural:!1,selections:r,storageKey:null},u={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"defaultFee",plural:!1,selections:r,storageKey:null},d={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"feeWithoutSubscriptionBenefit",plural:!1,selections:r,storageKey:null},b={alias:null,args:null,concreteType:"UnitPrice",kind:"LinkedField",name:"unitPrice",plural:!1,selections:[o],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"resource",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"rejected",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},v={alias:null,args:null,concreteType:"Link",kind:"LinkedField",name:"link",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},j={alias:null,args:null,concreteType:"TransferUserWarningContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"details",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"linkText",storageKey:null}],storageKey:null},O={kind:"InlineFragment",selections:[f],type:"GenericError",abstractKey:null},S={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useSellQuoteSubmitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{kind:"InlineDataFragmentSpread",name:"createSellFragment",selections:[{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[n,o,i,s,c,u,d,b,p,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[m,l,y],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[g,f,v,j],storageKey:null}]}],type:"CreateSellSuccess",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"error",plural:!1,selections:[O],storageKey:null}],type:"CreateSellPartialError",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useSellQuoteSubmitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createSell",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferSell",kind:"LinkedField",name:"transferSell",plural:!1,selections:[n,o,i,s,c,u,d,b,p,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[m,l,y,S],storageKey:null},S],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[g,f,v,j,S],storageKey:null}],type:"CreateSellSuccess",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"error",plural:!1,selections:[a,O],storageKey:null}],type:"CreateSellPartialError",abstractKey:null}],storageKey:null}]},params:{id:"209a485f7efaf65c40c78a0983387b0d51abb6939df33d5af906423c20c45061",metadata:{},name:"useSellQuoteSubmitterMutation",operationKind:"mutation",text:null}}}();n.hash="4ca137395fd5720fd717f40494c25c8f",t.default=n},tLUS:function(e,t,a){"use strict";a.r(t);const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},l],o={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"amount",plural:!1,selections:r,storageKey:null},i={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"subtotal",plural:!1,selections:r,storageKey:null},s={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"total",plural:!1,selections:r,storageKey:null},c={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"fee",plural:!1,selections:r,storageKey:null},u={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"defaultFee",plural:!1,selections:r,storageKey:null},d={alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"feeWithoutSubscriptionBenefit",plural:!1,selections:r,storageKey:null},b={alias:null,args:null,concreteType:"UnitPrice",kind:"LinkedField",name:"unitPrice",plural:!1,selections:[o],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"holdDays",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"recurringPayment",storageKey:null},y={alias:null,args:null,concreteType:"InstantAchData",kind:"LinkedField",name:"instantAch",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isTotalInstant",storageKey:null},{alias:null,args:null,concreteType:"Amount",kind:"LinkedField",name:"instantAchAmount",plural:!1,selections:r,storageKey:null}],storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"resource",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"rejected",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},O={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},S={alias:null,args:null,concreteType:"Link",kind:"LinkedField",name:"link",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},h={alias:null,args:null,concreteType:"TransferUserWarningContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"details",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"linkText",storageKey:null}],storageKey:null},k={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"GenericError",kind:"LinkedField",name:"error",plural:!1,selections:[O],storageKey:null}],type:"CreateBuyPartialError",abstractKey:null},C={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useBuyQuoteSubmitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{kind:"InlineDataFragmentSpread",name:"createBuyFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[n,o,i,s,c,u,d,b,p,m,y,g,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[f,l,v],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[j,O,S,h],storageKey:null}]}],type:"CreateBuySuccess",abstractKey:null},k],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useBuyQuoteSubmitterMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"createBuy",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TransferBuy",kind:"LinkedField",name:"transferBuy",plural:!1,selections:[n,o,i,s,c,u,d,b,p,m,y,g,{alias:null,args:null,concreteType:"PaymentMethod",kind:"LinkedField",name:"paymentMethod",plural:!1,selections:[f,l,v,C],storageKey:null},C],storageKey:null},{alias:null,args:null,concreteType:"TransferUserWarning",kind:"LinkedField",name:"userWarnings",plural:!0,selections:[j,O,S,h,C],storageKey:null}],type:"CreateBuySuccess",abstractKey:null},k],storageKey:null}]},params:{id:"d6aa70fed9f40ca760adcf8e56ff77579094ad986f77619a0e7861f41443dac0",metadata:{},name:"useBuyQuoteSubmitterMutation",operationKind:"mutation",text:null}}}();n.hash="7c4a05035a6756beb49a29c476661677",t.default=n},vIZW:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("mXGw"),l=a("4gc5");const r=["USD","EUR","GBP","CAD","AUD","SGD"],o={"10-50-100-500-1000":["10","50","100","500","1000"]};function i(e){const{nativeCurrency:t,hasBlockingBuyRestrictions:a,hasBuyDepositPaymentMethods:i,hasMadeAPurchase:s}=Object(l.a)(),c=!a&&r.includes(t)&&i&&!s?o["10-50-100-500-1000"]:void 0;return Object(n.useMemo)(()=>{if(!c)return;const t=c[c.length-1];if(Number(t)<=e)return c;const a=c.slice(0,3),n=a[a.length-1];return Number(n)<=e?a:void 0},[c,e])}},vmnu:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a("5n0U"),l=a("mXGw"),r=a.n(l),o=a("hWgQ"),i=a("gN02"),s=a("eEWS"),c=a("wngC"),u=a("zQX7"),d=a("CJaK"),b=a("DRDe"),p=a("B6gP");const m=Object(o.c)({priceHasChangedTitle:{id:"SignificantChangeConfirmationModal.verifyId",defaultMessage:"{asset} price has changed"},priceHasChangedDescFiat:{id:"SignificantChangeConfirmationModal.priceHasChangedDescFiat",defaultMessage:"The price of {asset} has changed significantly since you started this order. Your order is for the same amount of {displayInputCurrency} that you entered, but the resulting {asset} you receive may have changed."},priceHasChangedDescCrypto:{id:"SignificantChangeConfirmationModal.priceHasChangedDescCrypto",defaultMessage:"The price of {asset} changes frequently based on market conditions. Your order is for the same amount of {asset} that you entered, but the {fiat} total of your order may have changed."},understand:{id:"SignificantChangeConfirmationModal.understand",defaultMessage:"I understand"},back:{id:"SignificantChangeConfirmationModal.back",defaultMessage:"Back"},buttonGroup:{id:"SignificantChangeConfirmationModal.buttonGroup",defaultMessage:"Modal actions"}}),y=e=>Object(n.a)(p.g,{width:.8*b.e,style:{top:"25%"},shouldCloseOnOverlayClick:!1},void 0,r.a.createElement(g,Object.assign({},e))),g=({onBack:e,onConfirm:t,asset:a,displayInputCurrency:r,type:o="fiat"})=>{const b=Object(p.h)(),{formatMessage:y}=Object(i.a)(),g=Object(l.useCallback)(()=>{b(),e()},[b,e]),f=Object(l.useCallback)(()=>{b(),t()},[b,t]);return Object(n.a)(c.Box,{width:"100%",flexDirection:"column",height:"100%",spacing:2,alignContent:"center",alignItems:"center"},void 0,Object(n.a)(d.TextTitle1,{as:"h3",spacingBottom:2,align:"center"},void 0,y(m.priceHasChangedTitle,{asset:a,displayInputCurrency:r})),Object(n.a)(u.TextBody,{as:"p",spacingBottom:2,align:"center"},void 0,y("fiat"===o?m.priceHasChangedDescFiat:m.priceHasChangedDescCrypto,{asset:a,displayInputCurrency:r})),Object(n.a)(s.ButtonGroup,{accessibilityLabel:y(m.buttonGroup)},void 0,Object(n.a)(s.Button,{onPress:g,block:!0,variant:"secondary"},void 0,y(m.back)),Object(n.a)(s.Button,{onPress:f,block:!0,variant:"primary"},void 0,y(m.understand))))}},vq8b:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a("5n0U"),l=a("mXGw"),r=a("hWgQ"),o=a("gN02"),i=a("oNR1"),s=a("zGmQ"),c=a("5vQi"),u=a("TDwA"),d=a("lbk/"),b=a("PvrF"),p=a("UP4x");const m=Object(r.c)({savingsHeadline:{id:"SubscriptionUpsellBanner.savingsHeadline",defaultMessage:"You saved {amount} on this trade"},zeroFeeHeadline:{id:"SubscriptionUpsellBanner.zeroFeeHeadline",defaultMessage:"Thanks for being a {productName} member"},promoHeadline:{id:"SubscriptionUpsellBanner.promoHeadline",defaultMessage:"Pay zero trading fees with {productName}"},promoCta:{id:"SubscriptionUpsellBanner.cta",defaultMessage:"Learn more"}}),y="subscription_upsell",g="subscription_zero_fees",f="subscription_savings",v=({mainText:e,ctaText:t,children:a,onClick:l,name:r})=>(Object(u.useLogEventOnMount)("trade_card_banner_card",{action:u.ActionType.render,componentType:u.ComponentType.card,loggingId:"141e9a8b-e13d-49e8-aa30-dbfc1a20f6e4",name:r}),Object(n.a)(s.a,{mainText:e,ctaText:t,onClick:l},void 0,a));function j({closeModal:e,isSubscribed:t,feeWithoutSubscriptionBenefitValue:a,feeWithoutSubscriptionBenefitCurrency:r}){const{formatMessage:s}=Object(o.a)(),j=Object(c.a)(),O=Object(i.h)(),S=Object(l.useCallback)((t,a)=>{!function(e){Object(u.logEvent)("trade_card_banner_card",{action:u.ActionType.click,componentType:u.ComponentType.card,loggingId:"141e9a8b-e13d-49e8-aa30-dbfc1a20f6e4",name:e})}(a),O.push(t),e&&e()},[O,e]);return t?a&&0===parseInt(a)?Object(n.a)(v,{mainText:s(m.zeroFeeHeadline,{productName:b.d}),ctaText:"",onClick:()=>S("/trade",g),name:g},void 0,Object(n.a)(p.a,{width:64,height:64,type:"logo"})):a&&r?Object(n.a)(v,{mainText:s(m.savingsHeadline,{amount:j({amount:{value:a,currency:r},isFiat:!0})}),ctaText:b.d,onClick:()=>S("/trade",f),name:f},void 0,Object(n.a)(d.Pictogram,{name:"coinbaseOneEarnCoins",dimension:"64x64"})):null:Object(n.a)(v,{mainText:s(m.promoHeadline,{productName:b.d}),ctaText:s(m.promoCta),onClick:()=>S("/settings/subscription",y),name:y},void 0,Object(n.a)(p.a,{width:64,height:64,type:"logo"}))}},xdc6:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return i}));var n=a("uEse"),l=a("KqNE");const r=Object(l.c)({steps:["entry","principalInsolvency","recurringSelect","paymentError","preview","status","wbl","selectAsset","selectPayment","additionalInfo","recurringRewardTerms","buyPresetAmounts","plaidRelink","disclosures","feesInfo","experimentalAssetConfirmation"],defaultStep:"entry"}),o={activePaymentMethodId:void 0,recurringPeriod:"never",isFiatInput:!0,tradeComplete:!1,isSellingAll:!1,showPresetAmountsIfAvailable:!1,eventContext:"assetPage",transferType:"buy",assetSymbol:"BTC"},i=Object(n.a)({initialValues:o})},yiHw:function(e,t,a){"use strict";a.r(t);const n={kind:"InlineDataFragment",name:"createBuyFragment",hash:"31aa69707debc3ec00398d47fe01cb09"};t.default=n}}]);
//# sourceMappingURL=buysell-c055eec575db43290226.chunk.js.map
(("undefined"!==typeof self?self:this).webpackJsonp=("undefined"!==typeof self?self:this).webpackJsonp||[]).push([[34],{Dhcx:function(e,t,a){"use strict";var n=a("+I+c"),o=a("5n0U"),c=a("mXGw"),i=a.n(c),s=a("UutA"),r=a("SIGa"),d=a("/PpR"),u=a("iNnr"),p=a("6W2E"),b=a("abUL"),l=a("NZci"),m=a("jZN1"),O=a("KqNE"),k=a("FGnu"),y=a("pW8h"),j=a("hWgQ"),f=a("gN02"),h=a("B05N"),g=a("kSTq"),v=a("5bpi"),S=a("WI56"),C=a("AaJB"),T=a("Vcb1");const _=Object(j.c)({retry:{id:"CheckoutDepositStepper.ErrorStep.retry",defaultMessage:"Retry"},cancel:{id:"CheckoutDepositStepper.ErrorStep.cancel",defaultMessage:"Cancel"},body:{id:"CheckoutDepositStepper.ErrorStep.body",defaultMessage:"There was an issue with adding your account to Coinbase. Please try again or use a different payment method."},errorHeader:{id:"CheckoutDepositStepper.ErrorStep.errorHeader",defaultMessage:"Your {bankName} could not be added to Coinbase"}}),M=({error:e,bankType:t,onExit:a,onReset:n})=>{const{formatMessage:c}=Object(f.a)();return Object(o.a)(A,{column:!0,align:"center",justify:"center"},void 0,Object(o.a)(w,{type:"failure"}),Object(o.a)(h.a,{level:3,marginBottom:"md"},void 0,c(_.errorHeader,{bankName:Object(T.a)(t)})),Object(o.a)(g.a,{},void 0,e.statusCode?e.message:c(_.body)),Object(o.a)(N,{},void 0,a&&Object(o.a)(I,{type:"light",onClick:a,fullWidth:!0,rightPadded:!!n},void 0,c(_.cancel)),n&&Object(o.a)(C.a,{onClick:n,fullWidth:!0},void 0,c(_.retry))))},w=Object(s.e)(v.a).withConfig({displayName:"ErrorFallback__StyledStatusTick",componentId:"g2ex51-0"})(["height:108px;width:108px;margin-bottom:",";"],e=>e.theme.size.huge),A=Object(s.e)(p.a).withConfig({displayName:"ErrorFallback__Container",componentId:"g2ex51-1"})(["text-align:center;max-width:450px;"]),I=Object(s.e)(C.a).withConfig({displayName:"ErrorFallback__StyledButton",componentId:"g2ex51-2"})(["margin-right:",";"],e=>e.rightPadded?e.theme.size.huge:0),N=Object(s.e)(S.a).withConfig({displayName:"ErrorFallback__ButtonContainer",componentId:"g2ex51-3"})(["margin-top:",";align-self:stretch;"],e=>e.theme.size.huge);var D=Object(c.memo)(M),E=a("nms+"),x=a("TDwA");function F({bankType:e,hasLinkedAccount:t}){return t?e+" linked":e+" generic"}function L(e,t){Object(x.useLogEventOnMount)(e,{account_type:F(t),componentType:x.ComponentType.unknown,loggingId:"a1a17b00-a6af-4adb-a1ac-688dae4d6064"})}function P(e,t){return Object(E.a)(e,{account_type:F(t)})}var B=a("QLaP"),R=a.n(B),q=a("gwkW");const{createForm:z}=q.a,H={amount:"",account:null,paymentMethod:null};var V=z(H),W=a("1YZV"),G=a("0A5j");var U=a("SPtF"),Y=a("UdTd");function Z({quickDepositBankId:e,bankType:t,fiatAccount:a,paymentMethods:n}){const o=!!a&&n.length>0,{account:c,paymentMethod:i}=function(e){const t=function({bankType:e,quickDepositBankId:t,shouldFetch:a}){let n=null;return a&&(n={transfer_type:"deposit",payment_method_type:e},t&&(n.bank_id=t)),n}(e),{data:a}=Object(U.a)(Y.a.setupShape(),t);return{account:null===a||void 0===a?void 0:a.account,paymentMethod:null===a||void 0===a?void 0:a.paymentMethod}}({quickDepositBankId:e,bankType:t,shouldFetch:!o});return[Object.assign({},H,{account:a||c||null,paymentMethod:i||n[0]}),o]}var J=a("xNHB"),Q=a("7/GD"),X=a("mOXG"),K=a("yVYY"),$=a("iiUS"),ee=a("Zm7i"),te=a("V21s"),ae=a("h72U"),ne=a("DgjW");const oe=Object(j.c)({fee:{id:"CheckoutDepositStepper.ConfirmationReceipt.fee",defaultMessage:"{bankType} processing fee"},arrivalDate:{id:"CheckoutDepositStepper.ConfirmationReceipt.arrivalDate",defaultMessage:"Funds will arrive by"},depositFrom:{id:"CheckoutDepositStepper.ConfirmationReceipt.depositFrom",defaultMessage:"Add cash from {bankType}"}}),ce=({label:e,value:t})=>Object(o.a)(se,{column:!0},void 0,Object(o.a)(X.a,{},void 0,e),Object(o.a)(g.a,{},void 0,t)),ie=({quote:e,bankType:t})=>{const a=Object(f.a)(),{formatMessage:n}=a;if(!e)return null;const c=Object(ne.a)(e.payoutAt,a);return Object(o.a)(K.HStack,{},void 0,Object(o.a)(ee.c,{transferType:"buy",paymentMethodType:t}),Object(o.a)($.VStack,{flexGrow:1,flexShrink:1,flexBasis:"auto"},void 0,Object(o.a)(ce,{label:n(oe.depositFrom,{bankType:Object(T.a)(t)}),value:i.a.createElement(te.a,Object.assign({},e.amount))}),Object(o.a)(ce,{label:n(oe.arrivalDate),value:c}),e.fee&&Object(o.a)(ce,{label:n(oe.fee,{bankType:Object(T.a)(t)}),value:i.a.createElement(te.a,Object.assign({},e.fee))})))},se=Object(s.e)(ae.a).withConfig({displayName:"ConfirmationReceipt__StyledConfirmRow",componentId:"bfp9zb-0"})(["align-items:flex-start;justify-content:center;"]);var re=Object(c.memo)(ie);const{useFields:de}=q.a;const ue=Object(j.c)({cancel:{id:"CheckoutDepositStepper.ConfirmStep.cancel",defaultMessage:"Cancel"},confirm:{id:"CheckoutDepositStepper.ConfirmStep.confirm",defaultMessage:"Confirm"}}),pe=({depositId:e,bankType:t,hasLinkedAccount:a})=>{const{formatMessage:n}=Object(f.a)(),{data:i}=Object(J.a)(G.a.entityShape(),e?{id:e}:null);L("deposit_PPRO_confirmation_viewed",{bankType:t,hasLinkedAccount:a});const s=function({quote:e,onComplete:t}){const{account:a}=de(V),n=Object(W.a)(G.a.commitShape());return Object(c.useCallback)(async()=>{var o;await n({accountId:null===(o=a.value)||void 0===o?void 0:o.id,depositId:null===e||void 0===e?void 0:e.id},{}),t()},[n,e,a,t])}({quote:i,onComplete:function(e){const t=Object(O.i)("status"),a=P("deposit_PPRO_confirmation_clicked",e);return Object(c.useCallback)(()=>{a(),t()},[a,t])}({bankType:t,hasLinkedAccount:a})});return Object(o.a)(p.a,{},void 0,Object(o.a)(re,{quote:i,bankType:t}),Object(o.a)(Q.a,{onNext:s,nextLabel:n(ue.confirm),backLabel:n(ue.cancel)}))};var be=Object(c.memo)(pe),le=a("rg70"),me=a("+uXZ"),Oe=a("uY1K"),ke=a("0Dzm");const{useFields:ye}=q.a,je=Object(j.c)({amount:{id:"CheckoutDepositStepper.EntryAmountInput.amount",defaultMessage:"Amount"}}),fe=({currency:e})=>{const{formatMessage:t}=Object(f.a)(),{amount:a}=ye(V),n=Object(ke.a)(e)?"0":"0.00";return Object(o.a)(he,{label:t(je.amount)},void 0,i.a.createElement(Oe.a,Object.assign({},a,{autoFocus:!0,mode:"deposit",label:e,placeholder:n,currency:e,minAmount:1e-8})))},he=Object(s.e)(le.a).withConfig({displayName:"EntryAmountInput__StyledLabeled",componentId:"ie12af-0"})(["margin-top:",";"],e=>e.theme.size.medium);var ge=Object(c.memo)(fe);const{useSubmitter:ve}=q.a;var Se=function({children:e}){const[t,a]=Object(c.useState)(!1),n=Object(O.i)("confirm"),[i,s]=ve(V),r=Object(c.useCallback)(()=>{a(!1)},[]),d=Object(c.useCallback)(async()=>{a(!0),await i({onNext:n,onCancel:r})},[i,n,r]);return Object(o.a)(p.a,{},void 0,e,Object(o.a)(Q.a,{onNext:d,submittable:s,loading:t}))};const{useFields:Ce}=q.a,Te=Object(j.c)({depositFrom:{id:"PproDepositStepper.DepositEntryStep.depositFrom",defaultMessage:"Add cash from"}}),_e=({currency:e,bankType:t,paymentMethods:a})=>{const{formatMessage:n}=Object(f.a)();L("deposit_PPRO_input_form_viewed",{bankType:t,hasLinkedAccount:!0});const{paymentMethod:c}=Ce(V);return Object(o.a)(Se,{},void 0,Object(o.a)(le.a,{label:n(Te.depositFrom)},void 0,i.a.createElement(me.a,Object.assign({},c,{mode:"deposit",paymentMethods:a}))),Object(o.a)(ge,{currency:e}))};var Me=Object(c.memo)(_e),we=a("PVID");const{useFields:Ae}=q.a,Ie=Object(j.c)({depositTo:{id:"PproDepositStepper.EntryStep.depositTo",defaultMessage:"Add to"}}),Ne=({currency:e,bankType:t})=>{const{formatMessage:a}=Object(f.a)();L("deposit_PPRO_input_form_viewed",{bankType:t,hasLinkedAccount:!1});const{account:n}=Ae(V);return Object(o.a)(Se,{},void 0,Object(o.a)(le.a,{label:a(Ie.depositTo)},void 0,i.a.createElement(we.a,Object.assign({},n,{accounts:[n.value]}))),Object(o.a)(ge,{currency:e}))};var De=Object(c.memo)(Ne),Ee=a("4Zye"),xe=a("hAGl");const Fe=Object(j.c)({genericError:{id:"CheckoutDepositStepper.StatusStep.genericError",defaultMessage:"There was an issue connecting to {bankName}"},redirecting:{id:"CheckoutDepositStepper.StatusStep.redirecting",defaultMessage:"Redirecting to {bankName}"}}),Le=({bankType:e,depositId:t,hasLinkedAccount:a})=>{const{formatMessage:n}=Object(f.a)();L("deposit_PPRO_redirect_viewed",{bankType:e,hasLinkedAccount:a});const{data:i}=Object(J.a)(G.a.entityShape(),t?{id:t}:null),{status:s,handler:r,error:d}=Object(xe.a)(null===i||void 0===i?void 0:i.nextStep);Object(c.useEffect)(()=>{r&&r()},[r]),function(e,t){const a=P("deposit_PPRO_redirect_issue_viewed",t);Object(c.useMemo)(()=>{"failure"===e&&a()},[e,a])}(s,{bankType:e,hasLinkedAccount:a});const u=n(Fe.redirecting,{bankName:Object(T.a)(e)}),b=d||n(Fe.genericError,{bankName:Object(T.a)(e)});return Object(o.a)(p.a,{},void 0,Object(o.a)(Ee.b,{status:s,maxLoopCount:Number.POSITIVE_INFINITY},void 0,({animationType:e})=>"loading"===e?u:"failure"===e||"emailSent"===e?b:null))};var Pe=Object(c.memo)(Le);function Be({bankType:e,fiatAccount:t,quickDepositBankId:a,setHasLinkedAccount:n,paymentMethods:i}){const[s,r]=Object(c.useState)(null),[d,u]=Z({fiatAccount:t,bankType:e,quickDepositBankId:a,paymentMethods:i});n(u),R()(d.account,"There should be an account present");const p=d.account.currency.code,b=u?"depositEntryStep":"linkedEntryStep",l=function({setDepositId:e,currency:t}){const a=Object(W.a)(G.a.createShape());return Object(c.useCallback)(async(n,o,{onNext:c,onCancel:i})=>{var s;const r={currency:t,commit:!1,amount:n.amount,payment_method:null===(s=n.paymentMethod)||void 0===s?void 0:s.id};try{var d;const t=await a({accountId:null===(d=n.account)||void 0===d?void 0:d.id},r);(null===t||void 0===t?void 0:t.data)&&(e(t.data.id),c())}catch(u){o({amount:[u]}),i()}},[a,t,e])}({setDepositId:r,currency:p});return Object(o.a)(V.Provider,{onSubmit:l,initialValues:d},void 0,Object(o.a)(O.d,{defaultStep:b},void 0,Object(o.a)(De,{stepName:"linkedEntryStep",currency:p,bankType:e}),Object(o.a)(Me,{stepName:"depositEntryStep",currency:p,bankType:e,paymentMethods:i}),Object(o.a)(be,{stepName:"confirm",bankType:e,depositId:s,hasLinkedAccount:u}),Object(o.a)(Pe,{stepName:"status",bankType:e,depositId:s,hasLinkedAccount:u})))}var Re=a("XgC1"),qe=a("VerN"),ze=a("7Jgk"),He=a("iRmS"),Ve=a("emkK");const We=new Map([["mufg",Object(o.a)(qe.a,{},"mufg")],["jibun",Object(o.a)(Re.a,{},"jibun")]]),Ge=({setQuickDepositBankId:e})=>{const{data:t}=Object(U.a)(Ve.a.listShape(),{}),a=Object(O.i)("mainFlowStep");return Object(o.a)(p.a,{},void 0,t.map(t=>i.a.createElement(Ue,Object.assign({},t,{key:t.code,icon:We.get(t.icon)||null,onSelect:()=>{e(t.code),a()}}))))};const Ue=Object(s.e)(ze.a).withConfig({displayName:"ChooseBankStep__StyledBankRow",componentId:"sc-1s5af2z-0"})(["margin:0 -",";&:first-child{padding-top:0;}&:last-child{padding-bottom:0;}"],e=>e.theme.size.huge),Ye=Object(s.e)(He.a).withConfig({displayName:"ChooseBankStep__ShortLoadingContainer",componentId:"sc-1s5af2z-1"})(["",";min-height:200px;"],p.b);var Ze=function(e){return Object(o.a)(c.Suspense,{fallback:Object(o.a)(Ye,{})},void 0,i.a.createElement(Ge,Object.assign({},e)))};const Je=({bankType:e,fiatAccount:t,requirement:a,setHasLinkedAccount:n})=>{const[i,s]=Object(c.useState)(null),[r]=Object(d.a)(e=>e(k.b)(t?{accountUuid:t.id,transferType:"deposit"}:{skip:!0}),e=>e(y.b)({type:"deposits"})),u=function({fiatAccount:e,bankType:t,paymentMethods:a}){return Object(c.useMemo)(()=>e?a.filter(e=>e.type===t):[],[t,e,a])}({fiatAccount:t,bankType:e,paymentMethods:r}),p=function({hasLinkedAccount:e,requirement:t,bankType:a}){return t?"requirementStep":"qd"!==a||e?"mainFlowStep":"chooseBankStep"}({bankType:e,requirement:a,hasLinkedAccount:!!t&&u.length>0});return Object(o.a)(O.d,{defaultStep:p},void 0,Object(o.a)(l.a,{stepName:"requirementStep",requirement:a,nextStep:"mainFlowStep"}),Object(o.a)(Ze,{stepName:"chooseBankStep",setQuickDepositBankId:s}),Object(o.a)(Be,{stepName:"mainFlowStep",bankType:e,fiatAccount:t,setHasLinkedAccount:n,quickDepositBankId:i,paymentMethods:u}))},Qe=Object(s.e)(p.a).withConfig({displayName:"CheckoutDepositStepper__FallbackContainer",componentId:"sc-71w827-0"})(["min-height:250px;"]);var Xe=e=>{let{onExit:t,bankType:a}=e,s=Object(n.a)(e,["onExit","bankType"]);const[d,p]=Object(c.useState)(!1),l=P("deposit_PPRO_deposit_failed_viewed",{bankType:a,hasLinkedAccount:d}),O=({error:e,onReset:n})=>Object(o.a)(D,{error:e,onExit:t,onReset:n,bankType:a});return Object(o.a)(c.Suspense,{fallback:Object(o.a)(Qe,{center:!0},void 0,Object(o.a)(r.a,{}))},void 0,Object(o.a)(u.a,{fallback:O,onCatch:()=>l()},void 0,Object(o.a)(b.b,{boundaryName:"CheckoutDepositStepper",fallback:O,onCatch:()=>{l()}},void 0,Object(o.a)(m.a,{},void 0,i.a.createElement(Je,Object.assign({bankType:a,setHasLinkedAccount:p},s))))))};t.a=Xe}}]);
//# sourceMappingURL=checkoutdepositstepper-5f581512ae8c97a21bba.chunk.js.map